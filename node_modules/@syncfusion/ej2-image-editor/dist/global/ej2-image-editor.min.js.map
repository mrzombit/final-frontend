{"version":3,"file":"ej2-image-editor.min.js","sources":["../../src/image-editor/image-editor.js"],"sourcesContent":["var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nimport { Component, NotifyPropertyChanges, Property, addClass, removeClass, extend } from '@syncfusion/ej2-base';\nimport { Event, EventHandler, getComponent, getInstance, isNullOrUndefined, L10n, getUniqueID } from '@syncfusion/ej2-base';\nimport { Toolbar } from '@syncfusion/ej2-navigations';\nimport { DropDownButton } from '@syncfusion/ej2-splitbuttons';\nimport { ColorPicker, Uploader, Slider } from '@syncfusion/ej2-inputs';\nimport { createSpinner, showSpinner, hideSpinner } from '@syncfusion/ej2-popups';\nimport { Complex, compile, compile as templateCompiler, Browser, detach, select, ChildProperty } from '@syncfusion/ej2-base';\n/**\n * Interface for image finetune values.\n */\nvar FinetuneSettings = /** @class */ (function (_super) {\n    __extends(FinetuneSettings, _super);\n    function FinetuneSettings() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    __decorate([\n        Property(null)\n    ], FinetuneSettings.prototype, \"brightness\", void 0);\n    __decorate([\n        Property(null)\n    ], FinetuneSettings.prototype, \"contrast\", void 0);\n    __decorate([\n        Property(null)\n    ], FinetuneSettings.prototype, \"hue\", void 0);\n    __decorate([\n        Property(null)\n    ], FinetuneSettings.prototype, \"saturation\", void 0);\n    __decorate([\n        Property(null)\n    ], FinetuneSettings.prototype, \"exposure\", void 0);\n    __decorate([\n        Property(null)\n    ], FinetuneSettings.prototype, \"opacity\", void 0);\n    __decorate([\n        Property(null)\n    ], FinetuneSettings.prototype, \"blur\", void 0);\n    return FinetuneSettings;\n}(ChildProperty));\nexport { FinetuneSettings };\n/**\n * Image Editor is a graphical user interface that helps to edit an image by performing actions like selection,\n * cropping, rotating, inserting text and shapes (rectangles, ellipses, lines), and drawing free hand on top of an image.\n *\n ```html\n * <div id='imageeditor'></div>\n * ```\n * ```typescript\n * <script>\n * var imageObj = new ImageEditor({});\n * imageObj.appendTo(\"#imageeditor\");\n * </script>\n * ```\n */\nvar ImageEditor = /** @class */ (function (_super) {\n    __extends(ImageEditor, _super);\n    /**\n     *\n     * Constructor for creating the widget\n     *\n     * @param  {ImageEditorModel} options - Specifies the image editor model\n     * @param  {string|HTMLDivElement} element - Specifies the target element\n     */\n    function ImageEditor(options, element) {\n        var _this = _super.call(this, options, element) || this;\n        _this.degree = 0; // current rotated state\n        _this.isUndoRedo = false;\n        _this.dragCanvas = false;\n        _this.dragElement = '';\n        _this.keyHistory = ''; // text history\n        _this.tempKeyHistory = ''; // restore text history on cancel\n        _this.mouseDownPoint = { x: 0, y: 0 };\n        _this.previousPoint = { x: 0, y: 0 }; // updates prev x and y points in mouseMove\n        _this.dragPoint = { startX: 0, startY: 0, endX: 0, endY: 0 }; // updates drag start and end points in mousedown and mousemove\n        _this.diffPoint = { x: 0, y: 0 }; // updates resize points\n        _this.oldPoint = {};\n        _this.objColl = []; // shapes, text obj collection\n        _this.undoRedoColl = [];\n        _this.isImageLoaded = false; // collection of Image Data mainly used for reset state\n        _this.strokeSettings = { strokeColor: '#fff', fillColor: '', strokeWidth: null };\n        _this.tempStrokeSettings = { strokeColor: '#fff', fillColor: '', strokeWidth: null }; // restore stroke settings on cancel\n        _this.textSettings = { text: 'Enter Text', fontFamily: 'Arial', fontSize: null, fontRatio: null, bold: false, italic: false, underline: false };\n        _this.tempTextSettings = { text: 'Enter Text', fontFamily: 'Arial', fontSize: null, fontRatio: null, bold: false, italic: false, underline: false }; // restore text settings on cancel\n        _this.toolbarHeight = 46;\n        _this.togglePan = false; // toggle pan\n        _this.disablePan = false; // auto enable / disable pan while zooming\n        _this.currFlipState = ''; // current flipped state\n        _this.touchEndPoint = {};\n        _this.undoRedoStep = 0;\n        _this.togglePen = false; // toggle free hand drawing\n        _this.currentToolbar = 'main';\n        _this.textStartPoints = { x: 0, y: 0 }; // restore text styles on cancel\n        _this.fontSizeColl = []; // collection of font sizes\n        _this.textRow = 1; // text area row count\n        _this.activeObj = { activePoint: { startX: 0, startY: 0, endX: 0, endY: 0, width: 0, height: 0 },\n            flipObjColl: [] };\n        _this.tempActiveObj = { activePoint: { startX: 0, startY: 0, endX: 0, endY: 0, width: 0, height: 0 },\n            flipObjColl: [] }; // for undo redo\n        _this.currObjType = { shape: '', isDragging: false, isActiveObj: false, isText: false, isInitialText: false, isLine: false, isInitialLine: false,\n            isCustomCrop: false, isZoomed: false, isUndoZoom: false, isUndoAction: false, isFiltered: false, isSave: false };\n        _this.defToolbarItems = [];\n        _this.isTimer = false; // mobile mode text area rendering on long touch\n        _this.isFirstMove = false; // for pinch zoom\n        _this.startTouches = []; // for pinch zoom\n        _this.tempTouches = []; // for pinch zoom\n        _this.adjustmentLevel = { brightness: 0, contrast: 0, hue: 0, opacity: 100, saturation: 0, blur: 0,\n            exposure: 0, sharpen: false, bw: false }; // for toolbar slider value\n        _this.tempAdjustmentLevel = { brightness: 0, contrast: 0, hue: 0, opacity: 100, saturation: 0, blur: 0,\n            exposure: 0, sharpen: false, bw: false }; // for temp toolbar slider value\n        _this.adjustmentValue = ''; // for internal slider value\n        _this.initialAdjustmentValue = '';\n        _this.tempAdjustmentValue = ''; // for temp internal slider value\n        _this.currentFilter = ''; // current filter selected from toolbar\n        _this.tempFilter = ''; // restore filter style on cancel\n        _this.canvasFilter = 'brightness(' + 1 + ') ' + 'contrast(' + 100 + '%) ' + 'hue-rotate(' + 0 + 'deg) ' + // current filter style applied to lowerCanvas\n            'saturate(' + 100 + '%) ' + 'opacity(' + 1 + ') ' + 'blur(' + 0 + 'px) ' + 'sepia(0%) ' + 'grayscale(0%) ' + 'invert(0%)';\n        _this.tempUndoRedoColl = [];\n        _this.tempUndoRedoStep = 0;\n        // Revamp new properties\n        _this.zoomFactor = 0; // Current zoom factor\n        _this.tempZoomFactor = 0; // Restore zoom factor on cancel\n        _this.destLeft = 0; // Current image left position\n        _this.destTop = 0; // Current image top position\n        _this.srcLeft = 0; // Original image left position\n        _this.srcTop = 0; // Original image top position\n        _this.cropDestPoints = { startX: 0, startY: 0, width: 0, height: 0 }; // To redraw old image when navigate to crop tab\n        _this.flipColl = []; // To store flip order\n        _this.isReverseRotate = false; // True when rotate method is called from iteration\n        _this.isReverseFlip = false; // True when rotate method is called from iteration\n        _this.isPreventDragging = false; // Shapes dragging is prevented when crop region is inside shape points\n        _this.isRotateZoom = false; // To restore zoomed image on selection crop selection\n        // eslint-disable-next-line\n        _this.rotateFlipColl = []; // Transformation collection for redrawing image on rotate and flip\n        _this.isCircleCrop = false; // Specifies whether circle crop is enabled or not\n        _this.rotatedDestPoints = { startX: 0, startY: 0, width: 0, height: 0 };\n        _this.croppedDegree = 0; // Specifies the degree when crop is performed\n        _this.isFreehandDrawingPoint = false; // Specifies whether mouse cursor is on freehand drawing point or not\n        _this.isFreehandDrawEditing = false; // Specifies whether freehand drawing is in editing mode or not\n        _this.tempFreeHandDrawEditingStyles = { strokeColor: null, fillColor: null, strokeWidth: null }; // Restore freehand drawing styles on cancel\n        _this.totalPannedInternalPoint = { x: 0, y: 0 }; // To store total panned point internally in rotated state\n        _this.totalPannedClientPoint = { x: 0, y: 0 }; // To store total panned point in client coordinates in rotated state\n        _this.totalPannedPoint = { x: 0, y: 0 }; // To store current panned point in non-rotated state\n        _this.isCropTab = false; // Specifies whether crop tab is selected or not\n        _this.cropZoomFactor = 0; // Specifies the zoom factor when crop selection is performed\n        _this.defaultZoomFactor = 0; // Specifies the zoom factor when crop selection is not performed\n        _this.fileName = ''; // Specifies the file name of the image on initial loading\n        _this.isBrightnessAdjusted = false; // Specifies whether brightness is adjusted or not, to adjust opacity (combination)\n        _this.isInitialLoading = false; // Specifies whether image is loaded for the first time or not (for applying initial filter)\n        // For Free Hand Drawing\n        _this.freehandDrawObj = { lastWidth: 0, lastVelocity: 0, time: 0, pointX: 0, pointY: 0 };\n        _this.points = [];\n        // eslint-disable-next-line\n        _this.pointColl = {};\n        _this.pointCounter = 0;\n        _this.freehandCounter = 0;\n        _this.isFreehandDrawing = false;\n        _this.tempFreehandCounter = 0;\n        _this.lastPan = { x: 0, y: 0 }; // To store last pan point\n        _this.selectedFreehandColor = '#42a5f5';\n        _this.isFreehandDrawCustomized = false;\n        _this.isShapeInserted = false;\n        _this.isAllowCropPan = false;\n        _this.tempPannedPoint = { x: 0, y: 0 };\n        _this.cropObj = { cropZoom: 0, defaultZoom: 0, totalPannedPoint: { x: 0, y: 0 }, totalPannedClientPoint: { x: 0, y: 0 },\n            totalPannedInternalPoint: { x: 0, y: 0 }, tempFlipPanPoint: { x: 0, y: 0 }, activeObj: {}, rotateFlipColl: [],\n            degree: 0, currFlipState: '', destPoints: { startX: 0, startY: 0, width: 0, height: 0 },\n            srcPoints: { startX: 0, startY: 0, width: 0, height: 0 }, filter: '' };\n        _this.afterCropActions = [];\n        _this.isCancelAction = false;\n        _this.isFreehandPointMoved = false;\n        _this.isTouch = false;\n        _this.freehandDownPoint = { x: 0, y: 0 };\n        _this.tempFlipPanPoint = { x: 0, y: 0 };\n        _this.currentFreehandDrawIndex = 0; // Specifies id for every freehand drawing - uses while deleting\n        _this.tempCurrentFreehandDrawIndex = 0; // Specifies id for every freehand drawing - uses while cancelling\n        _this.preventZoomBtn = false;\n        _this.cancelObjColl = [];\n        _this.cancelPointColl = [];\n        _this.rotatedFlipCropSelection = false;\n        return _this;\n    }\n    ImageEditor_1 = ImageEditor;\n    ImageEditor.prototype.preRender = function () {\n        // pre render code snippets\n        this.element.id = this.element.id || getUniqueID('ej2-image-editor');\n        if (Browser.isDevice) {\n            this.element.classList.add('e-device');\n        }\n        this.themeColl = {\n            Bootstrap5: { primaryColor: '#0d6efd', secondaryColor: '#fff' },\n            Bootstrap5Dark: { primaryColor: '#0d6efd', secondaryColor: '#fff' },\n            Tailwind: { primaryColor: '#4f46e5', secondaryColor: '#fff' },\n            TailwindDark: { primaryColor: '#22d3ee', secondaryColor: '#fff' },\n            Fluent: { primaryColor: '#0078d4', secondaryColor: '#fff' },\n            FluentDark: { primaryColor: '#0078d4', secondaryColor: '#fff' },\n            Bootstrap4: { primaryColor: '#007bff', secondaryColor: '#fff' },\n            Bootstrap: { primaryColor: '#317ab9', secondaryColor: '#fff' },\n            BootstrapDark: { primaryColor: '#317ab9', secondaryColor: '#fff' },\n            Material: { primaryColor: '#e3165b', secondaryColor: '#fff' },\n            MaterialDark: { primaryColor: '#00b0ff', secondaryColor: '#fff' },\n            Fabric: { primaryColor: '#0078d6', secondaryColor: '#fff' },\n            FabricDark: { primaryColor: '#0074cc', secondaryColor: '#fff' },\n            Highcontrast: { primaryColor: '#000000', secondaryColor: '#fff' }\n        };\n        this.defaultLocale = {\n            Crop: 'Crop',\n            ZoomIn: 'Zoom In',\n            ZoomOut: 'Zoom Out',\n            Undo: 'Undo',\n            Redo: 'Redo',\n            Transform: 'Transform',\n            Annotation: 'Annotation',\n            Finetune: 'Finetune',\n            Brightness: 'Brightness',\n            Contrast: 'Contrast',\n            Hue: 'Hue',\n            Saturation: 'Saturation',\n            Opacity: 'Opacity',\n            Blur: 'Blur',\n            Sharpen: 'Sharpen',\n            Exposure: 'Exposure',\n            Filter: 'Filter',\n            Default: 'Default',\n            Chrome: 'Chrome',\n            Cold: 'Cold',\n            Warm: 'Warm',\n            Grayscale: 'Grayscale',\n            BlackAndWhite: 'Black and White',\n            Sepia: 'Sepia',\n            Invert: 'Invert',\n            Text: 'Add Text',\n            Pen: 'Pen',\n            Reset: 'Reset',\n            Save: 'Save',\n            Select: 'Select',\n            RotateLeft: 'Rotate Left',\n            RotateRight: 'Rotate Right',\n            HorizontalFlip: 'Horizontal Flip',\n            VerticalFlip: 'Vertical Flip',\n            OK: 'OK',\n            Cancel: 'Cancel',\n            FillColor: 'Fill Color',\n            StrokeColor: 'Stroke Color',\n            StrokeWidth: 'Stroke Width',\n            FontFamily: 'Font Family',\n            FontStyle: 'Font Style',\n            FontSize: 'Font Size',\n            FontColor: 'Font Color',\n            Pan: 'Pan',\n            Move: 'Move',\n            Load: 'Load',\n            Custom: 'Custom',\n            Square: 'Square',\n            Circle: 'Circle',\n            Ellipse: 'Ellipse',\n            Rectangle: 'Rectangle',\n            Line: 'Line',\n            Bold: 'Bold',\n            Italic: 'Italic',\n            BoldItalic: 'Bold Italic',\n            XSmall: 'X-Small',\n            Small: 'Small',\n            Medium: 'Medium',\n            Large: 'Large',\n            XLarge: 'X-Large',\n            ABC: 'ABC',\n            Browse: 'Browse'\n        };\n        this.l10n = new L10n('image-editor', this.defaultLocale, this.locale);\n    };\n    /**\n     *\n     * To Initialize the component rendering\n     *\n     * @private\n     * @returns {void}\n     */\n    ImageEditor.prototype.render = function () {\n        this.initialize();\n    };\n    /**\n     * To get component name.\n     *\n     * @returns {string} - Module Name\n     * @private\n     */\n    ImageEditor.prototype.getModuleName = function () {\n        return 'image-editor';\n    };\n    /**\n     *\n     * To get the properties to be maintained in the persisted state.\n     *\n     * @returns {string} - Persist data\n     * @private\n     */\n    ImageEditor.prototype.getPersistData = function () {\n        return this.addOnPersist([]);\n    };\n    /**\n     *\n     * Called internally if any of the property value changed.\n     *\n     * @param  {ImageEditorModel} newProperties - Specifies new properties\n     * @param  {ImageEditorModel} oldProperties - Specifies old properties\n     * @returns {void}\n     * @private\n     */\n    ImageEditor.prototype.onPropertyChanged = function (newProperties, oldProperties) {\n        for (var _i = 0, _a = Object.keys(newProperties); _i < _a.length; _i++) {\n            var prop = _a[_i];\n            switch (prop) {\n                case 'cssClass':\n                    if (oldProperties.cssClass) {\n                        removeClass([this.element], oldProperties.cssClass.replace(/\\s+/g, ' ').trim().split(' '));\n                    }\n                    if (newProperties.cssClass) {\n                        addClass([this.element], newProperties.cssClass.replace(/\\s+/g, ' ').trim().split(' '));\n                    }\n                    break;\n                case 'disabled':\n                    if (newProperties.disabled) {\n                        this.element.classList.add('e-disabled');\n                        this.unwireEvent();\n                    }\n                    else {\n                        this.element.classList.remove('e-disabled');\n                        this.wireEvent();\n                    }\n                    break;\n                case 'height':\n                    this.element.style.height = newProperties.height;\n                    break;\n                case 'width':\n                    this.element.style.width = newProperties.width;\n                    break;\n                case 'theme':\n                    if (newProperties.theme) {\n                        this.updateTheme();\n                        this.upperContext.strokeStyle = this.themeColl[this.theme]['primaryColor'];\n                        this.upperContext.fillStyle = this.themeColl[this.theme]['secondaryColor'];\n                    }\n                    break;\n                case 'finetuneSettings':\n                    if (newProperties.finetuneSettings) {\n                        this.finetuneSettings = newProperties.finetuneSettings;\n                        this.updateFinetunes();\n                    }\n                    break;\n                case 'locale':\n                    if (newProperties.locale) {\n                        this.l10n.setLocale(newProperties.locale);\n                        this.refreshToolbar('main');\n                    }\n                    break;\n                case 'allowUndoRedo':\n                    if (newProperties.allowUndoRedo) {\n                        this.allowUndoRedo = true;\n                    }\n                    else {\n                        this.allowUndoRedo = false;\n                    }\n                    this.refreshToolbar('main');\n                    break;\n                case 'toolbar':\n                    break;\n                case 'toolbarTemplate':\n                    break;\n            }\n        }\n    };\n    ImageEditor.prototype.destroy = function () {\n        var classList = [];\n        this.element.removeAttribute('tabindex');\n        if (this.cssClass) {\n            classList = classList.concat(this.cssClass.replace(/\\s+/g, ' ').trim().split(' '));\n        }\n        removeClass([this.element], classList);\n        if (!this.element.getAttribute('class')) {\n            this.element.removeAttribute('class');\n        }\n        this.destroySubComponents();\n        this.unwireEvent();\n        _super.prototype.destroy.call(this);\n        this.element.innerHTML = '';\n    };\n    ImageEditor.prototype.initialize = function () {\n        this.updateFinetunes();\n        this.createToolbar();\n        this.createContextualToolbar();\n        this.createCanvas();\n        this.wireEvent();\n        this.lowerContext.filter = this.canvasFilter = this.initialAdjustmentValue = this.adjustmentValue = this.getDefaultFilter();\n        if (this.cssClass) {\n            addClass([this.element], this.cssClass.replace(/\\s+/g, ' ').trim().split(' '));\n        }\n        if (this.element) {\n            createSpinner({\n                target: this.element\n            });\n        }\n    };\n    ImageEditor.prototype.getDefaultFilter = function () {\n        return 'brightness(' + 1 + ') ' + 'contrast(' + 100 + '%) ' + 'hue-rotate(' + 0 + 'deg) ' +\n            'saturate(' + 100 + '%) ' + 'opacity(' + 1 + ') ' + 'blur(' + 0 + 'px) ' + 'sepia(0%) ' + 'grayscale(0%) ' + 'invert(0%)';\n    };\n    ImageEditor.prototype.updateFinetunes = function () {\n        if (this.finetuneSettings) {\n            if (this.finetuneSettings.brightness) {\n                this.adjustmentLevel.brightness = this.finetuneSettings.brightness.defaultValue;\n                this.tempAdjustmentLevel.brightness = this.finetuneSettings.brightness.defaultValue;\n            }\n            if (this.finetuneSettings.contrast) {\n                this.adjustmentLevel.contrast = this.finetuneSettings.contrast.defaultValue;\n                this.tempAdjustmentLevel.contrast = this.finetuneSettings.contrast.defaultValue;\n            }\n            if (this.finetuneSettings.hue) {\n                this.adjustmentLevel.hue = this.finetuneSettings.hue.defaultValue;\n                this.tempAdjustmentLevel.hue = this.finetuneSettings.hue.defaultValue;\n            }\n            if (this.finetuneSettings.saturation) {\n                this.adjustmentLevel.saturation = this.finetuneSettings.saturation.defaultValue;\n                this.tempAdjustmentLevel.saturation = this.finetuneSettings.saturation.defaultValue;\n            }\n            if (this.finetuneSettings.exposure) {\n                this.adjustmentLevel.exposure = this.finetuneSettings.exposure.defaultValue;\n                this.tempAdjustmentLevel.exposure = this.finetuneSettings.exposure.defaultValue;\n            }\n            if (this.finetuneSettings.opacity) {\n                this.adjustmentLevel.opacity = this.finetuneSettings.opacity.defaultValue;\n                this.tempAdjustmentLevel.opacity = this.finetuneSettings.opacity.defaultValue;\n            }\n            if (this.finetuneSettings.blur) {\n                this.adjustmentLevel.blur = this.finetuneSettings.blur.defaultValue;\n                this.tempAdjustmentLevel.blur = this.finetuneSettings.blur.defaultValue;\n            }\n            this.isInitialLoading = true;\n        }\n    };\n    ImageEditor.prototype.initializeFilter = function () {\n        this.setBrightness(this.adjustmentLevel.brightness);\n        this.setContrast(this.adjustmentLevel.contrast);\n        this.setHue(this.adjustmentLevel.hue);\n        this.setSaturation(this.adjustmentLevel.saturation);\n        this.setExposure(this.adjustmentLevel.exposure);\n        this.setOpacity(this.adjustmentLevel.opacity);\n        this.setBlur(this.adjustmentLevel.blur);\n    };\n    /**\n     *\n     * This Method will add events to component (element, event, method, current reference)\n     *\n     * @returns {void}.\n     */\n    ImageEditor.prototype.wireEvent = function () {\n        EventHandler.add(document, 'keydown', this.keyDownEventHandler, this);\n        EventHandler.add(document, 'keypress', this.keyUpEventHandler, this);\n        EventHandler.add(this.upperCanvas, 'mousedown', this.mouseDownEventHandler, this);\n        EventHandler.add(this.upperCanvas, 'mousemove', this.mouseMoveEventHandler, this);\n        EventHandler.add(this.upperCanvas, 'mouseup', this.mouseUpEventHandler, this);\n        EventHandler.add(document, 'mouseup', this.mouseUpEventHandler, this);\n        EventHandler.add(this.lowerCanvas, 'mousedown', this.canvasMouseDownHandler, this);\n        EventHandler.add(this.lowerCanvas, 'mousemove', this.canvasMouseMoveHandler, this);\n        EventHandler.add(this.lowerCanvas, 'mouseup', this.canvasMouseUpHandler, this);\n        EventHandler.add(document, 'mouseup', this.canvasMouseUpHandler, this);\n        EventHandler.add(this.upperCanvas, 'touchstart', this.touchStartHandler, this);\n        EventHandler.add(this.lowerCanvas, 'touchstart', this.touchStartHandler, this);\n        EventHandler.add(this.upperCanvas, 'dblclick', this.findTextPoint, this);\n        EventHandler.add(this.textArea, 'mousedown', this.findTextPoint, this);\n        EventHandler.add(this.lowerCanvas, 'mousewheel DOMMouseScroll', this.handleScroll, this);\n        EventHandler.add(this.upperCanvas, 'mousewheel DOMMouseScroll', this.handleScroll, this);\n        window.addEventListener('resize', this.windowResizeHandler.bind(this));\n        if ((!Browser.isIos && Browser.info.name !== 'safari')) {\n            screen.orientation.addEventListener('change', this.screenOrientation.bind(this));\n        }\n    };\n    /**\n     *\n     * This Method will remove events from component\n     *\n     * @returns {void}.\n     */\n    ImageEditor.prototype.unwireEvent = function () {\n        EventHandler.remove(document, 'keydown', this.keyDownEventHandler);\n        EventHandler.remove(document, 'keypress', this.keyUpEventHandler);\n        EventHandler.remove(this.upperCanvas, 'mousedown', this.mouseDownEventHandler);\n        EventHandler.remove(this.upperCanvas, 'mousemove', this.mouseMoveEventHandler);\n        EventHandler.remove(this.upperCanvas, 'mouseup', this.mouseUpEventHandler);\n        EventHandler.remove(document, 'mouseup', this.mouseUpEventHandler);\n        EventHandler.remove(this.lowerCanvas, 'mousedown', this.canvasMouseDownHandler);\n        EventHandler.remove(this.lowerCanvas, 'mousemove', this.canvasMouseMoveHandler);\n        EventHandler.remove(this.lowerCanvas, 'mouseup', this.canvasMouseUpHandler);\n        EventHandler.remove(document, 'mouseup', this.canvasMouseUpHandler);\n    };\n    ImageEditor.prototype.destroySubComponents = function () {\n        var inputElement = this.element.querySelectorAll('input.e-control');\n        var btnElement = this.element.querySelectorAll('button.e-control');\n        for (var i = 0, len = inputElement.length; i < len; i++) {\n            if (inputElement[i].classList.contains('e-color-picker')) {\n                getComponent(inputElement[i], 'color-picker').destroy();\n                detach(select('input#' + inputElement[i].id, this.element));\n            }\n        }\n        for (var i = 0, len = btnElement.length; i < len; i++) {\n            if (btnElement[i].classList.contains('e-dropdown-btn')) {\n                getComponent(btnElement[i], 'dropdown-btn').destroy();\n                detach(select('button#' + btnElement[i].id, this.element));\n            }\n            else if (btnElement[i].classList.contains('e-btn')) {\n                getComponent(btnElement[i], 'btn').destroy();\n                detach(select('button#' + btnElement[i].id, this.element));\n            }\n        }\n    };\n    ImageEditor.prototype.updateTheme = function () {\n        if (this.theme !== '') {\n            this.theme = this.toPascalCase(this.theme);\n        }\n    };\n    ImageEditor.prototype.toPascalCase = function (str) {\n        var strArr = [];\n        if (!isNullOrUndefined(str)) {\n            strArr = str.toLowerCase().split('-');\n        }\n        for (var i = 0; i < strArr.length; i++) {\n            strArr[i] = strArr[i].charAt(0).toUpperCase() + strArr[i].slice(1);\n        }\n        return strArr.join('');\n    };\n    ImageEditor.prototype.createCanvas = function () {\n        this.element.style.boxSizing = 'border-box';\n        var height = this.toolbarHeight;\n        this.element.style.width = this.width;\n        this.element.style.height = this.height;\n        var canvasWrapper = this.element.appendChild(this.createElement('div', { id: this.element.id + '_canvasWrapper',\n            className: 'e-canvas-wrapper', attrs: { style: 'height:' + (this.element.offsetHeight - height - 2) + 'px; width:' +\n                    (this.element.offsetWidth - 2)\n                    + 'px; position: relative; overflow: hidden; margin: 0 auto;' }\n        }));\n        this.lowerCanvas = canvasWrapper.appendChild(this.createElement('canvas', {\n            id: this.element.id + '_lowerCanvas', attrs: { name: 'canvasImage' }\n        }));\n        this.upperCanvas = canvasWrapper.appendChild(this.createElement('canvas', {\n            id: this.element.id + '_upperCanvas', attrs: { name: 'canvasImage' }\n        }));\n        this.inMemoryCanvas = this.createElement('canvas', {\n            id: this.element.id + '_inMemoryCanvas', attrs: { name: 'canvasImage' }\n        });\n        this.textArea = canvasWrapper.appendChild(this.createElement('textarea', {\n            id: this.element.id + '_textArea', className: 'e-textarea', attrs: { name: 'textArea' }\n        }));\n        this.textArea.setAttribute('spellcheck', 'false');\n        this.lowerCanvas.style.width = this.upperCanvas.style.width = this.inMemoryCanvas.style.width = '100%';\n        this.lowerCanvas.style.height = this.upperCanvas.style.height = this.inMemoryCanvas.style.height = '100%';\n        this.upperCanvas.style.position = this.lowerCanvas.style.position = this.textArea.style.position = 'absolute';\n        this.textArea.style.backgroundColor = 'transparent';\n        this.textArea.style.display = 'none';\n        this.textArea.style.resize = 'none';\n        this.lowerContext = this.lowerCanvas.getContext('2d');\n        this.baseImg = this.createElement('img', {\n            id: this.element.id + '_orgImg', attrs: { name: 'Image', crossorigin: 'anonymous' }\n        });\n        this.upperCanvas.style.cursor = 'default';\n        this.upperCanvas.style.display = 'none';\n        this.upperContext = this.upperCanvas.getContext('2d');\n        this.inMemoryContext = this.inMemoryCanvas.getContext('2d');\n    };\n    ImageEditor.prototype.createToolbar = function () {\n        var _this = this;\n        if (isNullOrUndefined(this.toolbar) || (!isNullOrUndefined(this.toolbar) && this.toolbar.length > 0)) {\n            this.element.appendChild(this.createElement('div', {\n                id: this.element.id + '_toolbarArea', className: 'e-toolbar-area'\n            }));\n            if (this.toolbarTemplate) {\n                this.toolbarTemplateFn();\n            }\n            else {\n                var toolbarItems = { cssClass: 'e-image-upload', align: 'Left', type: 'Input',\n                    tooltipText: this.l10n.getConstant('Browse'), template: new Uploader({ allowedExtensions: '.jpg, .jpeg, .png,.svg' }) };\n                if (isNullOrUndefined(this.defToolbarItems)) {\n                    this.defToolbarItems = [];\n                }\n                this.defToolbarItems.push(toolbarItems);\n                var toolbarArea = document.getElementById(this.element.id + '_toolbarArea');\n                var toolbar_1 = this.createElement('div', {\n                    id: this.element.id + '_toolbar'\n                });\n                toolbarArea.appendChild(toolbar_1);\n                var uploadItems = [\n                    {\n                        cssClass: 'e-image-upload',\n                        align: 'Left', type: 'Input',\n                        tooltipText: this.l10n.getConstant('Browse'),\n                        template: new Uploader({\n                            allowedExtensions: '.jpg, .jpeg, .png,.svg',\n                            selected: function () {\n                                if (Browser.isDevice) {\n                                    if (_this.defToolbarItems.length > 0 &&\n                                        (!isNullOrUndefined(document.getElementById(_this.element.id + '_toolbar')))) {\n                                        getComponent(document.getElementById(_this.element.id + '_toolbar'), 'toolbar').destroy();\n                                    }\n                                    if (!isNullOrUndefined(document.getElementById(_this.element.id + '_bottomToolbar'))) {\n                                        getComponent(document.getElementById(_this.element.id + '_bottomToolbar'), 'toolbar').destroy();\n                                    }\n                                    _this.initToolbarItem(false, Browser.isDevice, null);\n                                    _this.createBottomToolbar();\n                                }\n                                else {\n                                    if (_this.defToolbarItems.length > 0 &&\n                                        (!isNullOrUndefined(document.getElementById(_this.element.id + '_toolbar')))) {\n                                        getComponent(document.getElementById(_this.element.id + '_toolbar'), 'toolbar').destroy();\n                                    }\n                                    _this.initToolbarItem(false, false, null);\n                                }\n                            }\n                        })\n                    }\n                ];\n                new Toolbar({ items: uploadItems, width: '100%',\n                    created: function () {\n                        _this.trigger('toolbarCreated', { toolbarType: 'main' });\n                    },\n                    clicked: this.defToolbarClicked.bind(this) }, '#' + this.element.id + '_toolbar');\n                this.createLeftToolbarControls();\n            }\n            if (!isNullOrUndefined(document.getElementById(this.element.id + '_toolbar'))) {\n                this.toolbarHeight = document.getElementById(this.element.id + '_toolbar').clientHeight;\n            }\n        }\n        else {\n            this.toolbarHeight = 0;\n        }\n    };\n    ImageEditor.prototype.createContextualToolbar = function () {\n        if (isNullOrUndefined(this.toolbar) || (!isNullOrUndefined(this.toolbar) && this.toolbar.length > 0)) {\n            this.element.appendChild(this.createElement('div', { id: this.element.id + '_contextualToolbarArea',\n                className: 'e-contextual-toolbar-wrapper e-hide', attrs: { style: 'position: absolute;' }\n            }));\n            var toolbarArea = document.getElementById(this.element.id + '_contextualToolbarArea');\n            var toolbar_2 = this.createElement('div', { id: this.element.id + '_contextualToolbar' });\n            toolbarArea.appendChild(toolbar_2);\n        }\n    };\n    ImageEditor.prototype.updateContextualToolbar = function (type, cType) {\n        if (this.toolbarTemplate) {\n            this.toolbarTemplateFn();\n        }\n        else {\n            var toolbarArea = this.element.querySelector('#' + this.element.id + '_toolbarArea');\n            var contextualToolbarArea = this.element.querySelector('#' + this.element.id + '_contextualToolbarArea');\n            contextualToolbarArea.classList.remove('e-hide');\n            contextualToolbarArea.style.left = toolbarArea.offsetLeft + 'px';\n            if (type === 'filter') {\n                if (document.getElementById(this.element.id + '_toolbar') && this.defToolbarItems.length > 0) {\n                    getComponent(document.getElementById(this.element.id + '_toolbar'), 'toolbar').destroy();\n                }\n                if (Browser.isDevice) {\n                    this.initToolbarItem(false, true, true);\n                }\n                else {\n                    this.initToolbarItem(true, null, null);\n                }\n                this.refreshSlider();\n                this.initFilterToolbarItem();\n            }\n            else {\n                if (document.querySelector('#' + this.element.id + '_contextualToolbar').classList.contains('e-control')) {\n                    getComponent(document.getElementById(this.element.id + '_contextualToolbar'), 'toolbar').destroy();\n                }\n                this.refreshSlider();\n                this.renderSlider(cType);\n            }\n            if (Browser.isDevice) {\n                var cHt = contextualToolbarArea.offsetHeight;\n                var ht = this.element.querySelector('#' + this.element.id + '_canvasWrapper').offsetHeight;\n                contextualToolbarArea.style.top = this.toolbarHeight + ht - cHt + 'px';\n            }\n            else {\n                contextualToolbarArea.style.top = this.toolbarHeight + 'px';\n            }\n        }\n    };\n    ImageEditor.prototype.createBottomToolbar = function () {\n        if (isNullOrUndefined(this.toolbar) || (!isNullOrUndefined(this.toolbar) && this.toolbar.length > 0)) {\n            this.element.appendChild(this.createElement('div', {\n                id: this.element.id + '_bottomToolbarArea', className: 'e-bottom-toolbar'\n            }));\n            if (!this.toolbarTemplate) {\n                document.getElementById(this.element.id + '_canvasWrapper').style.height = (this.element.offsetHeight\n                    - this.toolbarHeight * 2) - 3 + 'px';\n                var toolbarArea = document.getElementById(this.element.id + '_bottomToolbarArea');\n                var toolbarElem = this.createElement('div', {\n                    id: this.element.id + '_bottomToolbar'\n                });\n                toolbarArea.appendChild(toolbarElem);\n            }\n            this.initBottomToolbar();\n        }\n    };\n    ImageEditor.prototype.initBottomToolbar = function () {\n        var _this = this;\n        if (isNullOrUndefined(this.toolbar) || (!isNullOrUndefined(this.toolbar) && this.toolbar.length > 0)) {\n            if (this.toolbarTemplate) {\n                this.toolbarTemplateFn();\n            }\n            else {\n                var items = this.getMainToolbarItem();\n                new Toolbar({ items: items, width: '100%',\n                    created: function () {\n                        _this.renderAnnotationBtn();\n                        _this.renderCropBtn();\n                        _this.renderTransformBtn();\n                        _this.trigger('toolbarCreated', { toolbarType: 'main' });\n                    },\n                    clicked: this.defToolbarClicked.bind(this)\n                }, '#' + this.element.id + '_bottomToolbar');\n                if (this.defToolbarItems.length > 0 && (!isNullOrUndefined(document.getElementById(this.element.id + '_bottomToolbar')))) {\n                    /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                    var toolbar_3 = getComponent(this.element.id + '_bottomToolbar', 'toolbar');\n                    toolbar_3.refreshOverflow();\n                }\n            }\n        }\n    };\n    ImageEditor.prototype.toolbarTemplateFn = function () {\n        var template;\n        var templateID = this.element.id + '_toolbar';\n        var toolbarArea = this.element.querySelector('#' + this.element.id + '_toolbarArea');\n        if (this.toolbarTemplate) {\n            this.toolbarFn = this.templateParser(this.toolbarTemplate);\n            // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            if (this.isReact) {\n                template = this.toolbarFn({ type: 'toolbar' }, this, 'Template', templateID)[0];\n                // eslint-disable-next-line @typescript-eslint/no-explicit-any\n            }\n            else if (this.isAngular) {\n                var templateColl = this.toolbarFn({ type: 'toolbar' }, this, 'Template', templateID);\n                template = (templateColl[0].nodeType === 3) ? templateColl[1] : templateColl[0];\n            }\n            else {\n                template = this.toolbarFn({ type: 'toolbar' }, this, 'Template', templateID)[0];\n            }\n            toolbarArea.appendChild(template);\n            this.renderReactTemplates();\n        }\n    };\n    ImageEditor.prototype.templateParser = function (template) {\n        if (template) {\n            try {\n                if (document.querySelectorAll(template).length) {\n                    return templateCompiler(document.querySelector(template).innerHTML.trim());\n                }\n                else {\n                    return compile(template);\n                }\n            }\n            catch (error) {\n                return templateCompiler(template);\n            }\n        }\n        return undefined;\n    };\n    ImageEditor.prototype.getLeftToolbarItem = function (isOkBtn) {\n        var toolbarItems = [];\n        if (!isOkBtn) {\n            toolbarItems.push({ cssClass: 'e-image-upload', align: 'Left', type: 'Input', template: new Uploader({ allowedExtensions: '.jpg, .jpeg, .png,.svg' }) });\n            toolbarItems.push({ visible: false, cssClass: 'e-image-position e-btn e-flat', tooltipText: this.l10n.getConstant('Browse'), align: 'Left' });\n        }\n        if (this.allowUndoRedo) {\n            if (isNullOrUndefined(this.toolbar) || (!isNullOrUndefined(this.toolbar) && this.toolbar.indexOf('Undo') > -1)) {\n                toolbarItems.push({ id: this.element.id + '_undo', prefixIcon: 'e-icons e-undo', cssClass: 'top-icon e-undo',\n                    tooltipText: this.l10n.getConstant('Undo'), align: 'Left' });\n            }\n            if (isNullOrUndefined(this.toolbar) || (!isNullOrUndefined(this.toolbar) && this.toolbar.indexOf('Redo') > -1)) {\n                toolbarItems.push({ id: this.element.id + '_redo', prefixIcon: 'e-icons e-redo', cssClass: 'top-icon e-redo',\n                    tooltipText: this.l10n.getConstant('Redo'), align: 'Left' });\n            }\n        }\n        if (!this.preventZoomBtn) {\n            if (isNullOrUndefined(this.toolbar) || (!isNullOrUndefined(this.toolbar) && this.toolbar.indexOf('ZoomOut') > -1)) {\n                toolbarItems.push({ id: this.element.id + '_zoomOut', prefixIcon: 'e-icons e-zoom-out', cssClass: 'top-icon e-dec-zoom',\n                    tooltipText: this.l10n.getConstant('ZoomOut'), align: 'Left' });\n            }\n            if (isNullOrUndefined(this.toolbar) || (!isNullOrUndefined(this.toolbar) && this.toolbar.indexOf('ZoomIn') > -1)) {\n                toolbarItems.push({ id: this.element.id + '_zoomIn', prefixIcon: 'e-icons e-zoom-in', cssClass: 'top-icon e-inc-zoom',\n                    tooltipText: this.l10n.getConstant('ZoomIn'), align: 'Left' });\n            }\n        }\n        var tempToolbarItems = this.processToolbar('left');\n        for (var i = 0, len = tempToolbarItems.length; i < len; i++) {\n            toolbarItems.push(tempToolbarItems[i]);\n        }\n        return toolbarItems;\n    };\n    ImageEditor.prototype.getRightToolbarItem = function (isOkBtn) {\n        var toolbarItems = [];\n        if (isOkBtn) {\n            toolbarItems.push({ id: this.element.id + '_ok', prefixIcon: 'e-icons e-check', cssClass: 'top-icon e-tick',\n                tooltipText: this.l10n.getConstant('OK'), align: 'Right' });\n            toolbarItems.push({ id: this.element.id + '_cancel', prefixIcon: 'e-icons e-close', cssClass: 'top-icon e-save',\n                tooltipText: this.l10n.getConstant('Cancel'), align: 'Right' });\n        }\n        if (isNullOrUndefined(this.toolbar) || (!isNullOrUndefined(this.toolbar) && this.toolbar.indexOf('Reset') > -1)) {\n            toolbarItems.push({ id: this.element.id + '_reset', prefixIcon: 'e-icons e-btn-reset', cssClass: 'top-icon e-img-reset',\n                tooltipText: this.l10n.getConstant('Reset'), align: 'Right' });\n        }\n        if (!isOkBtn) {\n            if (isNullOrUndefined(this.toolbar) || (!isNullOrUndefined(this.toolbar) && this.toolbar.indexOf('Save') > -1)) {\n                toolbarItems.push({ id: this.element.id + '_save', prefixIcon: 'e-icons e-btn-save', cssClass: 'top-icon e-save',\n                    tooltipText: this.l10n.getConstant('Save'), align: 'Right', template: '<button id=\"' + this.element.id + '_saveBtn\"></button>' });\n            }\n        }\n        var tempToolbarItems = this.processToolbar('right');\n        for (var i = 0, len = tempToolbarItems.length; i < len; i++) {\n            toolbarItems.push(tempToolbarItems[i]);\n        }\n        return toolbarItems;\n    };\n    ImageEditor.prototype.getMainToolbarItem = function (isApplyOption) {\n        var toolbarItems = [];\n        if (isNullOrUndefined(this.toolbar) || (!isNullOrUndefined(this.toolbar) && this.toolbar.indexOf('Crop') > -1)) {\n            toolbarItems.push({ id: this.element.id + '_crop', tooltipText: this.l10n.getConstant('Crop'), align: 'Center',\n                template: '<button id=\"' + this.element.id + '_cropBtn\"></button>'\n            });\n        }\n        if (isNullOrUndefined(this.toolbar) || (!isNullOrUndefined(this.toolbar) && this.toolbar.indexOf('Annotate') > -1)) {\n            toolbarItems.push({ id: this.element.id + '_annotation', tooltipText: this.l10n.getConstant('Annotation'), align: 'Center',\n                template: '<button id=\"' + this.element.id + '_annotationBtn\"></button>' });\n        }\n        if (isNullOrUndefined(this.toolbar) || (!isNullOrUndefined(this.toolbar) && this.toolbar.indexOf('Transform') > -1)) {\n            toolbarItems.push({ id: this.element.id + '_transform', tooltipText: this.l10n.getConstant('Transform'), align: 'Center',\n                template: '<button id=\"' + this.element.id + '_transformBtn\"></button>'\n            });\n        }\n        if (isNullOrUndefined(this.toolbar) || (!isNullOrUndefined(this.toolbar) && this.toolbar.indexOf('Finetune') > -1)) {\n            toolbarItems.push({ id: this.element.id + '_adjustment', prefixIcon: 'e-icons e-adjustment', cssClass: 'top-icon e-adjustment',\n                tooltipText: this.l10n.getConstant('Finetune'), align: 'Center' });\n        }\n        if (isNullOrUndefined(this.toolbar) || (!isNullOrUndefined(this.toolbar) && this.toolbar.indexOf('Filter') > -1)) {\n            toolbarItems.push({ id: this.element.id + '_filter', prefixIcon: 'e-icons e-filters', cssClass: 'top-icon e-filters',\n                tooltipText: this.l10n.getConstant('Filter'), align: 'Center' });\n        }\n        var tempToolbarItems = this.processToolbar('center');\n        for (var i = 0, len = tempToolbarItems.length; i < len; i++) {\n            toolbarItems.push(tempToolbarItems[i]);\n        }\n        if (isApplyOption) {\n            toolbarItems.push({ id: this.element.id + '_ok', prefixIcon: 'e-icons e-check', cssClass: 'top-icon e-tick',\n                tooltipText: this.l10n.getConstant('OK'), align: 'Right' });\n            toolbarItems.push({ id: this.element.id + '_cancel', prefixIcon: 'e-icons e-close', cssClass: 'top-icon e-save',\n                tooltipText: this.l10n.getConstant('Cancel'), align: 'Right' });\n        }\n        return toolbarItems;\n    };\n    ImageEditor.prototype.getZoomToolbarItem = function () {\n        var toolbarItems = [];\n        return toolbarItems;\n    };\n    ImageEditor.prototype.processToolbar = function (position) {\n        var toolbarItems = [];\n        if (this.toolbar) {\n            for (var i = 0, len = this.toolbar.length; i < len; i++) {\n                if (typeof (this.toolbar[i]) === 'object') {\n                    if (isNullOrUndefined(this.toolbar[i].align)) {\n                        if (position === 'left') {\n                            toolbarItems.push(this.toolbar[i]);\n                        }\n                    }\n                    else if (this.toolbar[i].align.toLowerCase() === position) {\n                        toolbarItems.push(this.toolbar[i]);\n                    }\n                }\n            }\n        }\n        return toolbarItems;\n    };\n    ImageEditor.prototype.processSubToolbar = function (items) {\n        var toolbarItems = [];\n        if (items) {\n            for (var i = 0, len = items.length; i < len; i++) {\n                if (typeof (items[i]) === 'object') {\n                    items[i].align = 'Center';\n                    toolbarItems.push(items[i]);\n                }\n            }\n        }\n        return toolbarItems;\n    };\n    ImageEditor.prototype.isToolbar = function () {\n        return (isNullOrUndefined(this.toolbar) || (!isNullOrUndefined(this.toolbar) && this.toolbar.length > 0)\n            || !isNullOrUndefined(this.toolbarTemplate));\n    };\n    ImageEditor.prototype.initToolbarItem = function (isApplyOption, isDevice, isOkBtn) {\n        var _this = this;\n        if (this.isToolbar()) {\n            var leftItem = this.getLeftToolbarItem(isOkBtn);\n            var rightItem = this.getRightToolbarItem(isOkBtn);\n            var mainItem = this.getMainToolbarItem(isApplyOption);\n            var zoomItem = this.getZoomToolbarItem();\n            if (isDevice) {\n                this.defToolbarItems = leftItem.concat(rightItem);\n            }\n            else {\n                this.defToolbarItems = leftItem.concat(mainItem, rightItem, zoomItem);\n            }\n            new Toolbar({\n                width: '100%',\n                items: this.defToolbarItems,\n                clicked: this.defToolbarClicked.bind(this),\n                created: function () {\n                    if (!isDevice) {\n                        _this.renderAnnotationBtn();\n                        _this.renderCropBtn();\n                        _this.renderTransformBtn();\n                    }\n                    _this.renderSaveBtn();\n                    _this.trigger('toolbarCreated', { toolbarType: 'main' });\n                }\n            }, '#' + this.element.id + '_toolbar');\n            this.createLeftToolbarControls();\n            this.enableDisableToolbarBtn();\n            if (this.isToolbar() && (!isNullOrUndefined(document.getElementById(this.element.id + '_toolbar')))) {\n                /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                var toolbar_4 = getComponent(this.element.id + '_toolbar', 'toolbar');\n                toolbar_4.refreshOverflow();\n            }\n        }\n    };\n    ImageEditor.prototype.enableDisableToolbarBtn = function () {\n        var undo = document.querySelector('#' + this.element.id + '_undo');\n        if (!isNullOrUndefined(undo) && this.undoRedoStep === 0) {\n            undo.classList.add('e-disabled');\n            undo.parentElement.classList.add('e-overlay');\n        }\n        else if (!isNullOrUndefined(undo)) {\n            undo.classList.remove('e-disabled');\n            undo.parentElement.classList.remove('e-overlay');\n        }\n        var redo = document.querySelector('#' + this.element.id + '_redo');\n        if (!isNullOrUndefined(redo) && (this.undoRedoStep === this.undoRedoColl.length)) {\n            redo.classList.add('e-disabled');\n            redo.parentElement.classList.add('e-overlay');\n        }\n        else if (!isNullOrUndefined(redo) && (this.undoRedoStep === 0 && this.undoRedoColl.length > 0)) {\n            redo.classList.remove('e-disabled');\n            redo.parentElement.classList.remove('e-overlay');\n        }\n        else if (!isNullOrUndefined(redo)) {\n            redo.classList.remove('e-disabled');\n            redo.parentElement.classList.remove('e-overlay');\n        }\n        var zoomIn = document.querySelector('#' + this.element.id + '_zoomIn');\n        if (!isNullOrUndefined(zoomIn) && this.zoomFactor >= 2) {\n            zoomIn.classList.add('e-disabled');\n            zoomIn.parentElement.classList.add('e-overlay');\n        }\n        else if (!isNullOrUndefined(zoomIn)) {\n            zoomIn.classList.remove('e-disabled');\n            zoomIn.parentElement.classList.remove('e-overlay');\n        }\n        var zoomOut = document.querySelector('#' + this.element.id + '_zoomOut');\n        if (!isNullOrUndefined(zoomOut) && this.zoomFactor === 0) {\n            zoomOut.classList.add('e-disabled');\n            zoomOut.parentElement.classList.add('e-overlay');\n        }\n        else if (!isNullOrUndefined(zoomOut)) {\n            zoomOut.classList.remove('e-disabled');\n            zoomOut.parentElement.classList.remove('e-overlay');\n        }\n        var pan = document.querySelector('#' + this.element.id + '_pan');\n        if (!isNullOrUndefined(pan) && this.zoomFactor === 0) {\n            pan.style.display = 'none';\n        }\n        else if (!isNullOrUndefined(pan)) {\n            pan.style.display = 'block';\n        }\n    };\n    ImageEditor.prototype.createLeftToolbarControls = function () {\n        if (this.defToolbarItems !== undefined && this.defToolbarItems.length > 0 &&\n            (!isNullOrUndefined(document.getElementById(this.element.id + '_toolbar')))) {\n            var uploadDiv = document.getElementById(this.element.id + '_toolbar')\n                .querySelector('.e-image-upload');\n            if (uploadDiv) {\n                var uploadElem = uploadDiv.getElementsByTagName('input')[0];\n                var uploadBtnElem = uploadDiv.getElementsByTagName('button')[0];\n                uploadBtnElem.className = 'e-tbar-btn e-tbtn-txt e-btn top-icon';\n                uploadBtnElem.innerHTML = '';\n                uploadBtnElem.appendChild(this.createElement('span', {\n                    className: 'e-btn-icon e-icons e-upload-icon e-icon-left'\n                }));\n                uploadElem.onchange = this.fileSelect.bind(this, uploadElem);\n            }\n        }\n    };\n    ImageEditor.prototype.cropSelectedState = function () {\n        if (!isNullOrUndefined(this.activeObj.shape) && this.activeObj.shape.split('-')[0] === 'crop') {\n            this.okBtn();\n        }\n    };\n    ImageEditor.prototype.renderAnnotationBtn = function () {\n        var _this = this;\n        // eslint-disable-next-line @typescript-eslint/no-this-alias\n        var proxy = this;\n        var items = [];\n        if (isNullOrUndefined(this.toolbar) || (!isNullOrUndefined(this.toolbar) && this.toolbar.indexOf('Pen') > -1)) {\n            items.push({ text: this.l10n.getConstant('Pen'), id: 'pen', iconCss: 'e-icons e-free-pen' });\n        }\n        if (isNullOrUndefined(this.toolbar) || (!isNullOrUndefined(this.toolbar) && this.toolbar.indexOf('Line') > -1)) {\n            items.push({ text: this.l10n.getConstant('Line'), id: 'line', iconCss: 'e-icons e-line' });\n        }\n        if (isNullOrUndefined(this.toolbar) || (!isNullOrUndefined(this.toolbar) && this.toolbar.indexOf('Rectangle') > -1)) {\n            items.push({ text: this.l10n.getConstant('Rectangle'), id: 'rectangle', iconCss: 'e-icons e-rectangle' });\n        }\n        if (isNullOrUndefined(this.toolbar) || (!isNullOrUndefined(this.toolbar) && this.toolbar.indexOf('Ellipse') > -1)) {\n            items.push({ text: this.l10n.getConstant('Ellipse'), id: 'ellipse', iconCss: 'e-icons e-circle' });\n        }\n        if (isNullOrUndefined(this.toolbar) || (!isNullOrUndefined(this.toolbar) && this.toolbar.indexOf('Text') > -1)) {\n            items.push({ text: this.l10n.getConstant('Text'), id: 'text', iconCss: 'e-icons e-add-text' });\n        }\n        var drpDownBtn = new DropDownButton({ items: items, iconCss: 'e-icons e-annotation',\n            cssClass: 'e-image-popup',\n            open: function (args) {\n                if (_this.currObjType.isUndoAction) {\n                    _this.refreshUndoRedoColl();\n                }\n                if (Browser.isDevice) {\n                    args.element.parentElement.style.top = drpDownBtn.element.getBoundingClientRect().top -\n                        args.element.parentElement.offsetHeight + 'px';\n                }\n            },\n            select: function (args) {\n                _this.cropSelectedState();\n                var isCropSelection = false;\n                var splitWords;\n                if (_this.activeObj.shape !== undefined) {\n                    splitWords = _this.activeObj.shape.split('-');\n                }\n                if (splitWords === undefined && _this.currObjType.isCustomCrop) {\n                    isCropSelection = true;\n                }\n                else if (splitWords !== undefined && splitWords[0] === 'crop') {\n                    isCropSelection = true;\n                }\n                _this.currObjType.isCustomCrop = false;\n                if (isCropSelection || _this.togglePan) {\n                    _this.refreshActiveObj();\n                    _this.upperContext.clearRect(0, 0, _this.upperCanvas.width, _this.upperCanvas.height);\n                    _this.refreshToolbar('main');\n                }\n                switch (args.item.id) {\n                    case 'pen':\n                        proxy.tempFreehandCounter = proxy.freehandCounter;\n                        proxy.tempCurrentFreehandDrawIndex = proxy.currentFreehandDrawIndex;\n                        proxy.currentToolbar = 'pen';\n                        _this.freeHandDraw(true);\n                        break;\n                    case 'text':\n                        proxy.currentToolbar = 'text';\n                        _this.drawShapeText();\n                        break;\n                    default:\n                        proxy.currentToolbar = 'shapes';\n                        proxy.drawShape((args.item.id).toLowerCase());\n                        break;\n                }\n                _this.updateToolbarItems();\n            }\n        });\n        // Render initialized DropDownButton.\n        drpDownBtn.appendTo('#' + this.element.id + '_annotationBtn');\n    };\n    ImageEditor.prototype.renderCropBtn = function () {\n        var _this = this;\n        var items = [];\n        if (isNullOrUndefined(this.toolbar) || (!isNullOrUndefined(this.toolbar) && this.toolbar.indexOf('CustomSelection') > -1)) {\n            items.push({ text: this.l10n.getConstant('Custom'), id: 'custom', iconCss: 'e-icons e-custom' });\n        }\n        if (isNullOrUndefined(this.toolbar) || (!isNullOrUndefined(this.toolbar) && this.toolbar.indexOf('CircleSelection') > -1)) {\n            items.push({ text: this.l10n.getConstant('Circle'), id: 'circle', iconCss: 'e-icons e-circle' });\n        }\n        if (isNullOrUndefined(this.toolbar) || (!isNullOrUndefined(this.toolbar) && this.toolbar.indexOf('SquareSelection') > -1)) {\n            items.push({ text: this.l10n.getConstant('Square'), id: 'square', iconCss: 'e-icons e-square' });\n        }\n        if (isNullOrUndefined(this.toolbar) || (!isNullOrUndefined(this.toolbar) && this.toolbar.indexOf('RatioSelection') > -1)) {\n            items.push({ text: '3:2', id: '3:2', iconCss: 'e-icons e-custom-a' });\n            items.push({ text: '4:3', id: '4:3', iconCss: 'e-icons e-custom-b' });\n            items.push({ text: '5:4', id: '5:4', iconCss: 'e-icons e-custom-c' });\n            items.push({ text: '7:5', id: '7:5', iconCss: 'e-icons e-custom-d' });\n            items.push({ text: '16:9', id: '16:9', iconCss: 'e-icons e-custom-e' });\n        }\n        var drpDownBtn = new DropDownButton({\n            open: function (args) {\n                if (_this.currObjType.isUndoAction) {\n                    _this.refreshUndoRedoColl();\n                }\n                if (_this.togglePan) {\n                    _this.cancelPan();\n                }\n                if (Browser.isDevice) {\n                    args.element.parentElement.style.top = drpDownBtn.element.getBoundingClientRect().top -\n                        args.element.parentElement.offsetHeight + 'px';\n                }\n                if (!isNullOrUndefined(_this.activeObj.shape) && _this.activeObj.shape.split('-').length > 1) {\n                    document.getElementById(_this.activeObj.shape.split('-')[1]).classList.add('e-selected');\n                }\n            },\n            items: items, select: this.cropSelect.bind(this),\n            iconCss: 'e-icons e-select', cssClass: 'e-image-popup'\n        });\n        drpDownBtn.appendTo('#' + this.element.id + '_cropBtn');\n    };\n    ImageEditor.prototype.renderTransformBtn = function () {\n        var _this = this;\n        var items = [];\n        if (isNullOrUndefined(this.toolbar) || (!isNullOrUndefined(this.toolbar) && this.toolbar.indexOf('RotateLeft') > -1)) {\n            items.push({ text: this.l10n.getConstant('RotateLeft'), id: 'rotateleft', iconCss: 'e-icons e-anti-clock-wise' });\n        }\n        if (isNullOrUndefined(this.toolbar) || (!isNullOrUndefined(this.toolbar) && this.toolbar.indexOf('RotateRight') > -1)) {\n            items.push({ text: this.l10n.getConstant('RotateRight'), id: 'rotateright', iconCss: 'e-icons e-clock-wise' });\n        }\n        if (isNullOrUndefined(this.toolbar) || (!isNullOrUndefined(this.toolbar) && this.toolbar.indexOf('FlipHorizontal') > -1)) {\n            items.push({ text: this.l10n.getConstant('HorizontalFlip'), id: 'horizontalflip', iconCss: 'e-icons e-horizontal-flip' });\n        }\n        if (isNullOrUndefined(this.toolbar) || (!isNullOrUndefined(this.toolbar) && this.toolbar.indexOf('FlipVertical') > -1)) {\n            items.push({ text: this.l10n.getConstant('VerticalFlip'), id: 'verticalflip', iconCss: 'e-icons e-vertical-flip' });\n        }\n        var drpDownBtn = new DropDownButton({\n            open: function (args) {\n                if (_this.currObjType.isUndoAction) {\n                    _this.refreshUndoRedoColl();\n                }\n                if (Browser.isDevice) {\n                    var ht = args.element.parentElement.offsetHeight;\n                    args.element.parentElement.style.display = 'none';\n                    args.element.parentElement.style.top = drpDownBtn.element.getBoundingClientRect().top -\n                        ht + 'px';\n                    args.element.parentElement.style.display = 'block';\n                }\n            },\n            items: items, select: this.transformSelect.bind(this),\n            iconCss: 'e-icons e-transform', cssClass: 'e-image-popup'\n        });\n        drpDownBtn.appendTo('#' + this.element.id + '_transformBtn');\n    };\n    ImageEditor.prototype.renderSaveBtn = function () {\n        var imageEditorObj = getInstance(document.getElementById(this.element.id), ImageEditor_1);\n        var saveItems = [\n            { text: 'JPEG', id: 'jpeg' },\n            { text: 'PNG', id: 'png' },\n            { text: 'SVG', id: 'svg' }\n        ];\n        var ddbElem = document.getElementById(this.element.id + '_saveBtn');\n        if (ddbElem) {\n            // Initialize the DropDownButton component.\n            var saveDrpDownBtn = new DropDownButton({ items: saveItems, cssClass: 'e-caret-hide e-image-popup', iconCss: 'e-icons e-save',\n                select: function (args) {\n                    imageEditorObj.export(args.item.text);\n                }\n            });\n            saveDrpDownBtn.appendTo('#' + this.element.id + '_saveBtn');\n        }\n    };\n    ImageEditor.prototype.cropSelect = function (args) {\n        this.isCropTab = true;\n        this.zoomFactor = this.cropZoomFactor;\n        var prevCropObj = extend({}, this.cropObj, {}, true);\n        var previousObj = this.getCurrentObj();\n        previousObj.objColl = extend([], this.objColl, [], true);\n        previousObj.pointColl = extend([], this.pointColl, [], true);\n        previousObj.afterCropActions = this.afterCropActions;\n        var text = args.item.id;\n        this.currentToolbar = 'crop';\n        this.currSelectionPoint = null;\n        this.select(text);\n        this.refreshToolbar('main', true, true);\n        this.refreshDropDownBtn(true);\n        this.updateUndoRedoColl('selectionTransform', previousObj, previousObj.objColl, previousObj.pointColl, prevCropObj);\n        this.enableDisableToolbarBtn();\n    };\n    ImageEditor.prototype.transformSelect = function (args) {\n        this.cropSelectedState();\n        this.currentSelectionPoint = null;\n        this.performTransformation(args.item.id);\n    };\n    ImageEditor.prototype.performTransformation = function (text) {\n        var tempZoomFactor = this.defaultZoomFactor;\n        var isUndoRedo = this.isUndoRedo;\n        var prevCropObj = extend({}, this.cropObj, {}, true);\n        if (this.defaultZoomFactor !== 0) {\n            this.transformCurrentObj = this.getCurrentObj();\n            this.transformCurrentObj.objColl = extend([], this.objColl, null, true);\n            this.transformCurrentObj.pointColl = extend({}, this.pointColl, null, true);\n            this.transformCurrentObj.afterCropActions = extend([], this.afterCropActions, [], true);\n            this.isUndoRedo = true;\n            if (this.defaultZoomFactor > 0) {\n                this.zoom(-this.defaultZoomFactor);\n            }\n            else {\n                this.zoom(Math.abs(this.defaultZoomFactor));\n            }\n            this.isUndoRedo = isUndoRedo;\n        }\n        this.updateTransform(text);\n        if (tempZoomFactor !== 0) {\n            this.isUndoRedo = true;\n            this.zoom(tempZoomFactor);\n            this.isUndoRedo = isUndoRedo;\n            var state = '';\n            if (text === 'rotateleft' || text === 'rotateright') {\n                state = 'rotate';\n            }\n            else if (text === 'horizontalflip' || text === 'verticalflip') {\n                state = 'flip';\n            }\n            this.updateUndoRedoColl(state, this.transformCurrentObj, this.transformCurrentObj.objColl, this.transformCurrentObj.pointColl, prevCropObj);\n            this.transformCurrentObj = null;\n        }\n    };\n    ImageEditor.prototype.updateTransform = function (text) {\n        switch (text.toLowerCase()) {\n            case 'rotateleft':\n                this.rotate(-90);\n                break;\n            case 'rotateright':\n                this.rotate(90);\n                break;\n            case 'horizontalflip':\n                this.flip('Horizontal');\n                break;\n            case 'verticalflip':\n                this.flip('Vertical');\n                break;\n        }\n    };\n    ImageEditor.prototype.getShapesToolbarItem = function (items) {\n        var toolbarItems = [];\n        if (items.indexOf('fillColor') > -1) {\n            toolbarItems.push({ prefixIcon: 'e-icons e-copy', id: this.element.id + '_fillcolor',\n                cssClass: 'top-icon e-fill', tooltipText: this.l10n.getConstant('FillColor'), align: 'Center', type: 'Input',\n                template: '<button id=\"' + this.element.id + '_fillColorBtn\"></button>' });\n        }\n        if (items.indexOf('strokeColor') > -1) {\n            toolbarItems.push({ prefixIcon: 'e-icons e-copy', id: this.element.id + '_strokecolor',\n                cssClass: 'top-icon e-stroke', tooltipText: this.l10n.getConstant('StrokeColor'), align: 'Center', type: 'Input',\n                template: '<button id=\"' + this.element.id + '_borderColorBtn\"></button>' });\n        }\n        if (items.indexOf('strokeWidth') > -1) {\n            toolbarItems.push({ id: this.element.id + '_strokeWidth', cssClass: 'top-icon e-size', tooltipText: 'Stroke Width', align: 'Center',\n                type: 'Input', template: '<button id=\"' + this.element.id + '_borderWidthBtn\"></button>' });\n        }\n        var tempToolbarItems = this.processSubToolbar(items);\n        for (var i = 0, len = tempToolbarItems.length; i < len; i++) {\n            toolbarItems.push(tempToolbarItems[i]);\n        }\n        if (!Browser.isDevice) {\n            toolbarItems.push({ id: this.element.id + '_ok', prefixIcon: 'e-icons e-check', cssClass: 'top-icon e-tick',\n                tooltipText: this.l10n.getConstant('OK'), align: 'Right' });\n            toolbarItems.push({ id: this.element.id + '_cancel', prefixIcon: 'e-icons e-close', cssClass: 'top-icon e-save',\n                tooltipText: this.l10n.getConstant('Cancel'), align: 'Right' });\n        }\n        return toolbarItems;\n    };\n    ImageEditor.prototype.initShapesToolbarItem = function (items) {\n        var _this = this;\n        var leftItem = this.getLeftToolbarItem();\n        var rightItem = this.getRightToolbarItem();\n        var mainItem = this.getShapesToolbarItem(items);\n        var zoomItem = this.getZoomToolbarItem();\n        if (Browser.isDevice) {\n            this.defToolbarItems = mainItem;\n        }\n        else {\n            this.defToolbarItems = leftItem.concat(zoomItem, mainItem, rightItem);\n        }\n        var toolbar = new Toolbar({\n            width: '100%',\n            items: this.defToolbarItems,\n            clicked: this.defToolbarClicked.bind(this),\n            created: function () {\n                _this.createShapeColor(items);\n                _this.createShapeBtn(items);\n                if (!Browser.isDevice) {\n                    _this.renderSaveBtn();\n                }\n                _this.trigger('toolbarCreated', { toolbarType: 'shapes' });\n                if (Browser.isDevice) {\n                    if (_this.defToolbarItems.length > 0 && (!isNullOrUndefined(document.getElementById(_this.element.id + '_bottomToolbar')))) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        toolbar.refreshOverflow();\n                    }\n                }\n                else {\n                    _this.createLeftToolbarControls();\n                    if (_this.defToolbarItems.length > 0 && (!isNullOrUndefined(document.getElementById(_this.element.id + '_toolbar')))) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        toolbar.refreshOverflow();\n                    }\n                }\n            }\n        });\n        if (Browser.isDevice) {\n            toolbar.appendTo('#' + this.element.id + '_bottomToolbar');\n        }\n        else {\n            toolbar.appendTo('#' + this.element.id + '_toolbar');\n        }\n        this.enableDisableToolbarBtn();\n    };\n    ImageEditor.prototype.createShapeColor = function (items) {\n        var _this = this;\n        // eslint-disable-next-line @typescript-eslint/no-this-alias\n        var proxy = this;\n        if (items.indexOf('fillColor') > -1) {\n            this.element.querySelector('.e-template.e-fill').appendChild(this.createElement('input', {\n                id: this.element.id + '_shape_fill'\n            }));\n            var fillColor = new ColorPicker({\n                modeSwitcher: false, noColor: true, value: '',\n                showButtons: false, mode: 'Palette', cssClass: 'e-shape-fill-color',\n                change: function (args) {\n                    _this.pushActItemIntoObj();\n                    var prevCropObj = extend({}, _this.cropObj, {}, true);\n                    var prevObj = _this.getCurrentObj();\n                    prevObj.objColl = extend([], _this.objColl, [], true);\n                    prevObj.pointColl = extend([], _this.pointColl, [], true);\n                    prevObj.afterCropActions = extend([], _this.afterCropActions, [], true);\n                    _this.objColl.pop();\n                    proxy.activeObj.strokeSettings.fillColor = args.currentValue.hex;\n                    proxy.strokeSettings.fillColor = proxy.activeObj.strokeSettings.fillColor;\n                    _this.objColl.push(_this.activeObj);\n                    _this.updateUndoRedoColl('shapeTransform', prevObj, prevObj.objColl, prevObj.pointColl, prevCropObj);\n                    proxy.redrawShape(proxy.objColl[proxy.objColl.length - 1]);\n                    if (args.currentValue.rgba === '') {\n                        fillDDB_1.element.children[0].classList.add('e-nocolor-item');\n                    }\n                    else {\n                        fillDDB_1.element.children[0].classList.remove('e-nocolor-item');\n                        fillDDB_1.element.children[0].style.backgroundColor = args.currentValue.rgba;\n                    }\n                    fillDDB_1.toggle();\n                }\n            }, '#' + this.element.id + '_shape_fill');\n            var fillDDB_1 = new DropDownButton({\n                open: function (args) {\n                    if (Browser.isDevice) {\n                        args.element.parentElement.style.top = fillDDB_1.element.getBoundingClientRect().top -\n                            args.element.parentElement.offsetHeight + 'px';\n                        args.element.parentElement.style.left = _this.element.offsetLeft + 'px';\n                    }\n                },\n                target: '.e-shape-fill-color',\n                iconCss: 'e-dropdownbtn-preview'\n            }, '#' + this.element.id + '_fillColorBtn');\n            fillColor.inline = true;\n            this.element.querySelector('.e-fill.e-template .e-dropdownbtn-preview').classList.add('e-nocolor-item');\n        }\n        if (items.indexOf('strokeColor') > -1) {\n            this.element.querySelector('.e-template.e-stroke').appendChild(this.createElement('input', {\n                id: this.element.id + '_shape_stroke'\n            }));\n            var strokeColor = new ColorPicker({\n                modeSwitcher: false, noColor: false, value: '#fff',\n                showButtons: false, mode: 'Palette', cssClass: 'e-shape-stroke-color',\n                change: function (args) {\n                    _this.pushActItemIntoObj();\n                    var prevCropObj = extend({}, _this.cropObj, {}, true);\n                    var prevObj = _this.getCurrentObj();\n                    prevObj.objColl = extend([], _this.objColl, [], true);\n                    prevObj.pointColl = extend([], _this.pointColl, [], true);\n                    prevObj.afterCropActions = extend([], _this.afterCropActions, [], true);\n                    _this.objColl.pop();\n                    proxy.activeObj.strokeSettings.strokeColor = args.currentValue.hex;\n                    proxy.strokeSettings.strokeColor = proxy.activeObj.strokeSettings.strokeColor;\n                    if (!proxy.togglePen) {\n                        _this.objColl.push(_this.activeObj);\n                        proxy.updateUndoRedoColl('shapeTransform', prevObj, prevObj.objColl, prevObj.pointColl, prevCropObj);\n                        proxy.redrawShape(proxy.objColl[proxy.objColl.length - 1]);\n                    }\n                    strokeDDB_1.element.children[0].style.backgroundColor = args.currentValue.rgba;\n                    strokeDDB_1.toggle();\n                }\n            }, '#' + this.element.id + '_shape_stroke');\n            var strokeDDB_1 = new DropDownButton({\n                open: function (args) {\n                    if (Browser.isDevice) {\n                        args.element.parentElement.style.top = strokeDDB_1.element.getBoundingClientRect().top -\n                            args.element.parentElement.offsetHeight + 'px';\n                        args.element.parentElement.style.left = _this.element.offsetLeft + 'px';\n                    }\n                },\n                target: '.e-shape-stroke-color',\n                iconCss: 'e-dropdownbtn-preview'\n            }, '#' + this.element.id + '_borderColorBtn');\n            strokeColor.inline = true;\n            this.element.querySelector('.e-stroke.e-template .e-dropdownbtn-preview').style.background = '#fff';\n        }\n    };\n    ImageEditor.prototype.createShapeBtn = function (items) {\n        var _this = this;\n        var strokeWidthItems = [\n            { id: '1', text: this.l10n.getConstant('XSmall') },\n            { id: '2', text: this.l10n.getConstant('Small') },\n            { id: '3', text: this.l10n.getConstant('Medium') },\n            { id: '4', text: this.l10n.getConstant('Large') },\n            { id: '5', text: this.l10n.getConstant('XLarge') }\n        ];\n        if (items.indexOf('strokeWidth') > -1) {\n            var strokeWidthBtn = document.getElementById(this.element.id + '_borderWidthBtn');\n            var spanElem_1 = document.createElement('span');\n            spanElem_1.innerHTML = this.l10n.getConstant('Small');\n            spanElem_1.className = 'e-shape-stroke-width';\n            strokeWidthBtn.appendChild(spanElem_1);\n            // Initialize the DropDownButton component.\n            var drpDownBtn_1 = new DropDownButton({ items: strokeWidthItems,\n                open: function (args) {\n                    if (Browser.isDevice) {\n                        args.element.parentElement.style.top = drpDownBtn_1.element.getBoundingClientRect().top -\n                            args.element.parentElement.offsetHeight + 'px';\n                    }\n                    var activeBtn = spanElem_1.innerHTML;\n                    if (activeBtn !== '') {\n                        args.element.querySelector('[aria-label = ' + '\"' + activeBtn + '\"' + ']').classList.add('e-selected-btn');\n                    }\n                },\n                select: function (args) {\n                    _this.pushActItemIntoObj();\n                    var prevCropObj = extend({}, _this.cropObj, {}, true);\n                    var prevObj = _this.getCurrentObj();\n                    prevObj.objColl = extend([], _this.objColl, [], true);\n                    prevObj.pointColl = extend([], _this.pointColl, [], true);\n                    prevObj.afterCropActions = extend([], _this.afterCropActions, [], true);\n                    _this.objColl.pop();\n                    spanElem_1.textContent = args.item.text;\n                    _this.activeObj.strokeSettings.strokeWidth = parseInt(args.item.id, 10);\n                    _this.activeObj.strokeSettings.strokeWidth *= 2;\n                    _this.strokeSettings.strokeWidth = _this.activeObj.strokeSettings.strokeWidth;\n                    _this.objColl.push(_this.activeObj);\n                    _this.updateUndoRedoColl('shapeTransform', prevObj, prevObj.objColl, prevObj.pointColl, prevCropObj);\n                    _this.redrawShape(_this.objColl[_this.objColl.length - 1]);\n                    if (Browser.isDevice) {\n                        if (!isNullOrUndefined(document.getElementById(_this.element.id + '_bottomToolbar'))) {\n                            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                            var toolbar_5 = getComponent(_this.element.id + '_bottomToolbar', 'toolbar');\n                            toolbar_5.refreshOverflow();\n                        }\n                    }\n                    else {\n                        if (!isNullOrUndefined(document.getElementById(_this.element.id + '_toolbar'))) {\n                            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                            var toolbar_6 = getComponent(_this.element.id + '_toolbar', 'toolbar');\n                            toolbar_6.refreshOverflow();\n                        }\n                    }\n                }\n            });\n            // Render initialized DropDownButton.\n            drpDownBtn_1.appendTo('#' + this.element.id + '_borderWidthBtn');\n        }\n    };\n    ImageEditor.prototype.getTextToolbarItem = function (items) {\n        var toolbarItems = [];\n        if (items.indexOf('fontFamily') > -1) {\n            toolbarItems.push({ id: this.element.id + '_fontFamily', cssClass: 'top-icon e-img-font-family',\n                tooltipText: this.l10n.getConstant('FontFamily'), align: 'Center',\n                template: '<button id=\"' + this.element.id + '_fontFamilyBtn\"></button>' });\n        }\n        if (items.indexOf('fontStyle') > -1) {\n            toolbarItems.push({ id: this.element.id + '_fontStyle', cssClass: 'top-icon e-img-font-style',\n                tooltipText: this.l10n.getConstant('FontStyle'), align: 'Center',\n                template: '<button id=\"' + this.element.id + '_fontStyleBtn\"></button>' });\n        }\n        if (items.indexOf('fontSize') > -1) {\n            toolbarItems.push({ id: this.element.id + '_fontSize', cssClass: 'top-icon e-img-font-size',\n                tooltipText: this.l10n.getConstant('FontSize'), align: 'Center',\n                template: '<button id=\"' + this.element.id + '_fontSizeBtn\"></button>' });\n        }\n        if (items.indexOf('fontColor') > -1) {\n            toolbarItems.push({ cssClass: 'top-icon e-text-font-color', id: this.element.id + '_text_strokecolor',\n                tooltipText: this.l10n.getConstant('FontColor'), align: 'Center',\n                type: 'Input', template: '<button id=\"' + this.element.id + '_fontColorBtn\"></button>' });\n        }\n        var tempToolbarItems = this.processSubToolbar(items);\n        for (var i = 0, len = tempToolbarItems.length; i < len; i++) {\n            toolbarItems.push(tempToolbarItems[i]);\n        }\n        if (!Browser.isDevice) {\n            toolbarItems.push({ id: this.element.id + '_ok', prefixIcon: 'e-icons e-check', cssClass: 'top-icon e-tick',\n                tooltipText: this.l10n.getConstant('OK'), align: 'Right' });\n            toolbarItems.push({ id: this.element.id + '_cancel', prefixIcon: 'e-icons e-close', cssClass: 'top-icon e-save',\n                tooltipText: this.l10n.getConstant('Cancel'), align: 'Right' });\n        }\n        return toolbarItems;\n    };\n    ImageEditor.prototype.getFontFamilyItems = function () {\n        if (Browser.isDevice) {\n            return [{ id: 'arial', text: 'ABC' }, { id: 'calibri', text: 'ABC' }, { id: 'georgia', text: 'ABC' },\n                { id: 'roboto', text: 'ABC' }, { id: 'tahoma', text: 'ABC' }];\n        }\n        return [{ id: 'arial', text: 'Arial' }, { id: 'calibri', text: 'Calibri' }, { id: 'georgia', text: 'Georgia' },\n            { id: 'roboto', text: 'Roboto' }, { id: 'tahoma', text: 'Tahoma' }];\n    };\n    ImageEditor.prototype.getFontSizeItems = function () {\n        if (Browser.isDevice) {\n            return [{ id: 'default', text: this.l10n.getConstant('ABC') }, { id: 'bold', text: this.l10n.getConstant('ABC') },\n                { id: 'italic', text: this.l10n.getConstant('ABC') }, { id: 'bolditalic', text: this.l10n.getConstant('ABC') }];\n        }\n        return [{ id: 'default', text: this.l10n.getConstant('Default') }, { id: 'bold', text: this.l10n.getConstant('Bold') },\n            { id: 'italic', text: this.l10n.getConstant('Italic') }, { id: 'bolditalic', text: this.l10n.getConstant('BoldItalic') }];\n    };\n    ImageEditor.prototype.initTextToolbarItem = function (items) {\n        var _this = this;\n        var leftItem = this.getLeftToolbarItem();\n        var rightItem = this.getRightToolbarItem();\n        var mainItem = this.getTextToolbarItem(items);\n        var zoomItem = this.getZoomToolbarItem();\n        if (Browser.isDevice) {\n            this.defToolbarItems = mainItem;\n        }\n        else {\n            this.defToolbarItems = leftItem.concat(zoomItem, mainItem, rightItem);\n        }\n        var toolbar = new Toolbar({\n            width: '100%',\n            items: this.defToolbarItems,\n            clicked: this.defToolbarClicked.bind(this),\n            created: function () {\n                _this.createTextColor(items);\n                _this.createTextBtn(items);\n                if (!Browser.isDevice) {\n                    _this.renderSaveBtn();\n                }\n                _this.trigger('toolbarCreated', { toolbarType: 'text' });\n                if (Browser.isDevice) {\n                    if (_this.defToolbarItems.length > 0 && (!isNullOrUndefined(document.getElementById(_this.element.id + '_bottomToolbar')))) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        toolbar.refreshOverflow();\n                    }\n                }\n                else {\n                    _this.createLeftToolbarControls();\n                    if (_this.defToolbarItems.length > 0 && (!isNullOrUndefined(document.getElementById(_this.element.id + '_toolbar')))) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        toolbar.refreshOverflow();\n                    }\n                }\n            }\n        });\n        if (Browser.isDevice) {\n            toolbar.appendTo('#' + this.element.id + '_bottomToolbar');\n        }\n        else {\n            toolbar.appendTo('#' + this.element.id + '_toolbar');\n        }\n        this.enableDisableToolbarBtn();\n    };\n    ImageEditor.prototype.createTextColor = function (items) {\n        var _this = this;\n        // eslint-disable-next-line @typescript-eslint/no-this-alias\n        var proxy = this;\n        if (items.indexOf('fontColor') > -1) {\n            this.element.querySelector('.e-template.e-text-font-color').appendChild(this.createElement('input', {\n                id: this.element.id + '_text_font'\n            }));\n            var fontColor = new ColorPicker({\n                modeSwitcher: false, value: '#fff',\n                showButtons: false, mode: 'Palette', cssClass: 'e-text-fontt-color',\n                change: function (args) {\n                    _this.pushActItemIntoObj();\n                    var prevCropObj = extend({}, _this.cropObj, {}, true);\n                    var prevObj = _this.getCurrentObj();\n                    prevObj.objColl = extend([], _this.objColl, [], true);\n                    prevObj.pointColl = extend([], _this.pointColl, [], true);\n                    prevObj.afterCropActions = extend([], _this.afterCropActions, [], true);\n                    _this.objColl.pop();\n                    if (proxy.textArea.style.display === 'none') {\n                        proxy.strokeSettings.strokeColor = proxy.activeObj.strokeSettings.strokeColor = args.currentValue.hex;\n                        if (!proxy.togglePen) {\n                            _this.objColl.push(_this.activeObj);\n                            proxy.updateUndoRedoColl('shapeTransform', prevObj, prevObj.objColl, prevObj.pointColl, prevCropObj);\n                            proxy.redrawShape(proxy.objColl[proxy.objColl.length - 1]);\n                        }\n                    }\n                    else if (proxy.textArea.style.display === 'block') {\n                        proxy.textArea.style.color = args.currentValue.hex;\n                        var temp = proxy.activeObj.strokeSettings.strokeColor;\n                        proxy.activeObj.strokeSettings.strokeColor = args.currentValue.hex;\n                        _this.objColl.push(_this.activeObj);\n                        _this.updateUndoRedoColl('textAreaCustomization', prevObj, prevObj.objColl, prevObj.pointColl, prevCropObj);\n                        _this.objColl.pop();\n                        proxy.activeObj.strokeSettings.strokeColor = temp;\n                    }\n                    else if (!proxy.togglePen) {\n                        _this.objColl.push(_this.activeObj);\n                        _this.updateUndoRedoColl('shapeTransform', prevObj, prevObj.objColl, prevObj.pointColl, prevCropObj);\n                        proxy.redrawShape(proxy.objColl[proxy.objColl.length - 1]);\n                    }\n                    strokeDDB_2.element.children[0].style.backgroundColor = args.currentValue.rgba;\n                    strokeDDB_2.toggle();\n                }\n            }, '#' + this.element.id + '_text_font');\n            var strokeDDB_2 = new DropDownButton({\n                open: function (args) {\n                    if (Browser.isDevice) {\n                        args.element.parentElement.style.top = strokeDDB_2.element.getBoundingClientRect().top -\n                            args.element.parentElement.offsetHeight + 'px';\n                        args.element.parentElement.style.left = _this.element.offsetLeft + 'px';\n                    }\n                },\n                target: '.e-text-fontt-color',\n                iconCss: 'e-dropdownbtn-preview'\n            }, '#' + this.element.id + '_fontColorBtn');\n            fontColor.inline = true;\n            this.element.querySelector('.e-text-font-color.e-template .e-dropdownbtn-preview').style.background\n                = '#fff';\n        }\n    };\n    ImageEditor.prototype.pushActItemIntoObj = function () {\n        if (this.textArea.style.display === 'none') {\n            this.objColl.push(this.activeObj);\n        }\n        else {\n            var temp = extend({}, this.activeObj, {}, true);\n            this.setTextBoxStylesToActObj();\n            this.objColl.push(this.activeObj);\n            this.activeObj = temp;\n        }\n    };\n    ImageEditor.prototype.createTextBtn = function (items) {\n        var _this = this;\n        if (items.indexOf('fontFamily') > -1) {\n            var fontNameBtn = document.getElementById(this.element.id + '_fontFamilyBtn');\n            var spanElem_2 = document.createElement('span');\n            if (Browser.isDevice) {\n                spanElem_2.innerHTML = 'ABC';\n                spanElem_2.setAttribute('style', 'font-family: arial');\n            }\n            else {\n                spanElem_2.innerHTML = 'Arial';\n            }\n            spanElem_2.className = 'e-text-font-family';\n            fontNameBtn.appendChild(spanElem_2);\n            var fontFamilyBtn_1 = new DropDownButton({ items: this.getFontFamilyItems(),\n                cssClass: 'e-font-family',\n                createPopupOnClick: true,\n                beforeItemRender: function (args) {\n                    args.element.setAttribute('style', 'font-family:' + args.element.id);\n                },\n                open: function (args) {\n                    if (Browser.isDevice) {\n                        args.element.parentElement.style.top = fontFamilyBtn_1.element.getBoundingClientRect().top -\n                            args.element.parentElement.offsetHeight + 'px';\n                    }\n                    var fontFamily;\n                    if (_this.textArea.style.display === 'block') {\n                        fontFamily = _this.textArea.style.fontFamily;\n                    }\n                    else {\n                        fontFamily = _this.activeObj.textSettings.fontFamily;\n                    }\n                    args.element.querySelector('[id *= ' + '\"' + fontFamily.toLowerCase()\n                        + '\"' + ']').classList.add('e-selected-btn');\n                },\n                select: function (args) {\n                    _this.pushActItemIntoObj();\n                    var objColl = extend([], _this.objColl, [], true);\n                    var prevCropObj = extend({}, _this.cropObj, {}, true);\n                    var prevObj = _this.getCurrentObj();\n                    prevObj.objColl = extend([], _this.objColl, [], true);\n                    prevObj.pointColl = extend([], _this.pointColl, [], true);\n                    prevObj.afterCropActions = extend([], _this.afterCropActions, [], true);\n                    _this.objColl.pop();\n                    spanElem_2.textContent = args.item.text;\n                    if (Browser.isDevice) {\n                        spanElem_2.setAttribute('style', 'font-family:' + args.item.id);\n                    }\n                    if (_this.textArea.style.display === 'block') {\n                        _this.updateFontRatio(_this.activeObj, true);\n                        var temp = _this.activeObj.textSettings.fontFamily;\n                        _this.activeObj.textSettings.fontFamily = _this.toPascalCase(args.item.id);\n                        _this.redrawText();\n                        _this.objColl.push(_this.activeObj);\n                        _this.updateUndoRedoColl('textAreaCustomization', prevObj, prevObj.objColl, prevObj.pointColl, prevCropObj);\n                        _this.objColl.pop();\n                        _this.upperContext.clearRect(0, 0, _this.upperCanvas.width, _this.upperCanvas.height);\n                        var width = _this.activeObj.activePoint.width +\n                            _this.activeObj.textSettings.fontSize * 0.25;\n                        _this.textArea.style.width = width + 'px';\n                        _this.textArea.style.fontFamily = _this.toPascalCase(args.item.id);\n                        _this.activeObj.textSettings.fontFamily = temp;\n                        _this.updateFontStyles();\n                    }\n                    else {\n                        _this.updateFontRatio(_this.activeObj);\n                        _this.textSettings.fontFamily = _this.activeObj.textSettings.fontFamily = _this.toPascalCase(args.item.id);\n                        _this.redrawText();\n                        _this.objColl.push(_this.activeObj);\n                        _this.updateUndoRedoColl('shapeTransform', prevObj, objColl, extend([], _this.pointColl, [], true), prevCropObj);\n                        _this.redrawShape(_this.objColl[_this.objColl.length - 1]);\n                    }\n                }\n            });\n            fontFamilyBtn_1.appendTo('#' + this.element.id + '_fontFamilyBtn');\n        }\n        if (items.indexOf('fontStyle') > -1) {\n            var fontStyleBtnElem = document.getElementById(this.element.id + '_fontStyleBtn');\n            var span1Elem_1 = document.createElement('span');\n            if (Browser.isDevice) {\n                span1Elem_1.innerHTML = this.l10n.getConstant('ABC');\n            }\n            else {\n                span1Elem_1.innerHTML = this.l10n.getConstant('Default');\n            }\n            span1Elem_1.className = 'e-text-font-style';\n            fontStyleBtnElem.appendChild(span1Elem_1);\n            var fontStyleBtn_1 = new DropDownButton({ items: this.getFontSizeItems(),\n                cssClass: 'e-font-style',\n                createPopupOnClick: true,\n                beforeItemRender: function (args) {\n                    if (Browser.isDevice) {\n                        if (args.element.id === 'bold') {\n                            args.element.setAttribute('style', 'font-weight: bold');\n                        }\n                        else if (args.element.id === 'italic') {\n                            args.element.setAttribute('style', 'font-style: italic');\n                        }\n                        else if (args.element.id === 'bolditalic') {\n                            args.element.setAttribute('style', 'font-style: italic;font-weight: bold');\n                        }\n                    }\n                },\n                open: function (args) {\n                    var fontStyle = 'default';\n                    if (_this.textArea.style.display === 'block') {\n                        if (_this.textArea.style.fontWeight === 'bold') {\n                            fontStyle = 'bold';\n                        }\n                        if (_this.textArea.style.fontStyle === 'italic') {\n                            fontStyle = fontStyle.replace('default', '');\n                            fontStyle += 'italic';\n                        }\n                    }\n                    else {\n                        if (_this.activeObj.textSettings.bold) {\n                            fontStyle = 'bold';\n                        }\n                        if (_this.activeObj.textSettings.italic) {\n                            fontStyle = fontStyle.replace('default', '');\n                            fontStyle += 'italic';\n                        }\n                    }\n                    if (Browser.isDevice) {\n                        args.element.parentElement.style.top = fontStyleBtn_1.element.getBoundingClientRect().top -\n                            args.element.parentElement.offsetHeight + 'px';\n                    }\n                    args.element.querySelector('[id *= ' + '\"' + fontStyle + '\"' + ']').classList.add('e-selected-btn');\n                },\n                select: function (args) {\n                    if (Browser.isDevice) {\n                        if (args.item.id === 'bold') {\n                            span1Elem_1.setAttribute('style', 'font-weight: bold');\n                        }\n                        else if (args.item.id === 'italic') {\n                            span1Elem_1.setAttribute('style', 'font-style: italic');\n                        }\n                        else if (args.item.id === 'bolditalic') {\n                            span1Elem_1.setAttribute('style', 'font-style: italic;font-weight: bold');\n                        }\n                        _this.applyFontStyle(args.item.id);\n                    }\n                    else {\n                        span1Elem_1.textContent = args.item.text;\n                        _this.applyFontStyle(args.item.id);\n                    }\n                }\n            });\n            fontStyleBtn_1.appendTo('#' + this.element.id + '_fontStyleBtn');\n        }\n        if (items.indexOf('fontSize') > -1) {\n            var fontSizeBtnElem = document.getElementById(this.element.id + '_fontSizeBtn');\n            var fontSizeSpanElem_1 = document.createElement('span');\n            var fontSizes = this.getFontSizes();\n            fontSizeSpanElem_1.innerHTML = fontSizes[0].text;\n            fontSizeSpanElem_1.className = 'e-text-font-size';\n            fontSizeBtnElem.appendChild(fontSizeSpanElem_1);\n            var fontSizeBtn_1 = new DropDownButton({\n                cssClass: 'e-font-size',\n                items: fontSizes,\n                open: function (args) {\n                    if (Browser.isDevice) {\n                        args.element.parentElement.style.top = fontSizeBtn_1.element.getBoundingClientRect().top -\n                            args.element.parentElement.offsetHeight + 'px';\n                    }\n                    var activeBtn = fontSizeSpanElem_1.innerHTML;\n                    args.element.querySelector('[aria-label *= ' + '\"' + activeBtn + '\"' + ']').classList.add('e-selected-btn');\n                },\n                select: function (args) {\n                    _this.pushActItemIntoObj();\n                    var prevCropObj = extend({}, _this.cropObj, {}, true);\n                    var prevObj = _this.getCurrentObj();\n                    prevObj.objColl = extend([], _this.objColl, [], true);\n                    prevObj.pointColl = extend([], _this.pointColl, [], true);\n                    prevObj.afterCropActions = extend([], _this.afterCropActions, [], true);\n                    _this.objColl.pop();\n                    fontSizeSpanElem_1.textContent = args.item.text;\n                    if (_this.textArea.style.display === 'block') {\n                        _this.updateFontRatio(_this.activeObj, true);\n                        var temp = _this.activeObj.textSettings.fontSize;\n                        _this.activeObj.textSettings.fontSize = parseInt(_this.fontSizeColl[(parseInt(args.item.text, 10) - 1)].text, 10);\n                        _this.objColl.push(_this.activeObj);\n                        _this.updateUndoRedoColl('textAreaCustomization', prevObj, prevObj.objColl, prevObj.pointColl, prevCropObj);\n                        _this.objColl.pop();\n                        var textStyle = '';\n                        if (_this.textArea.style.fontWeight === 'bold') {\n                            textStyle = 'bold ';\n                        }\n                        if (_this.textArea.style.fontStyle === 'italic') {\n                            textStyle = 'italic ';\n                        }\n                        if (_this.textArea.style.fontWeight === 'bold' && _this.textArea.style.fontStyle === 'italic') {\n                            textStyle = 'italic bold ';\n                        }\n                        _this.upperContext.font = textStyle + _this.activeObj.textSettings.fontSize + 'px' + ' ' + _this.textArea.style.fontFamily;\n                        var rows = _this.textArea.value.split('\\n');\n                        var text = _this.getMaxText(true);\n                        var width = _this.upperContext.measureText(text).width +\n                            _this.activeObj.textSettings.fontSize * 0.5;\n                        _this.textArea.style.width = width + 'px';\n                        _this.textArea.style.height = rows.length * (_this.activeObj.textSettings.fontSize + _this.activeObj.textSettings.fontSize * 0.25) + 'px';\n                        _this.activeObj.textSettings.fontSize = temp;\n                        _this.upperContext.font = _this.activeObj.textSettings.fontSize + 'px' + ' ' + _this.activeObj.textSettings.fontFamily;\n                        _this.textArea.style.fontSize = parseInt(_this.fontSizeColl[(parseInt(args.item.text, 10) - 1)].text, 10) + 'px';\n                        if (_this.textArea.style.fontFamily === 'georgia') {\n                            _this.textArea.style.width = parseFloat(_this.textArea.style.width) + parseFloat(_this.textArea.style.fontSize) + 'px';\n                        }\n                    }\n                    else {\n                        _this.updateFontRatio(_this.activeObj);\n                        _this.textSettings.fontSize = _this.activeObj.textSettings.fontSize = parseInt(_this.fontSizeColl[(parseInt(args.item.text, 10) - 1)].text, 10);\n                        _this.upperContext.font = _this.activeObj.textSettings.fontSize + 'px' + ' ' + _this.activeObj.textSettings.fontFamily;\n                        var rows = _this.activeObj.keyHistory.split('\\n');\n                        var text = _this.getMaxText();\n                        var width = _this.upperContext.measureText(text).width +\n                            _this.activeObj.textSettings.fontSize * 0.5;\n                        var height = rows.length * (_this.activeObj.textSettings.fontSize +\n                            _this.activeObj.textSettings.fontSize * 0.25);\n                        _this.setTextSelection(width, height);\n                        _this.updateActiveObject(_this.activeObj.activePoint, _this.activeObj);\n                        _this.redrawText();\n                        _this.objColl.push(_this.activeObj);\n                        _this.updateUndoRedoColl('shapeTransform', prevObj, prevObj.objColl, prevObj.pointColl, prevCropObj);\n                        _this.redrawShape(_this.objColl[_this.objColl.length - 1]);\n                    }\n                }\n            });\n            fontSizeBtn_1.appendTo('#' + this.element.id + '_fontSizeBtn');\n        }\n    };\n    ImageEditor.prototype.getFontSizes = function () {\n        var items = [];\n        this.fontSizeColl = [];\n        var fontSize;\n        if (this.degree === 0 || this.degree % 180 === 0) {\n            fontSize = this.destWidth / 25;\n        }\n        else {\n            fontSize = this.destHeight / 25;\n        }\n        for (var i = 1; i <= 10; i++) {\n            this.fontSizeColl.push({ text: (i * (Math.round(fontSize / 2))).toString() });\n            items.push({ text: (i.toString()) });\n        }\n        return items;\n    };\n    ImageEditor.prototype.getTextAreaWidth = function (item) {\n        var tempBold = this.activeObj.textSettings.bold;\n        var tempItalic = this.activeObj.textSettings.italic;\n        switch (item) {\n            case 'default':\n                this.activeObj.textSettings.bold = false;\n                this.activeObj.textSettings.italic = false;\n                break;\n            case 'bold':\n                this.activeObj.textSettings.bold = true;\n                this.activeObj.textSettings.italic = false;\n                break;\n            case 'italic':\n                this.activeObj.textSettings.bold = false;\n                this.activeObj.textSettings.italic = true;\n                break;\n            case 'bolditalic':\n                this.activeObj.textSettings.bold = true;\n                this.activeObj.textSettings.italic = true;\n                break;\n        }\n        this.updateFontStyles();\n        var width;\n        if (this.textArea.style.display === 'none') {\n            width = this.upperContext.measureText(this.activeObj.keyHistory).width +\n                this.activeObj.textSettings.fontSize * 0.5;\n        }\n        else {\n            width = this.upperContext.measureText(this.textArea.value).width +\n                this.activeObj.textSettings.fontSize * 0.5;\n        }\n        this.activeObj.textSettings.bold = tempBold;\n        this.activeObj.textSettings.italic = tempItalic;\n        return width;\n    };\n    ImageEditor.prototype.updateUndoRedoObj = function (objColl) {\n        if (this.allowUndoRedo) {\n            this.objColl.push(this.activeObj);\n            var cropObj = extend({}, this.cropObj, {}, true);\n            var obj = this.getCurrentObj();\n            obj.objColl = extend([], this.objColl, [], true);\n            obj.pointColl = extend([], this.pointColl, [], true);\n            obj.afterCropActions = extend([], this.afterCropActions, [], true);\n            this.undoRedoColl.push({ operation: 'shapeTransform', previousObj: obj, currentObj: obj,\n                previousObjColl: objColl, currentObjColl: obj.objColl,\n                previousPointColl: obj.pointColl, currentPointColl: obj.pointColl,\n                previousCropObj: cropObj, currentCropObj: cropObj });\n            this.undoRedoStep++;\n            this.redrawShape(this.objColl[this.objColl.length - 1]);\n        }\n    };\n    ImageEditor.prototype.updateObjColl = function (item, objColl) {\n        var prevCropObj = extend({}, this.cropObj, {}, true);\n        var prevObj = this.getCurrentObj();\n        prevObj.objColl = extend([], this.objColl, [], true);\n        prevObj.pointColl = extend([], this.pointColl, [], true);\n        prevObj.afterCropActions = extend([], this.afterCropActions, [], true);\n        var tempBold = this.activeObj.textSettings.bold;\n        var tempItalic = this.activeObj.textSettings.italic;\n        switch (item) {\n            case 'default':\n                this.activeObj.textSettings.bold = false;\n                this.activeObj.textSettings.italic = false;\n                break;\n            case 'bold':\n                this.activeObj.textSettings.bold = true;\n                this.activeObj.textSettings.italic = false;\n                break;\n            case 'italic':\n                this.activeObj.textSettings.bold = false;\n                this.activeObj.textSettings.italic = true;\n                break;\n            case 'bolditalic':\n                this.activeObj.textSettings.bold = true;\n                this.activeObj.textSettings.italic = true;\n                break;\n        }\n        this.objColl.push(this.activeObj);\n        this.updateUndoRedoColl('textAreaCustomization', prevObj, prevObj.objColl, prevObj.pointColl, prevCropObj);\n        this.objColl.pop();\n        this.activeObj.textSettings.bold = tempBold;\n        this.activeObj.textSettings.italic = tempItalic;\n    };\n    ImageEditor.prototype.applyFontStyle = function (item) {\n        this.pushActItemIntoObj();\n        var objColl = extend([], this.objColl, [], true);\n        this.objColl.pop();\n        if (this.textArea.style.display === 'none') {\n            this.updateFontRatio(this.activeObj);\n        }\n        else {\n            this.updateFontRatio(this.activeObj, true);\n        }\n        switch (item) {\n            case 'default':\n                if (this.textArea.style.display === 'block') {\n                    var width = this.getTextAreaWidth(item);\n                    this.textArea.style.width = width + 'px';\n                    this.textArea.style.fontWeight = 'normal';\n                    this.textArea.style.fontStyle = 'normal';\n                    this.updateObjColl(item, objColl);\n                }\n                else {\n                    this.textSettings.bold = this.activeObj.textSettings.bold = false;\n                    this.textSettings.italic = this.activeObj.textSettings.italic = false;\n                    this.redrawText();\n                    this.updateUndoRedoObj(objColl);\n                }\n                break;\n            case 'bold':\n                if (this.textArea.style.display === 'block') {\n                    var width = this.getTextAreaWidth(item);\n                    this.textArea.style.width = width + 'px';\n                    this.textArea.style.fontWeight = 'bold';\n                    this.textArea.style.fontStyle = 'normal';\n                    this.updateObjColl(item, objColl);\n                }\n                else {\n                    this.textSettings.bold = this.activeObj.textSettings.bold = true;\n                    this.textSettings.italic = this.activeObj.textSettings.italic = false;\n                    this.redrawText();\n                    this.updateUndoRedoObj(objColl);\n                }\n                break;\n            case 'italic':\n                if (this.textArea.style.display === 'block') {\n                    var width = this.getTextAreaWidth(item);\n                    this.textArea.style.width = width + 'px';\n                    this.textArea.style.fontWeight = 'normal';\n                    this.textArea.style.fontStyle = 'italic';\n                    this.updateObjColl(item, objColl);\n                }\n                else {\n                    this.textSettings.bold = this.activeObj.textSettings.bold = false;\n                    this.textSettings.italic = this.activeObj.textSettings.italic = true;\n                    this.redrawText();\n                    this.updateUndoRedoObj(objColl);\n                }\n                break;\n            case 'bolditalic':\n                if (this.textArea.style.display === 'block') {\n                    var width = this.getTextAreaWidth(item);\n                    this.textArea.style.width = width + 'px';\n                    this.textArea.style.fontWeight = 'bold';\n                    this.textArea.style.fontStyle = 'italic';\n                    this.updateObjColl(item, objColl);\n                }\n                else {\n                    this.textSettings.bold = this.activeObj.textSettings.bold = true;\n                    this.textSettings.italic = this.activeObj.textSettings.italic = true;\n                    this.redrawText();\n                    this.updateUndoRedoObj(objColl);\n                }\n                break;\n        }\n    };\n    ImageEditor.prototype.initZoomToolbarItem = function () {\n        var _this = this;\n        var leftItem = this.getLeftToolbarItem();\n        var rightItem = this.getRightToolbarItem();\n        var zoomItem = this.getZoomToolbarItem();\n        this.defToolbarItems = leftItem.concat(zoomItem, rightItem);\n        new Toolbar({\n            width: '100%',\n            items: this.defToolbarItems,\n            clicked: this.defToolbarClicked.bind(this),\n            created: function () {\n                _this.renderSaveBtn();\n                _this.trigger('toolbarCreated', { toolbarType: 'zoom' });\n            }\n        }, '#' + this.element.id + '_toolbar');\n        this.createLeftToolbarControls();\n        this.enableDisableToolbarBtn();\n        if (this.defToolbarItems.length > 0 && (!isNullOrUndefined(document.getElementById(this.element.id + '_toolbar')))) {\n            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n            var toolbar_7 = getComponent(this.element.id + '_toolbar', 'toolbar');\n            toolbar_7.refreshOverflow();\n        }\n    };\n    ImageEditor.prototype.refreshUndoRedoColl = function () {\n        this.undoRedoColl = this.undoRedoColl.slice(0, this.undoRedoStep);\n        this.isUndoRedo = this.currObjType.isUndoAction = false;\n        this.enableDisableToolbarBtn();\n    };\n    ImageEditor.prototype.applyPreviewFilter = function () {\n        if (!isNullOrUndefined(document.querySelector('#' + this.element.id + '_sliderWrapper')) ||\n            this.currObjType.isFiltered) {\n            this.initialAdjustmentValue = this.canvasFilter = this.lowerContext.filter;\n            this.currObjType.isFiltered = false;\n        }\n    };\n    ImageEditor.prototype.contextualToolbarClicked = function (args) {\n        var selEle = this.element.querySelector('.e-contextual-toolbar-wrapper .e-toolbar-item.e-selected');\n        if (selEle) {\n            selEle.classList.remove('e-selected');\n        }\n        document.getElementById(args.item.id + 'Canvas').parentElement.parentElement.classList.add('e-selected');\n        this.currObjType.isFiltered = true;\n        var type = args.item.id.replace(this.element.id, '').split('_')[1];\n        var imageFiltering = { filter: this.toPascalCase(type) };\n        this.trigger('imageFiltering', imageFiltering);\n        this.setFilter(type.toLowerCase());\n        this.currentFilter = args.item.id;\n        this.enableDisableToolbarBtn();\n    };\n    ImageEditor.prototype.defToolbarClicked = function (args) {\n        var isContextualToolbar = false;\n        if (this.element.querySelector('.e-contextual-toolbar-wrapper')) {\n            if (!this.element.querySelector('.e-contextual-toolbar-wrapper').classList.contains('e-hide')) {\n                isContextualToolbar = true;\n            }\n            this.element.querySelector('.e-contextual-toolbar-wrapper').classList.add('e-hide');\n        }\n        var zoomIn;\n        var type = args.item.id.replace(this.element.id + '_', '').toLowerCase();\n        var imageEditorObj = getInstance(document.getElementById(this.element.id), ImageEditor_1);\n        var isCropSelection = false;\n        var panBtn;\n        var splitWords;\n        if (this.activeObj.shape !== undefined) {\n            splitWords = this.activeObj.shape.split('-');\n        }\n        if (splitWords === undefined && this.currObjType.isCustomCrop) {\n            isCropSelection = true;\n        }\n        else if (splitWords !== undefined && splitWords[0] === 'crop') {\n            isCropSelection = true;\n        }\n        var isDisabledZoomOut = false;\n        var isDisabledFilter = false;\n        var isDisabledAdjustment = false;\n        var zoomOut = document.querySelector('#' + this.element.id + '_zoomOut');\n        if (!isNullOrUndefined(zoomOut) && zoomOut.classList.contains('e-disabled')) {\n            isDisabledZoomOut = true;\n        }\n        var adjustment = document.querySelector('#' + this.element.id + '_adjustment');\n        if (!isNullOrUndefined(adjustment) && adjustment.classList.contains('e-disabled')) {\n            isDisabledAdjustment = true;\n        }\n        var filter = document.querySelector('#' + this.element.id + '_filter');\n        if (!isNullOrUndefined(filter) && filter.classList.contains('e-disabled')) {\n            isDisabledFilter = true;\n        }\n        this.enableDisableToolbarBtn();\n        if (!this.disabled) {\n            switch (type) {\n                case 'zoomin':\n                    if (this.isFreehandDrawEditing) {\n                        this.applyFreehandDraw();\n                    }\n                    this.applyPreviewFilter();\n                    this.currObjType.isFiltered = false;\n                    if (this.currObjType.isUndoAction) {\n                        this.refreshUndoRedoColl();\n                    }\n                    if (this.togglePen) {\n                        this.currObjType.isZoomed = true;\n                        this.freeHandDraw(false);\n                    }\n                    this.currentSelectionPoint = null;\n                    imageEditorObj.zoom(.1);\n                    break;\n                case 'zoomout':\n                    if (!isDisabledZoomOut) {\n                        if (this.isFreehandDrawEditing) {\n                            this.applyFreehandDraw();\n                        }\n                        this.applyPreviewFilter();\n                        this.currObjType.isFiltered = false;\n                        if (this.currObjType.isUndoAction) {\n                            this.refreshUndoRedoColl();\n                        }\n                        if (this.togglePen) {\n                            this.currObjType.isZoomed = true;\n                            this.freeHandDraw(false);\n                        }\n                        this.currentSelectionPoint = null;\n                        imageEditorObj.zoom(-.1);\n                    }\n                    break;\n                case 'pan':\n                    this.currObjType.isCustomCrop = this.currObjType.isFiltered = false;\n                    if (this.currObjType.isUndoAction) {\n                        this.refreshUndoRedoColl();\n                    }\n                    if (isCropSelection) {\n                        this.currObjType.isCustomCrop = false;\n                        this.refreshActiveObj();\n                        this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n                        this.refreshToolbar('main');\n                    }\n                    if (this.togglePan) {\n                        this.cancelPan();\n                        this.disablePan = true;\n                        if (this.currentToolbar === 'pen') {\n                            this.freeHandDraw(true);\n                        }\n                    }\n                    else {\n                        panBtn = this.element.querySelector('.e-img-pan .e-btn');\n                        if (!isNullOrUndefined(panBtn)) {\n                            panBtn.classList.add('e-selected-btn');\n                        }\n                        imageEditorObj.pan(true);\n                        this.disablePan = false;\n                    }\n                    zoomIn = document.querySelector('#' + this.element.id + '_zoomIn');\n                    if (!isNullOrUndefined(zoomIn) && this.zoomFactor >= 2) {\n                        zoomIn.classList.add('e-disabled');\n                        zoomIn.parentElement.classList.add('e-overlay');\n                    }\n                    else if (!isNullOrUndefined(zoomIn)) {\n                        zoomIn.classList.remove('e-disabled');\n                        zoomIn.parentElement.classList.remove('e-overlay');\n                    }\n                    this.refreshToolbar('main');\n                    break;\n                case 'cancel':\n                    this.performCancel(isContextualToolbar);\n                    break;\n                case 'ok':\n                    this.okBtn();\n                    this.refreshDropDownBtn(false);\n                    this.currentToolbar = 'main';\n                    break;\n                case 'crop':\n                    if (!isNullOrUndefined(this.currSelectionPoint)) {\n                        if (this.currObjType.isUndoAction) {\n                            this.refreshUndoRedoColl();\n                        }\n                        if (!isNullOrUndefined(this.cropObj.activeObj.shape)) {\n                            this.select(this.cropObj.activeObj.shape);\n                        }\n                        this.refreshToolbar('main', true, true);\n                        getComponent(this.element.querySelector('#' + this.element.id + '_cropBtn'), 'dropdown-btn').toggle();\n                        if (!isNullOrUndefined(this.activeObj.shape)) {\n                            document.getElementById(this.activeObj.shape.split('-')[1]).classList.add('e-selected');\n                        }\n                    }\n                    break;\n                case 'reset':\n                    imageEditorObj.reset();\n                    this.currentToolbar = 'main';\n                    break;\n                // case 'undo':\n                //     this.callUndo();\n                //     break;\n                // case 'redo':\n                //     this.callRedo();\n                //     break;\n                case 'adjustment':\n                    if (!isDisabledAdjustment) {\n                        this.refreshToolbar('adjustment');\n                        this.setTempFilterProperties();\n                        this.openSlider('brightness');\n                    }\n                    break;\n                case 'brightness':\n                case 'contrast':\n                case 'hue':\n                case 'saturation':\n                case 'opacity':\n                case 'blur':\n                case 'exposure':\n                    this.openSlider(type);\n                    break;\n                case 'filter':\n                    if (!isDisabledFilter) {\n                        this.refreshToolbar('filter');\n                        this.setTempFilterProperties();\n                    }\n                    break;\n                case 'default':\n                case 'chrome':\n                case 'cold':\n                case 'warm':\n                case 'grayscale':\n                case 'blackandwhite':\n                case 'sepia':\n                case 'invert':\n                case 'sharpen':\n                    if (this.currObjType.isUndoAction) {\n                        this.refreshUndoRedoColl();\n                    }\n                    this.currObjType.isFiltered = true;\n                    this.setFilter(type);\n                    break;\n            }\n        }\n        this.trigger('toolbarItemClicked', args);\n    };\n    ImageEditor.prototype.performCancel = function (isContextualToolbar) {\n        isContextualToolbar = isContextualToolbar ? isContextualToolbar : false;\n        if (this.isFreehandDrawEditing) {\n            this.cancelFreehandDraw();\n        }\n        else if (this.textArea.style.display === 'block') {\n            this.textArea.style.display = 'none';\n            this.textArea.value = '';\n            this.textArea.style.transform = '';\n            this.activeObj.strokeSettings = this.tempStrokeSettings;\n            this.activeObj.textSettings = this.tempTextSettings;\n        }\n        else if (!isNullOrUndefined(document.querySelector('#' + this.element.id + '_sliderWrapper')) ||\n            this.currObjType.isFiltered) {\n            this.lowerContext.filter = this.adjustmentValue = this.initialAdjustmentValue = this.tempAdjustmentValue;\n            if (this.lowerContext.filter.split(' ').length > 1 &&\n                this.lowerContext.filter.split(' ')[0].split('(')[1].split(')')[0] === '1') {\n                this.isBrightnessAdjusted = false;\n            }\n            this.currentFilter = this.tempFilter;\n            this.lowerContext.clearRect(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n            this.redrawImgWithObj();\n            this.currObjType.isFiltered = false;\n            this.adjustmentLevel = extend({}, this.tempAdjustmentLevel, {}, true);\n            this.element.querySelector('.e-contextual-toolbar-wrapper').classList.add('e-hide');\n            this.undoRedoStep = this.tempUndoRedoStep;\n            this.upperCanvas.style.cursor = 'default';\n            this.currObjType.isCustomCrop = false;\n            this.tempStrokeSettings = { strokeColor: '#fff', fillColor: '', strokeWidth: null };\n            this.callMainToolbar();\n        }\n        else {\n            if (isContextualToolbar) {\n                this.callMainToolbar();\n            }\n            else {\n                this.cancelItems();\n                this.togglePan = this.dragCanvas = false;\n            }\n        }\n        this.enableDisableToolbarBtn();\n        this.refreshDropDownBtn(false);\n        this.currentToolbar = 'main';\n    };\n    ImageEditor.prototype.applyShape = function () {\n        if (!isNullOrUndefined(this.activeObj.shape) && (this.activeObj.shape === 'rectangle' ||\n            this.activeObj.shape === 'ellipse' || this.activeObj.shape === 'line' ||\n            this.activeObj.shape === 'text')) {\n            this.redrawActObj();\n            this.refreshActiveObj();\n            this.currentToolbar = 'main';\n            this.refreshToolbar('main');\n        }\n    };\n    ImageEditor.prototype.applyFreehandDraw = function () {\n        if (this.pointColl[this.freehandDrawSelectedIndex].strokeColor === '#42a5f5') {\n            this.pointColl[this.freehandDrawSelectedIndex].strokeColor = this.tempFreeHandDrawEditingStyles.strokeColor;\n        }\n        this.selectedFreehandColor = '#42a5f5';\n        this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n        this.lowerContext.clearRect(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n        this.renderImage();\n        this.refreshToolbar('main');\n        if (!isNullOrUndefined(this.pointColl[this.freehandDrawSelectedIndex])) {\n            this.pointColl[this.freehandDrawSelectedIndex].isSelected = false;\n        }\n        this.isFreehandDrawEditing = this.isFreehandDrawingPoint = false;\n        this.freehandDrawHoveredIndex = this.freehandDrawSelectedIndex = null;\n    };\n    ImageEditor.prototype.cancelFreehandDraw = function () {\n        this.selectedFreehandColor = '#42a5f5';\n        this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n        for (var n = 0; n < this.freehandCounter; n++) {\n            this.pointColl[n].strokeColor = this.tempFreeHandDrawEditingStyles.strokeColor;\n            this.pointColl[n].strokeWidth = this.tempFreeHandDrawEditingStyles.strokeWidth;\n        }\n        this.pointCounter = 0;\n        if (!isNullOrUndefined(this.pointColl[this.freehandDrawSelectedIndex])) {\n            this.pointColl[this.freehandDrawSelectedIndex].isSelected = false;\n        }\n        this.freehandDrawHoveredIndex = this.freehandDrawSelectedIndex = this.freehandDrawSelectedId = null;\n        this.isFreehandDrawEditing = this.isFreehandDrawingPoint = false;\n        this.tempFreeHandDrawEditingStyles = { strokeColor: null, strokeWidth: null, fillColor: null };\n        this.refreshToolbar('main');\n    };\n    ImageEditor.prototype.openSlider = function (type) {\n        this.unselectBtn();\n        this.currObjType.isFiltered = true;\n        this.refreshToolbar('color', null, null, null, type);\n        document.getElementById(this.element.id + '_' + type).classList.add('e-selected-btn');\n    };\n    ImageEditor.prototype.setTempFilterProperties = function () {\n        this.upperCanvas.style.display = 'block';\n        this.cropSelectedState();\n        this.lowerContext.filter = this.initialAdjustmentValue;\n        this.tempAdjustmentValue = this.lowerContext.filter;\n        this.tempAdjustmentLevel = extend({}, this.adjustmentLevel, {}, true);\n        this.tempFilter = this.currentFilter;\n        this.tempUndoRedoColl = extend([], this.undoRedoColl, [], true);\n        this.tempUndoRedoStep = this.undoRedoStep;\n    };\n    ImageEditor.prototype.okBtn = function () {\n        var isCropSelection = false;\n        var splitWords;\n        if (this.activeObj.shape !== undefined) {\n            splitWords = this.activeObj.shape.split('-');\n        }\n        if (splitWords === undefined && this.currObjType.isCustomCrop) {\n            isCropSelection = true;\n        }\n        else if (splitWords !== undefined && splitWords[0] === 'crop') {\n            isCropSelection = true;\n        }\n        var selElem = this.element.querySelector('.e-contextual-toolbar-wrapper .e-toolbar-item.e-selected');\n        if (selElem) {\n            this.currentFilter = selElem.children[0].children[0].id.replace('Canvas', '');\n        }\n        if (isCropSelection) {\n            this.crop();\n        }\n        else if (this.togglePen) {\n            this.freeHandDraw(false);\n        }\n        else if (this.textArea.style.display === 'block') {\n            this.redrawActObj();\n        }\n        else if (!isNullOrUndefined(document.querySelector('#' + this.element.id + '_sliderWrapper')) ||\n            this.currObjType.isFiltered) {\n            this.initialAdjustmentValue = this.canvasFilter = this.lowerContext.filter;\n            this.currObjType.isFiltered = false;\n        }\n        else if (this.isFreehandDrawEditing) {\n            this.applyFreehandDraw();\n        }\n        else {\n            this.applyActObj();\n        }\n        this.callMainToolbar(false);\n        this.isCropTab = false;\n        this.zoomFactor = this.defaultZoomFactor;\n    };\n    ImageEditor.prototype.updateBrightnessFilter = function () {\n        var splitWords = this.lowerContext.filter.split(' ');\n        if (this.isBrightnessAdjusted && splitWords.length > 0 && !isNullOrUndefined(splitWords[4])) {\n            var opacityValue = parseFloat(splitWords[4].split('(')[1]);\n            splitWords[4] = 'opacity(' + (opacityValue - 0.3) + ')';\n            this.lowerContext.filter = splitWords.join(' ');\n        }\n    };\n    ImageEditor.prototype.isFreehandDrawIndex = function (index) {\n        var isIndex = false;\n        for (var i = 0; i < this.freehandCounter; i++) {\n            if (parseInt(this.pointColl[i].id.split('_')[1], 10) - 1 === index) {\n                isIndex = true;\n                break;\n            }\n        }\n        return isIndex;\n    };\n    ImageEditor.prototype.deleteFreehandDraw = function (index, isId) {\n        if (this.isFreehandDrawIndex(index)) {\n            this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n            // eslint-disable-next-line\n            var tempPointColl = extend({}, this.pointColl, {}, true);\n            this.pointColl = {};\n            var count = 0;\n            if (isNullOrUndefined(isId)) {\n                for (var i = 0; i < this.freehandCounter; i++) {\n                    if (i !== index) {\n                        this.pointColl[count] = tempPointColl[i];\n                        count++;\n                    }\n                }\n            }\n            else {\n                for (var i = 0; i < this.freehandCounter; i++) {\n                    if (parseInt(tempPointColl[i].id.split('_')[1], 10) - 1 !== index) {\n                        this.pointColl[count] = tempPointColl[i];\n                        count++;\n                    }\n                }\n            }\n            this.freehandCounter -= 1;\n            this.freehandDrawHoveredIndex = this.freehandDrawSelectedIndex = null;\n            this.isFreehandDrawEditing = this.isFreehandDrawingPoint = false;\n            this.renderImage();\n            this.refreshToolbar('main');\n        }\n    };\n    ImageEditor.prototype.unselectBtn = function () {\n        if (document.querySelector('#' + this.element.id + '_brightness').classList.contains('e-selected-btn')) {\n            document.querySelector('#' + this.element.id + '_brightness').classList.remove('e-selected-btn');\n        }\n        else if (document.querySelector('#' + this.element.id + '_contrast').classList.contains('e-selected-btn')) {\n            document.querySelector('#' + this.element.id + '_contrast').classList.remove('e-selected-btn');\n        }\n        else if (document.querySelector('#' + this.element.id + '_hue').classList.contains('e-selected-btn')) {\n            document.querySelector('#' + this.element.id + '_hue').classList.remove('e-selected-btn');\n        }\n        else if (document.querySelector('#' + this.element.id + '_saturation').classList.contains('e-selected-btn')) {\n            document.querySelector('#' + this.element.id + '_saturation').classList.remove('e-selected-btn');\n        }\n        else if (document.querySelector('#' + this.element.id + '_opacity').classList.contains('e-selected-btn')) {\n            document.querySelector('#' + this.element.id + '_opacity').classList.remove('e-selected-btn');\n        }\n        else if (document.querySelector('#' + this.element.id + '_blur').classList.contains('e-selected-btn')) {\n            document.querySelector('#' + this.element.id + '_blur').classList.remove('e-selected-btn');\n        }\n        else if (document.querySelector('#' + this.element.id + '_exposure').classList.contains('e-selected-btn')) {\n            document.querySelector('#' + this.element.id + '_exposure').classList.remove('e-selected-btn');\n        }\n    };\n    ImageEditor.prototype.callUndo = function () {\n        this.currObjType.isFiltered = false;\n        if (!this.togglePan) {\n            this.callMainToolbar(false, false);\n        }\n        if (this.zoomFactor === 0) {\n            this.dragCanvas = this.togglePan = false;\n            this.callMainToolbar(false, false);\n        }\n        if (this.element.querySelector('.e-contextual-toolbar-wrapper')) {\n            this.element.querySelector('.e-contextual-toolbar-wrapper').classList.add('e-hide');\n        }\n        if (this.togglePen) {\n            this.togglePen = false;\n            this.upperCanvas.style.cursor = 'default';\n            this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n        }\n        this.undo();\n    };\n    ImageEditor.prototype.callRedo = function () {\n        this.currObjType.isFiltered = false;\n        if (!this.togglePan) {\n            this.callMainToolbar(false, false);\n        }\n        if (this.zoomFactor === 0) {\n            this.dragCanvas = this.togglePan = false;\n            this.callMainToolbar(false, false);\n        }\n        this.redo();\n    };\n    ImageEditor.prototype.refreshSlider = function () {\n        var sliderWrapper = document.querySelector('#' + this.element.id + '_sliderWrapper');\n        // eslint-disable-next-line\n        var slider = document.querySelector('.e-slider');\n        var hdrWrapper = document.querySelector('#' + this.element.id + '_headWrapper');\n        if (hdrWrapper) {\n            hdrWrapper.style.display = 'none';\n        }\n        if (!isNullOrUndefined(sliderWrapper) && !isNullOrUndefined(slider)) {\n            slider.ej2_instances[0].destroy();\n            sliderWrapper.remove();\n        }\n    };\n    ImageEditor.prototype.iterateObjColl = function () {\n        for (var i = 0; i < this.objColl.length; i++) {\n            this.apply(this.objColl[i].shape, this.objColl[i]);\n            this.refreshActiveObj();\n        }\n    };\n    ImageEditor.prototype.updateAdjustment = function (type, value, isPreview) {\n        this.lowerContext.clearRect(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n        var splitWords = this.lowerContext.filter.split(' ');\n        var values = [];\n        var opacityValue;\n        var brightnessValue;\n        if (splitWords[4] !== undefined) {\n            opacityValue = parseFloat(splitWords[4].split('(')[1]);\n        }\n        if (splitWords[0] !== undefined) {\n            brightnessValue = parseFloat(splitWords[0].split('(')[1]);\n        }\n        var brightness = this.getFilterValue(this.adjustmentLevel.brightness);\n        var saturation = this.getFilterValue(this.adjustmentLevel.saturation);\n        if (type !== 'brightness' && type !== 'contrast' && type !== 'hue' && type !== 'saturation' && type !== 'exposure'\n            && type !== 'opacity' && type !== 'blur') {\n            if (isNullOrUndefined(isPreview) && (this.adjustmentLevel.sharpen || this.adjustmentLevel.bw)) {\n                this.isUndoRedo = true;\n                var temp_1 = this.lowerContext.filter;\n                this.lowerContext.filter = 'none';\n                this.iterateObjColl();\n                this.freehandRedraw(this.lowerContext);\n                this.lowerContext.filter = temp_1;\n                this.isUndoRedo = false;\n            }\n        }\n        if (brightness !== 1) {\n            splitWords[4] = 'opacity(' + (opacityValue - 0.3) + ')';\n        }\n        var saturate;\n        var bright;\n        var saturatePercent;\n        var contrast;\n        var tempFilter;\n        var temp;\n        var saturatePercentage;\n        switch (type) {\n            case 'brightness':\n                if (parseFloat(splitWords[3].split('(')[1]) !== 100) {\n                    value += 0.1;\n                }\n                splitWords[0] = 'brightness(' + value + ')';\n                this.adjustmentValue = splitWords.join(' ');\n                break;\n            case 'contrast':\n                splitWords[1] = 'contrast(' + value + '%)';\n                this.adjustmentValue = splitWords.join(' ');\n                break;\n            case 'hue':\n                splitWords[2] = 'hue-rotate(' + value + 'deg)';\n                this.adjustmentValue = splitWords.join(' ');\n                break;\n            case 'saturation':\n                splitWords[3] = 'saturate(' + value + '%)';\n                if (saturation !== 1) {\n                    splitWords[0] = 'brightness(' + (brightnessValue + 0.1) + ')';\n                }\n                this.adjustmentValue = splitWords.join(' ');\n                break;\n            case 'opacity':\n                if (parseFloat(splitWords[0].split('(')[1]) !== 1) {\n                    value -= 0.2;\n                }\n                splitWords[4] = 'opacity(' + value + ')';\n                this.adjustmentValue = splitWords.join(' ');\n                break;\n            case 'blur':\n                splitWords[5] = 'blur(' + value + 'px)';\n                this.adjustmentValue = splitWords.join(' ');\n                break;\n            case 'exposure':\n                if (brightness !== 1) {\n                    splitWords[4] = 'opacity(' + (opacityValue - 0.3) + ')';\n                }\n                if (value > 1) {\n                    value -= 1;\n                    value += brightness;\n                }\n                else if (value < 1) {\n                    value = 1 - value;\n                    value = brightness - value;\n                }\n                splitWords[0] = 'brightness(' + value + ')';\n                this.adjustmentValue = splitWords.join(' ');\n                break;\n            case 'chrome':\n                saturate = this.getSaturationFilterValue(this.adjustmentLevel.saturation);\n                saturate *= 100;\n                value = saturate + (saturate * 0.4);\n                splitWords[3] = 'saturate(' + value + '%)';\n                values = this.adjustmentValue.split(' ');\n                splitWords[0] = values[0];\n                splitWords[1] = values[1];\n                splitWords[2] = values[2];\n                splitWords[4] = values[4];\n                splitWords[5] = values[5];\n                splitWords[6] = 'sepia(0%)';\n                splitWords[7] = 'grayscale(0%)';\n                splitWords[8] = 'invert(0%)';\n                break;\n            case 'cold':\n                // Adjusting Brightness\n                bright = this.getFilterValue(this.adjustmentLevel.brightness);\n                bright *= 100;\n                value = bright * 0.9;\n                splitWords[0] = 'brightness(' + value + '%)';\n                // Adjusting Contrast\n                contrast = this.getFilterValue(this.adjustmentLevel.contrast);\n                contrast *= 100;\n                value = contrast + (contrast * 0.5);\n                splitWords[1] = 'contrast(' + value + '%)';\n                // Adjusting Saturation\n                saturatePercentage = this.getSaturationFilterValue(this.adjustmentLevel.saturation);\n                saturatePercentage *= 100;\n                value = saturatePercentage;\n                splitWords[3] = 'saturate(' + value + '%)';\n                values = this.adjustmentValue.split(' ');\n                splitWords[2] = values[2];\n                splitWords[4] = values[4];\n                splitWords[5] = values[5];\n                splitWords[6] = 'sepia(0%)';\n                splitWords[7] = 'grayscale(0%)';\n                splitWords[8] = 'invert(0%)';\n                break;\n            case 'warm':\n                saturatePercent = this.getSaturationFilterValue(this.adjustmentLevel.saturation);\n                saturatePercent *= 100;\n                value = saturatePercent + (saturatePercent * 0.4);\n                splitWords[3] = 'saturate(' + value + '%)';\n                splitWords[6] = 'sepia(25%)';\n                values = this.adjustmentValue.split(' ');\n                splitWords[0] = values[0];\n                splitWords[1] = values[1];\n                splitWords[2] = values[2];\n                splitWords[4] = values[4];\n                splitWords[5] = values[5];\n                splitWords[7] = 'grayscale(0%)';\n                splitWords[8] = 'invert(0%)';\n                break;\n            case 'grayscale':\n                splitWords[7] = 'grayscale(100%)';\n                values = this.adjustmentValue.split(' ');\n                splitWords[0] = values[0];\n                splitWords[1] = values[1];\n                splitWords[2] = values[2];\n                splitWords[3] = values[3];\n                splitWords[4] = values[4];\n                splitWords[5] = values[5];\n                splitWords[6] = 'sepia(0%)';\n                splitWords[8] = 'invert(0%)';\n                break;\n            case 'sepia':\n                splitWords[6] = 'sepia(100%)';\n                values = this.adjustmentValue.split(' ');\n                splitWords[0] = values[0];\n                splitWords[1] = values[1];\n                splitWords[2] = values[2];\n                splitWords[3] = values[3];\n                splitWords[4] = values[4];\n                splitWords[5] = values[5];\n                splitWords[7] = 'grayscale(0%)';\n                splitWords[8] = 'invert(0%)';\n                break;\n            case 'invert':\n                splitWords[8] = 'invert(100%)';\n                values = this.adjustmentValue.split(' ');\n                splitWords[0] = values[0];\n                splitWords[1] = values[1];\n                splitWords[2] = values[2];\n                splitWords[3] = values[3];\n                splitWords[4] = values[4];\n                splitWords[5] = values[5];\n                splitWords[6] = 'sepia(0%)';\n                splitWords[7] = 'grayscale(0%)';\n                break;\n        }\n        if (type !== 'sharpen' && type !== 'blackandwhite') {\n            if (isNullOrUndefined(isPreview)) {\n                if (type === 'default') {\n                    splitWords = this.getDefaultCurrentFilter(splitWords);\n                }\n                this.lowerContext.filter = splitWords.join(' ');\n            }\n            splitWords = this.setTempFilterValue(brightness, isPreview, splitWords, type);\n            this.isRotateZoom = true;\n            this.updateCurrentTransformedState('initial');\n            this.lowerContext.drawImage(this.baseImg, this.srcLeft, this.srcTop, this.srcWidth, this.srcHeight, this.destLeft, this.destTop, this.destWidth, this.destHeight);\n            this.updateCurrentTransformedState('reverse');\n            this.isRotateZoom = false;\n            if (brightness !== 1) {\n                splitWords[4] = 'opacity(' + opacityValue + ')';\n            }\n            else if (saturation !== 1) {\n                splitWords[0] = 'brightness(' + brightnessValue + ')';\n            }\n            if (type === 'exposure' && brightness !== 1) {\n                splitWords[0] = 'brightness(' + brightnessValue + ')';\n            }\n            if (type === 'saturation' && saturation !== 1) {\n                splitWords[0] = 'brightness(' + brightnessValue + ')';\n            }\n            splitWords = this.setTempFilterValue(brightness, isPreview, splitWords, type);\n            if (isNullOrUndefined(isPreview)) {\n                this.lowerContext.filter = this.initialAdjustmentValue = splitWords.join(' ');\n            }\n            var tempFilter_1 = this.lowerContext.filter;\n            this.lowerContext.filter = this.getDefaultFilter();\n            this.iterateObjColl();\n            this.freehandRedraw(this.lowerContext);\n            this.lowerContext.filter = tempFilter_1;\n            if ((!isNullOrUndefined(this.currSelectionPoint) && this.currSelectionPoint.shape === 'crop-circle') || this.isCircleCrop) {\n                this.cropCircle(this.lowerContext);\n            }\n            if (brightness === 1) {\n                this.isBrightnessAdjusted = false;\n            }\n            else {\n                this.isBrightnessAdjusted = true;\n            }\n        }\n        var filter = splitWords.join(' ');\n        return filter;\n    };\n    ImageEditor.prototype.autoEnablePan = function () {\n        if (this.zoomFactor === 0) {\n            this.dragCanvas = this.togglePan = false;\n            this.callMainToolbar(false, true);\n            this.pan(false);\n            this.disablePan = false;\n        }\n        else if (!this.disablePan) {\n            this.pan(true);\n        }\n        else if (this.disablePan) {\n            this.pan(false);\n        }\n    };\n    ImageEditor.prototype.setTempFilterValue = function (brightness, isPreview, splitWords, type) {\n        if (isPreview && brightness !== 1) {\n            var tempSplitWords = this.lowerContext.filter.split(' ');\n            tempSplitWords[4] = splitWords[4];\n            this.lowerContext.filter = tempSplitWords.join(' ');\n        }\n        else if (isPreview && type === 'default') {\n            splitWords = this.getDefaultCurrentFilter(splitWords);\n        }\n        return splitWords;\n    };\n    ImageEditor.prototype.getDefaultCurrentFilter = function (splitWords) {\n        var values = this.adjustmentValue.split(' ');\n        splitWords[0] = values[0];\n        splitWords[1] = values[1];\n        splitWords[2] = values[2];\n        splitWords[3] = values[3];\n        splitWords[4] = values[4];\n        splitWords[5] = values[5];\n        splitWords[6] = 'sepia(0%)';\n        splitWords[7] = 'grayscale(0%)';\n        splitWords[8] = 'invert(0%)';\n        return splitWords;\n    };\n    ImageEditor.prototype.renderSlider = function (type) {\n        var canvasWrapper = document.querySelector('#' + this.element.id + '_contextualToolbarArea');\n        var hdrWrapper = document.querySelector('#' + this.element.id + '_headWrapper');\n        var labelWrapper = document.querySelector('#' + this.element.id + '_labelWrapper');\n        if (!hdrWrapper) {\n            hdrWrapper = canvasWrapper.appendChild(this.createElement('div', {\n                id: this.element.id + '_headWrapper',\n                styles: 'position: relative'\n            }));\n            labelWrapper = hdrWrapper.appendChild(this.createElement('label', {\n                id: this.element.id + '_labelWrapper',\n                styles: Browser.isDevice ? 'position: absolute; top: 25%; left: calc(50% - 150px); font-size: 15px; text-transform: capitalize; font-weight: 400;'\n                    : 'position: absolute; top: 25%; left: calc(50% - 226px); font-size: 15px; text-transform: capitalize; font-weight: 400;'\n            }));\n        }\n        else {\n            hdrWrapper.style.display = 'block';\n        }\n        labelWrapper.textContent = this.l10n.getConstant(this.toPascalCase(type));\n        var sliderWrapper = hdrWrapper.appendChild(this.createElement('div', {\n            id: this.element.id + '_sliderWrapper',\n            styles: 'position: absolute'\n        }));\n        var value = this.getCurrAdjustmentValue(type);\n        var min;\n        var max;\n        var slider;\n        if (type === 'brightness' || type === 'contrast' || type === 'saturation' || type === 'exposure') {\n            if (this.finetuneSettings) {\n                if (type === 'brightness' && this.finetuneSettings.brightness) {\n                    min = this.finetuneSettings.brightness.min;\n                    max = this.finetuneSettings.brightness.max;\n                }\n                else if (type === 'contrast' && this.finetuneSettings.contrast) {\n                    min = this.finetuneSettings.contrast.min;\n                    max = this.finetuneSettings.contrast.max;\n                }\n                else if (type === 'saturation' && this.finetuneSettings.saturation) {\n                    min = this.finetuneSettings.saturation.min;\n                    max = this.finetuneSettings.saturation.max;\n                }\n                else if (type === 'exposure' && this.finetuneSettings.exposure) {\n                    min = this.finetuneSettings.exposure.min;\n                    max = this.finetuneSettings.exposure.max;\n                }\n                else {\n                    min = -100;\n                    max = 100;\n                }\n            }\n            else {\n                min = -100;\n                max = 100;\n            }\n            slider = this.createSlider(min, max, value, type);\n        }\n        else if (type === 'hue' || type === 'blur' || type === 'opacity') {\n            if (this.finetuneSettings) {\n                if (type === 'hue' && this.finetuneSettings.hue) {\n                    min = this.finetuneSettings.hue.min;\n                    max = this.finetuneSettings.hue.max;\n                }\n                else if (type === 'blur' && this.finetuneSettings.blur) {\n                    min = this.finetuneSettings.blur.min;\n                    max = this.finetuneSettings.blur.max;\n                }\n                else if (type === 'opacity' && this.finetuneSettings.opacity) {\n                    min = this.finetuneSettings.opacity.min;\n                    max = this.finetuneSettings.opacity.max;\n                }\n                else {\n                    min = 0;\n                    max = 100;\n                }\n            }\n            else {\n                min = 0;\n                max = 100;\n            }\n            slider = this.createSlider(min, max, value, type);\n        }\n        slider.appendTo('#' + this.element.id + '_sliderWrapper');\n        sliderWrapper.style.left = (parseFloat(canvasWrapper.style.width) - parseFloat(slider.width)) / 2 + 'px';\n    };\n    ImageEditor.prototype.createSlider = function (min, max, value, type) {\n        var _this = this;\n        return new Slider({\n            value: value,\n            tooltip: { isVisible: true, placement: 'Before', showOn: 'Always' },\n            type: 'MinRange',\n            min: min,\n            max: max,\n            step: 10,\n            width: Browser.isDevice ? '200px' : '300px',\n            cssClass: 'e-slider',\n            change: function (args) {\n                if (_this.currObjType.isUndoAction) {\n                    _this.refreshUndoRedoColl();\n                }\n                _this.setCurrAdjustmentValue(type, args.value);\n                _this.enableDisableToolbarBtn();\n            }\n        });\n    };\n    ImageEditor.prototype.getCurrAdjustmentValue = function (type) {\n        var value;\n        switch (type) {\n            case 'brightness':\n                value = this.adjustmentLevel.brightness;\n                break;\n            case 'contrast':\n                value = this.adjustmentLevel.contrast;\n                break;\n            case 'hue':\n                value = this.adjustmentLevel.hue;\n                break;\n            case 'saturation':\n                value = this.adjustmentLevel.saturation;\n                break;\n            case 'opacity':\n                value = this.adjustmentLevel.opacity;\n                break;\n            case 'blur':\n                value = this.adjustmentLevel.blur;\n                break;\n            case 'exposure':\n                value = this.adjustmentLevel.exposure;\n                break;\n        }\n        return value;\n    };\n    ImageEditor.prototype.setCurrAdjustmentValue = function (type, value) {\n        var finetuneValueChanging = { finetune: this.toPascalCase(type), value: value };\n        this.trigger('finetuneValueChanging', finetuneValueChanging);\n        switch (type) {\n            case 'brightness':\n                this.setBrightness(value);\n                break;\n            case 'contrast':\n                this.setContrast(value);\n                break;\n            case 'hue':\n                this.setHue(value);\n                break;\n            case 'saturation':\n                this.setSaturation(value);\n                break;\n            case 'opacity':\n                this.setOpacity(value);\n                break;\n            case 'blur':\n                this.setBlur(value);\n                break;\n            case 'exposure':\n                this.setExposure(value);\n                break;\n        }\n    };\n    ImageEditor.prototype.cancelPan = function () {\n        this.applyActObj();\n        var panBtn = this.element.querySelector('.e-img-pan .e-btn');\n        if (!isNullOrUndefined(panBtn)) {\n            panBtn.classList.remove('e-selected-btn');\n        }\n        this.pan(false);\n    };\n    ImageEditor.prototype.callMainToolbar = function (isApplyBtn, isZooming) {\n        this.refreshToolbar('main', isApplyBtn, false, isZooming);\n    };\n    ImageEditor.prototype.setCurrSelectionPoints = function (isSetDimension) {\n        this.srcLeft = 0;\n        this.srcTop = 0;\n        this.srcWidth = this.baseImg.width;\n        this.srcHeight = this.baseImg.height;\n        this.destLeft = this.cropDestPoints.startX;\n        this.destTop = this.cropDestPoints.startY;\n        this.destWidth = this.cropDestPoints.width;\n        this.destHeight = this.cropDestPoints.height;\n        this.lowerContext.clearRect(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n        if (isSetDimension) {\n            this.setDestinationPoints();\n        }\n        this.currentTransformedState('initial');\n        if (this.croppedDegree === 0 && this.degree === 0 && !isNullOrUndefined(this.currSelectionPoint)\n            && this.currSelectionPoint.shape !== 'crop-circle' && this.currSelectionPoint.shape !== 'crop-square') {\n            this.destLeft = this.cropDestPoints.startX;\n            this.destTop = this.cropDestPoints.startY;\n            this.destWidth = this.cropDestPoints.width;\n            this.destHeight = this.cropDestPoints.height;\n        }\n        if (this.degree === 0) {\n            this.destLeft += this.totalPannedInternalPoint.x;\n            this.destTop += this.totalPannedInternalPoint.y;\n        }\n        this.updateBrightnessFilter();\n        this.lowerContext.drawImage(this.baseImg, this.srcLeft, this.srcTop, this.srcWidth, this.srcHeight, this.destLeft, this.destTop, this.destWidth, this.destHeight);\n        this.currentTransformedState('reverse', null, null, true);\n        if (isNullOrUndefined(this.cropObj.activeObj.shape)) {\n            var temp = this.lowerContext.filter;\n            this.lowerContext.filter = 'none';\n            this.iterateObjColl();\n            this.freehandRedraw(this.lowerContext);\n            this.lowerContext.filter = temp;\n            this.currSelectionPoint = null;\n        }\n        else {\n            if (this.cropObj.cropZoom > 0) {\n                var cropObjColl_1 = extend([], this.objColl, null, true);\n                var cropPointColl_1 = extend([], this.pointColl, null, true);\n                this.objColl = [];\n                this.pointColl = [];\n                this.freehandCounter = 0;\n                this.zoom(this.cropObj.cropZoom);\n                this.objColl = cropObjColl_1;\n                this.pointColl = cropPointColl_1;\n                this.freehandCounter = this.pointColl.length;\n                this.currSelectionPoint = extend({}, this.cropObj.activeObj, null, true);\n                if (this.cropObj.currFlipState !== '') {\n                    this.cropObj.totalPannedPoint.x += this.cropObj.tempFlipPanPoint.x;\n                    this.cropObj.totalPannedPoint.y += this.cropObj.tempFlipPanPoint.y;\n                }\n            }\n            var destPoints = { startX: this.destLeft, startY: this.destTop, width: this.destWidth, height: this.destHeight };\n            this.destLeft = this.currSelectionPoint.activePoint.startX;\n            this.destTop = this.currSelectionPoint.activePoint.startY;\n            this.destWidth = this.currSelectionPoint.activePoint.width;\n            this.destHeight = this.currSelectionPoint.activePoint.height;\n            this.zoomObjColl();\n            this.zoomFreehandDrawColl();\n            this.destLeft = destPoints.startX;\n            this.destTop = destPoints.startY;\n            this.destWidth = destPoints.width;\n            this.destHeight = destPoints.height;\n            this.updatePannedRegion();\n            this.updateObjAndFreeHandDrawColl();\n            var cropObjColl = extend([], this.objColl, null, true);\n            var cropPointColl = extend([], this.pointColl, null, true);\n            this.objColl = [];\n            this.pointColl = [];\n            this.freehandCounter = 0;\n            this.setCurrentObj();\n            var activeObj = extend({}, this.activeObj, null, true);\n            this.refreshActiveObj();\n            this.objColl = cropObjColl;\n            this.pointColl = cropPointColl;\n            this.freehandCounter = this.pointColl.length;\n            this.zoomObjColl();\n            this.zoomFreehandDrawColl();\n            this.currSelectionPoint = null;\n            if (this.degree === 0) {\n                this.drawPannImage({ x: 0, y: 0 });\n            }\n            this.activeObj = activeObj;\n            this.drawObject('duplicate');\n        }\n    };\n    ImageEditor.prototype.updatePannedRegion = function () {\n        var pannedPoint = this.degree === 0 ? this.cropObj.totalPannedPoint : this.cropObj.totalPannedClientPoint;\n        if (this.currFlipState === this.cropObj.currFlipState) {\n            this.panObjColl(-pannedPoint.x, -pannedPoint.y, '');\n            this.panFreehandDrawColl(-pannedPoint.x, -pannedPoint.y, '');\n        }\n        else {\n            if (this.currFlipState === 'horizontal' && this.cropObj.currFlipState === '' ||\n                this.currFlipState === 'vertical' && this.cropObj.currFlipState === '') {\n                this.panObjColl(-pannedPoint.x, -pannedPoint.y, '');\n                this.panFreehandDrawColl(-pannedPoint.x, -pannedPoint.y, '');\n            }\n            else if (this.currFlipState === '' && this.cropObj.currFlipState === 'horizontal') {\n                this.panObjColl(pannedPoint.x, -pannedPoint.y, '');\n                this.panFreehandDrawColl(pannedPoint.x, -pannedPoint.y, '');\n            }\n            else if (this.currFlipState === '' && this.cropObj.currFlipState === 'vertical') {\n                this.panObjColl(-pannedPoint.x, pannedPoint.y, '');\n                this.panFreehandDrawColl(-pannedPoint.x, pannedPoint.y, '');\n            }\n        }\n    };\n    ImageEditor.prototype.updateObjAndFreeHandDrawColl = function () {\n        for (var i = 0; i < this.objColl.length; i++) {\n            this.objColl[i].imageRatio = { startX: ((this.objColl[i].activePoint.startX - this.destLeft) /\n                    this.destWidth), startY: ((this.objColl[i].activePoint.startY - this.destTop) / this.destHeight),\n                endX: ((this.objColl[i].activePoint.endX - this.destLeft) / this.destWidth),\n                endY: ((this.objColl[i].activePoint.endY - this.destTop) / this.destHeight),\n                width: this.destWidth / this.objColl[i].activePoint.width, height: this.destHeight /\n                    this.objColl[i].activePoint.height };\n            this.refreshActiveObj();\n        }\n        for (var n = 0; n < this.freehandCounter; n++) {\n            this.points = extend([], this.pointColl[n].points, []);\n            this.pointCounter = 0;\n            var len = this.points.length;\n            for (var l = 0; l < len; l++) {\n                this.points[l].ratioX = (this.points[l].x - this.destLeft) / this.destWidth;\n                this.points[l].ratioY = (this.points[l].y - this.destTop) / this.destHeight;\n            }\n        }\n    };\n    ImageEditor.prototype.cancelItems = function () {\n        var isCropSelection = false;\n        var splitWords;\n        if (this.activeObj.shape !== undefined) {\n            splitWords = this.activeObj.shape.split('-');\n        }\n        if (splitWords === undefined && this.currObjType.isCustomCrop) {\n            isCropSelection = true;\n        }\n        else if (splitWords !== undefined && splitWords[0] === 'crop') {\n            isCropSelection = true;\n        }\n        if (isCropSelection && this.isCropTab) {\n            this.isCropTab = false;\n            this.zoomFactor = this.defaultZoomFactor;\n        }\n        if (this.togglePen) {\n            this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n            this.togglePen = false;\n            this.upperCanvas.style.cursor = 'default';\n            // eslint-disable-next-line\n            var tempPointsColl = extend([], this.pointColl, [], true);\n            this.pointColl = {};\n            for (var i = 0; i < this.tempFreehandCounter; i++) {\n                this.pointColl[i] = tempPointsColl[i];\n            }\n            this.freehandCounter = this.tempFreehandCounter;\n            this.currentFreehandDrawIndex = this.tempCurrentFreehandDrawIndex;\n        }\n        else if (this.activeObj.shape === 'text') {\n            if (isNullOrUndefined(this.activeObj.currIndex)) {\n                this.refreshActiveObj();\n                this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n            }\n            else {\n                this.activeObj.strokeSettings = this.tempStrokeSettings;\n                this.activeObj.textSettings = this.tempTextSettings;\n                if (this.activeObj.keyHistory === 'Enter Text' && this.activeObj.activePoint.startX === this.textStartPoints.x\n                    && this.activeObj.activePoint.startY === this.textStartPoints.y) {\n                    this.refreshActiveObj();\n                    this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n                    this.textSettings = this.tempTextSettings;\n                    this.strokeSettings = this.tempStrokeSettings;\n                    this.drawShapeText();\n                    this.applyActObj();\n                }\n                else {\n                    this.redrawText();\n                    this.redrawShape(this.activeObj);\n                    if (!isCropSelection && this.activeObj.topLeftCircle !== undefined) {\n                        this.applyActObj();\n                    }\n                    this.clearSelection();\n                }\n            }\n            this.tempTextSettings = { text: 'Enter Text', fontFamily: 'Arial', fontSize: null, fontRatio: null, bold: false,\n                italic: false, underline: false };\n        }\n        else if (this.activeObj.shape === 'rectangle' || this.activeObj.shape === 'ellipse' || this.activeObj.shape === 'line') {\n            if (isNullOrUndefined(this.activeObj.currIndex)) {\n                this.refreshActiveObj();\n                this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n            }\n            else {\n                this.activeObj.strokeSettings = this.tempStrokeSettings;\n                this.redrawShape(this.activeObj);\n                this.applyActObj();\n            }\n        }\n        else if ((this.zoomFactor !== this.tempZoomFactor) || isCropSelection && isNullOrUndefined(this.currSelectionPoint)) {\n            var length_1 = this.cropZoomFactor - this.tempZoomFactor;\n            this.zoomFactor = this.cropZoomFactor;\n            if (isNullOrUndefined(this.cropObj.activeObj.shape)) {\n                if ((this.degree === 0 && this.totalPannedPoint.x === 0 && this.totalPannedPoint.y === 0) ||\n                    (this.degree !== 0 && this.totalPannedInternalPoint.x === 0 && this.totalPannedInternalPoint.y === 0 &&\n                        this.totalPannedClientPoint.x === 0 && this.totalPannedClientPoint.y === 0)) {\n                    this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n                    this.refreshActiveObj();\n                    if (length_1 > 0) {\n                        this.zoom(-length_1);\n                    }\n                    else {\n                        this.zoom(Math.abs(length_1));\n                    }\n                    this.cropZoomFactor = this.tempZoomFactor;\n                    this.currObjType.isCustomCrop = false;\n                    this.upperCanvas.style.cursor = 'default';\n                    this.currObjType.isCustomCrop = false;\n                    this.tempStrokeSettings = { strokeColor: '#fff', fillColor: '', strokeWidth: null };\n                    this.callMainToolbar();\n                    return;\n                }\n            }\n            if (isNullOrUndefined(this.cropObj.activeObj.shape)) {\n                if (this.degree === 0) {\n                    var activeObj = extend({}, this.activeObj, {});\n                    this.destLeft += (-this.totalPannedPoint.x);\n                    this.destTop += (-this.totalPannedPoint.y);\n                    this.drawPannImage({ x: -this.totalPannedPoint.x, y: -this.totalPannedPoint.y });\n                    this.updateFlipPan(activeObj);\n                    this.totalPannedPoint = { x: 0, y: 0 };\n                }\n                else {\n                    this.totalPannedClientPoint = { x: -this.totalPannedClientPoint.x, y: -this.totalPannedClientPoint.y };\n                    this.totalPannedInternalPoint = { x: -this.totalPannedInternalPoint.x, y: -this.totalPannedInternalPoint.y };\n                    this.rotatePan(true);\n                    this.totalPannedClientPoint = { x: 0, y: 0 };\n                    this.totalPannedInternalPoint = { x: 0, y: 0 };\n                    this.currentPannedPoint = { x: 0, y: 0 };\n                }\n                this.refreshActiveObj();\n                this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n                if (length_1 > 0) {\n                    this.zoom(-length_1);\n                }\n                else {\n                    this.zoom(Math.abs(length_1));\n                }\n                this.cropZoomFactor = this.tempZoomFactor;\n            }\n            else {\n                this.isCancelAction = true;\n                this.objColl = [];\n                this.pointColl = [];\n                var freehandCounter = this.freehandCounter;\n                this.freehandCounter = 0;\n                var cropObj = extend({}, this.cropObj, {});\n                var afterCropActions = extend([], this.afterCropActions, {}, true);\n                this.setCurrentObj();\n                this.cropImg();\n                this.cropObj = cropObj;\n                this.afterCropActions = afterCropActions;\n                this.objColl = extend([], this.cancelObjColl, [], true);\n                this.pointColl = extend([], this.cancelPointColl, [], true);\n                this.freehandCounter = freehandCounter;\n                this.iterateObjColl();\n                this.freehandRedraw(this.lowerContext);\n                this.clearOuterCanvas(this.lowerContext);\n                if (this.isCircleCrop) {\n                    this.cropCircle(this.lowerContext);\n                }\n                this.isCancelAction = false;\n            }\n            this.zoomFactor = this.defaultZoomFactor;\n            this.enableDisableToolbarBtn();\n        }\n        else {\n            this.refreshActiveObj();\n            this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n        }\n        this.upperCanvas.style.cursor = 'default';\n        this.currObjType.isCustomCrop = false;\n        this.tempStrokeSettings = { strokeColor: '#fff', fillColor: '', strokeWidth: null };\n        this.callMainToolbar();\n    };\n    ImageEditor.prototype.freehandDownHandler = function (e, canvas) {\n        this.freehandDrawObj.time = new Date().getTime();\n        this.isFreehandDrawing = true;\n        if (e.type === 'mousedown') {\n            this.freehandDownPoint = { x: e.clientX, y: e.clientY };\n        }\n        else {\n            this.freehandDownPoint = { x: e.touches[0].clientX, y: e.touches[0].clientY };\n        }\n        this.isFreehandPointMoved = false;\n        EventHandler.add(canvas, 'mousemove touchmove', this.freehandMoveHandler, this);\n    };\n    ImageEditor.prototype.freehandUpHandler = function (e, canvas, context) {\n        var rect = canvas.getBoundingClientRect();\n        EventHandler.remove(canvas, 'mousemove touchmove', this.freehandMoveHandler);\n        if (this.points.length === 0) {\n            if (e.type === 'mouseup') {\n                this.processPoint(e.clientX - rect.left, e.clientY - rect.top, true, context);\n            }\n            else {\n                if (!this.isFreehandPointMoved) {\n                    this.processPoint(this.freehandDownPoint.x - rect.left, this.freehandDownPoint.y - rect.top, true, context);\n                }\n            }\n        }\n        context.closePath();\n        var prevCropObj = extend({}, this.cropObj, {}, true);\n        var prevObj = this.getCurrentObj();\n        prevObj.objColl = extend([], this.objColl, [], true);\n        prevObj.pointColl = extend([], this.pointColl, [], true);\n        prevObj.afterCropActions = extend([], this.afterCropActions, [], true);\n        this.pointColl[this.freehandCounter] = {};\n        this.pointColl[this.freehandCounter].points = extend([], this.points);\n        this.pointColl[this.freehandCounter].strokeColor = this.activeObj.strokeSettings.strokeColor;\n        this.pointColl[this.freehandCounter].strokeWidth = this.penStrokeWidth;\n        this.pointColl[this.freehandCounter].flipState = this.currFlipState;\n        this.pointColl[this.freehandCounter].id = 'pen_' + (this.currentFreehandDrawIndex + 1);\n        this.points = [];\n        this.pointCounter = 0;\n        this.freehandCounter++;\n        this.currentFreehandDrawIndex++;\n        this.isFreehandDrawing = false;\n        this.updateUndoRedoColl('freehanddraw', prevObj, prevObj.objColl, prevObj.pointColl, prevCropObj);\n    };\n    ImageEditor.prototype.freehandMoveHandler = function (e) {\n        this.isFreehandPointMoved = true;\n        var rect = this.upperCanvas.getBoundingClientRect();\n        var x;\n        var y;\n        if (e.type === 'mousemove') {\n            x = e.clientX - rect.left;\n            y = e.clientY - rect.top;\n        }\n        else {\n            x = e.touches[0].clientX - rect.left;\n            y = e.touches[0].clientY - rect.top;\n        }\n        if (this.isFreehandDrawing) {\n            this.processPoint(x, y, false, this.upperContext);\n        }\n    };\n    ImageEditor.prototype.processPoint = function (x, y, mouseDown, context) {\n        var lastPoint = this.point(x, y, new Date().getTime());\n        lastPoint = this.points.length > 0 && this.points[this.points.length - 1];\n        var isLastPointTooClose = lastPoint ? this.distanceTo(lastPoint) <= 5 : false;\n        var controlPoint1;\n        var controlPoint2;\n        var startPoint;\n        var endPoint;\n        if (!lastPoint || !(lastPoint && isLastPointTooClose) || mouseDown) {\n            this.freehandDrawObj.time = new Date().getTime();\n            this.points.push({ x: x, y: y, ratioX: (x - this.destLeft) / this.destWidth, ratioY: (y - this.destTop) / this.destHeight,\n                time: this.freehandDrawObj.time });\n            if (this.points.length > 3) {\n                controlPoint1 = (this.calcCurveControlPoints(this.points[this.pointCounter + 0], this.points[this.pointCounter + 1], this.points[this.pointCounter + 2])).controlPoint2;\n                controlPoint2 = (this.calcCurveControlPoints(this.points[this.pointCounter + 1], this.points[this.pointCounter + 2], this.points[this.pointCounter + 3])).controlPoint1;\n                startPoint = this.points[this.pointCounter + 1];\n                endPoint = this.points[this.pointCounter + 2];\n                var minStrokeWidth = 0.5;\n                var maxStrokeWidth = 5;\n                if (!isNullOrUndefined(this.penStrokeWidth)) {\n                    minStrokeWidth = maxStrokeWidth = this.penStrokeWidth;\n                }\n                this.startDraw(context, controlPoint1, controlPoint2, startPoint, endPoint, minStrokeWidth, maxStrokeWidth);\n                this.pointCounter++;\n            }\n            if (mouseDown) {\n                controlPoint1 = controlPoint2 = startPoint = endPoint = { x: x, y: y, time: new Date().getTime() };\n                var minStrokeWidth = 0.5;\n                var maxStrokeWidth = 5;\n                if (!isNullOrUndefined(this.penStrokeWidth)) {\n                    minStrokeWidth = maxStrokeWidth = this.penStrokeWidth;\n                }\n                this.startDraw(context, controlPoint1, controlPoint2, startPoint, endPoint, minStrokeWidth, maxStrokeWidth);\n            }\n        }\n    };\n    ImageEditor.prototype.calcCurveControlPoints = function (p1, p2, p3) {\n        if (!p2) {\n            p2 = p1;\n        }\n        if (!p3) {\n            p3 = p2;\n        }\n        var dx1 = p1.x - p2.x;\n        var dy1 = p1.y - p2.y;\n        var dx2 = p2.x - p3.x;\n        var dy2 = p2.y - p3.y;\n        var m1 = { x: (p1.x + p2.x) / 2.0, y: (p1.y + p2.y) / 2.0 };\n        var m2 = { x: (p2.x + p3.x) / 2.0, y: (p2.y + p3.y) / 2.0 };\n        var l1 = Math.sqrt(dx1 * dx1 + dy1 * dy1);\n        var l2 = Math.sqrt(dx2 * dx2 + dy2 * dy2);\n        var dxm = (m1.x - m2.x);\n        var dym = (m1.y - m2.y);\n        var k = l2 / (l1 + l2);\n        var cm = { x: m2.x + dxm * k, y: m2.y + dym * k };\n        var tx = p2.x - cm.x;\n        var ty = p2.y - cm.y;\n        return {\n            controlPoint1: this.point(m1.x + tx, m1.y + ty, 0),\n            controlPoint2: this.point(m2.x + tx, m2.y + ty, 0)\n        };\n    };\n    ImageEditor.prototype.point = function (x, y, time) {\n        this.freehandDrawObj.pointX = x;\n        this.freehandDrawObj.pointY = y;\n        return { x: this.freehandDrawObj.pointX, y: this.freehandDrawObj.pointY, time: time };\n    };\n    ImageEditor.prototype.startDraw = function (context, controlPoint1, controlPoint2, startPoint, endPoint, minStrokeWidth, maxStrokeWidth) {\n        var tempVelocity;\n        tempVelocity = this.pointVelocity(startPoint);\n        tempVelocity = 0.7 * tempVelocity + (1 - 0.7) * this.freehandDrawObj.lastVelocity;\n        var newWidth = Math.max(maxStrokeWidth / (0.7 + 1), minStrokeWidth);\n        this.drawCurve(this.freehandDrawObj.time, newWidth, context, controlPoint1, controlPoint2, startPoint, endPoint, maxStrokeWidth);\n        this.freehandDrawObj.lastVelocity = tempVelocity;\n        this.freehandDrawObj.time = newWidth;\n    };\n    ImageEditor.prototype.pointVelocity = function (startPoint) {\n        return (this.freehandDrawObj.time !== startPoint.time) ? this.distanceTo(startPoint) /\n            (this.freehandDrawObj.time - startPoint.time) : 0;\n    };\n    ImageEditor.prototype.distanceTo = function (start) {\n        return Math.sqrt(Math.pow(this.freehandDrawObj.pointX - start.x, 2) + Math.pow(this.freehandDrawObj.pointY - start.y, 2));\n    };\n    ImageEditor.prototype.drawCurve = function (startWidth, endWidth, context, controlPoint1, controlPoint2, startPoint, endPoint, maxStrokeWidth) {\n        var width;\n        var i;\n        var t1;\n        var t2;\n        var t3;\n        var u1;\n        var u2;\n        var u3;\n        var x;\n        var y;\n        var widthValue = endWidth - startWidth;\n        var bezierLength = this.bezierLength(controlPoint1, controlPoint2, startPoint, endPoint);\n        var drawSteps = Math.ceil(bezierLength) * 2;\n        context.beginPath();\n        for (i = 0; i < drawSteps; i++) {\n            t1 = i / drawSteps;\n            t2 = t1 * t1;\n            t3 = t2 * t1;\n            u1 = 1 - t1;\n            u2 = u1 * u1;\n            u3 = u2 * u1;\n            x = u3 * startPoint.x;\n            x += 3 * u2 * t1 * controlPoint1.x;\n            x += 3 * u1 * t2 * controlPoint2.x;\n            x += t3 * endPoint.x;\n            y = u3 * startPoint.y;\n            y += 3 * u2 * t1 * controlPoint1.y;\n            y += 3 * u1 * t2 * controlPoint2.y;\n            y += t3 * endPoint.y;\n            width = Math.min(startWidth + t3 * widthValue, maxStrokeWidth);\n            this.drawArc(x, y, width, context);\n        }\n        context.closePath();\n        context.fill();\n    };\n    ImageEditor.prototype.bezierLength = function (controlPoint1, controlPoint2, startPoint, endPoint) {\n        var steps = 10;\n        var length = 0;\n        var i;\n        var t;\n        var pointx1;\n        var pointy1;\n        var pointx2;\n        var pointy2;\n        var pointx3;\n        var pointy3;\n        for (i = 0; i <= steps; i++) {\n            t = i / steps;\n            pointx1 = this.bezierPoint(t, startPoint.x, controlPoint1.x, controlPoint2.x, endPoint.x);\n            pointy1 = this.bezierPoint(t, startPoint.y, controlPoint1.y, controlPoint2.y, endPoint.y);\n            if (i > 0) {\n                pointx3 = pointx1 - pointx2;\n                pointy3 = pointy1 - pointy2;\n                length += Math.sqrt(pointx3 * pointx3 + pointy3 * pointy3);\n            }\n            pointx2 = pointx1;\n            pointy2 = pointy1;\n        }\n        return length;\n    };\n    ImageEditor.prototype.bezierPoint = function (t, startpoint, cp1, cp2, endpoint) {\n        return startpoint * (1.0 - t) * (1.0 - t) * (1.0 - t) + 3.0 * cp1 * (1.0 - t) * (1.0 - t) * t + 3.0 *\n            cp2 * (1.0 - t) * t * t + endpoint * t * t * t;\n    };\n    ImageEditor.prototype.drawArc = function (x, y, size, context) {\n        if ((x > this.destLeft && y > this.destTop && x < (this.destLeft + this.destWidth) && y < (this.destTop + this.destHeight) ||\n            (context !== this.lowerContext && context !== this.upperContext))) {\n            context.moveTo(x, y);\n            context.arc(x, y, size, 0, 2 * Math.PI, false);\n        }\n    };\n    ImageEditor.prototype.freehandRedraw = function (context, points) {\n        var temp = context.filter;\n        context.filter = 'none';\n        if (!isNullOrUndefined(points)) {\n            this.pointColl[this.freehandCounter] = {};\n            this.pointColl[this.freehandCounter].points = points;\n            this.pointColl[this.freehandCounter].strokeColor = this.activeObj.strokeSettings.strokeColor;\n            this.pointColl[this.freehandCounter].strokeWidth = this.penStrokeWidth;\n            this.pointColl[this.freehandCounter].flipState = this.currFlipState;\n            this.freehandCounter++;\n        }\n        for (var n = 0; n < this.freehandCounter; n++) {\n            this.points = extend([], this.pointColl[n].points);\n            this.pointCounter = 0;\n            var len = this.points.length;\n            var controlPoint1 = void 0;\n            var controlPoint2 = void 0;\n            var startPoint = void 0;\n            var endPoint = void 0;\n            var minStrokeWidth = void 0;\n            var maxStrokeWidth = void 0;\n            if (len > 0) {\n                context.fillStyle = this.pointColl[n].strokeColor;\n                minStrokeWidth = maxStrokeWidth = this.penStrokeWidth = this.pointColl[n].strokeWidth;\n            }\n            if (len === 1) {\n                controlPoint1 = controlPoint2 = startPoint = endPoint = this.points[0];\n                this.startDraw(context, controlPoint1, controlPoint2, startPoint, endPoint, minStrokeWidth, maxStrokeWidth);\n            }\n            for (var l = 0; l < len - 3; l++) {\n                if (this.points[l + 1] && this.points[l + 2] && this.points[l + 2]) {\n                    controlPoint1 = (this.calcCurveControlPoints(this.points[l + 0], this.points[l + 1], this.points[l + 2])).controlPoint2;\n                    controlPoint2 = (this.calcCurveControlPoints(this.points[l + 1], this.points[l + 2], this.points[l + 3])).controlPoint1;\n                    startPoint = this.points[l + 1];\n                    endPoint = this.points[l + 2];\n                    this.startDraw(context, controlPoint1, controlPoint2, startPoint, endPoint, minStrokeWidth, maxStrokeWidth);\n                }\n            }\n            context.closePath();\n        }\n        context.filter = temp;\n    };\n    ImageEditor.prototype.redrawImgWithObj = function () {\n        this.lowerContext.filter = this.canvasFilter;\n        this.getCurrentFlipState();\n        if (this.isCircleCrop) {\n            this.cropCircle(this.lowerContext);\n        }\n        var tempFilter = this.lowerContext.filter;\n        this.lowerContext.filter = this.getDefaultFilter();\n        this.iterateObjColl();\n        this.freehandRedraw(this.lowerContext);\n        this.lowerContext.filter = tempFilter;\n    };\n    ImageEditor.prototype.refreshToolbar = function (type, isApplyBtn, isCropping, isZooming, cType) {\n        if (!this.isImageLoaded) {\n            return;\n        }\n        var args = { toolbarType: type };\n        if (type !== 'filter' && type !== 'color') {\n            if (document.getElementById(this.element.id + '_toolbar') && this.defToolbarItems.length > 0) {\n                getComponent(document.getElementById(this.element.id + '_toolbar'), 'toolbar').destroy();\n            }\n            if (document.getElementById(this.element.id + '_bottomToolbar') && this.defToolbarItems.length > 0) {\n                if (document.getElementById(this.element.id + '_bottomToolbar').className.indexOf('e-control') > -1) {\n                    getComponent(document.getElementById(this.element.id + '_bottomToolbar'), 'toolbar').destroy();\n                }\n            }\n        }\n        this.refreshSlider();\n        switch (type) {\n            case 'main':\n                if (Browser.isDevice) {\n                    if (isCropping) {\n                        this.initToolbarItem(false, true, true);\n                    }\n                    else {\n                        this.initToolbarItem(false, true, null);\n                    }\n                }\n                else if (!Browser.isDevice || isZooming) {\n                    if (isZooming) {\n                        this.initToolbarItem(isApplyBtn, Browser.isDevice, null);\n                    }\n                    else {\n                        this.initToolbarItem(isApplyBtn, Browser.isDevice, null);\n                    }\n                }\n                if (Browser.isDevice) {\n                    this.initBottomToolbar();\n                }\n                break;\n            case 'shapes':\n                if (Browser.isDevice) {\n                    this.initToolbarItem(false, true, true);\n                }\n                if (this.activeObj.shape === 'line') {\n                    args.toolbarItems = ['strokeColor', 'strokeWidth'];\n                }\n                else {\n                    args.toolbarItems = ['fillColor', 'strokeColor', 'strokeWidth'];\n                }\n                this.trigger('toolbarUpdating', args);\n                this.initShapesToolbarItem(args.toolbarItems);\n                break;\n            case 'text':\n                if (Browser.isDevice) {\n                    this.initToolbarItem(false, true, true);\n                }\n                args.toolbarItems = ['fontFamily', 'fontStyle', 'fontSize', 'fontColor'];\n                this.trigger('toolbarUpdating', args);\n                this.initTextToolbarItem(args.toolbarItems);\n                break;\n            case 'pen':\n                if (Browser.isDevice) {\n                    this.initToolbarItem(false, true, true);\n                }\n                args.toolbarItems = ['strokeColor', 'strokeWidth'];\n                this.trigger('toolbarUpdating', args);\n                this.initPenToolbarItem(args.toolbarItems);\n                break;\n            case 'pan':\n                this.initZoomToolbarItem();\n                break;\n            case 'adjustment':\n                if (Browser.isDevice) {\n                    this.initToolbarItem(false, true, true);\n                }\n                this.initAdjustmentToolbarItem();\n                break;\n            case 'filter':\n                this.updateContextualToolbar(type);\n                break;\n            case 'color':\n                this.updateContextualToolbar(type, cType);\n                break;\n        }\n        this.refreshDropDownBtn(isCropping);\n    };\n    ImageEditor.prototype.getAdjustmentToolbarItem = function () {\n        var toolbarItems = [];\n        if (isNullOrUndefined(this.toolbar) || (!isNullOrUndefined(this.toolbar) && this.toolbar.indexOf('Brightness') > -1)) {\n            toolbarItems.push({ id: this.element.id + '_brightness', prefixIcon: 'e-icons e-brightness', cssClass: 'top-icon e-brightness',\n                tooltipText: this.l10n.getConstant('Brightness'), align: 'Center' });\n        }\n        if (isNullOrUndefined(this.toolbar) || (!isNullOrUndefined(this.toolbar) && this.toolbar.indexOf('Contrast') > -1)) {\n            toolbarItems.push({ id: this.element.id + '_contrast', prefixIcon: 'e-icons e-contrast', cssClass: 'top-icon e-contrast',\n                tooltipText: this.l10n.getConstant('Contrast'), align: 'Center' });\n        }\n        if (isNullOrUndefined(this.toolbar) || (!isNullOrUndefined(this.toolbar) && this.toolbar.indexOf('Hue') > -1)) {\n            toolbarItems.push({ id: this.element.id + '_hue', prefixIcon: 'e-icons e-fade', cssClass: 'top-icon e-fade',\n                tooltipText: this.l10n.getConstant('Hue'), align: 'Center' });\n        }\n        if (isNullOrUndefined(this.toolbar) || (!isNullOrUndefined(this.toolbar) && this.toolbar.indexOf('Saturation') > -1)) {\n            toolbarItems.push({ id: this.element.id + '_saturation', prefixIcon: 'e-icons e-saturation', cssClass: 'top-icon e-saturation',\n                tooltipText: this.l10n.getConstant('Saturation'), align: 'Center' });\n        }\n        if (isNullOrUndefined(this.toolbar) || (!isNullOrUndefined(this.toolbar) && this.toolbar.indexOf('Exposure') > -1)) {\n            toolbarItems.push({ id: this.element.id + '_exposure', prefixIcon: 'e-icons e-grain', cssClass: 'top-icon e-grain',\n                tooltipText: this.l10n.getConstant('Exposure'), align: 'Center' });\n        }\n        if (isNullOrUndefined(this.toolbar) || (!isNullOrUndefined(this.toolbar) && this.toolbar.indexOf('Opacity') > -1)) {\n            toolbarItems.push({ id: this.element.id + '_opacity', prefixIcon: 'e-icons e-opacity', cssClass: 'top-icon e-opacity',\n                tooltipText: this.l10n.getConstant('Opacity'), align: 'Center' });\n        }\n        if (isNullOrUndefined(this.toolbar) || (!isNullOrUndefined(this.toolbar) && this.toolbar.indexOf('Blur') > -1)) {\n            toolbarItems.push({ id: this.element.id + '_blur', prefixIcon: 'e-icons e-tint', cssClass: 'top-icon e-tint',\n                tooltipText: this.l10n.getConstant('Blur'), align: 'Center' });\n        }\n        var tempToolbarItems = this.processToolbar('center');\n        for (var i = 0, len = tempToolbarItems.length; i < len; i++) {\n            toolbarItems.push(tempToolbarItems[i]);\n        }\n        if (!Browser.isDevice) {\n            toolbarItems.push({ id: this.element.id + '_ok', prefixIcon: 'e-icons e-check', cssClass: 'top-icon e-tick',\n                tooltipText: this.l10n.getConstant('OK'), align: 'Right' });\n            toolbarItems.push({ id: this.element.id + '_cancel', prefixIcon: 'e-icons e-close', cssClass: 'top-icon e-save',\n                tooltipText: this.l10n.getConstant('Cancel'), align: 'Right' });\n        }\n        return toolbarItems;\n    };\n    ImageEditor.prototype.getFilterToolbarItem = function () {\n        var toolbarItems = [];\n        if (isNullOrUndefined(this.toolbar) || (!isNullOrUndefined(this.toolbar) && this.toolbar.indexOf('Default') > -1)) {\n            toolbarItems.push({ id: this.element.id + '_default', prefixIcon: 'e-icons e-none', cssClass: 'top-icon e-none',\n                tooltipText: this.l10n.getConstant('Default'), align: 'Center',\n                template: '<div class=\"filterwrapper\" style=\"box-sizing: content-box;\"><canvas id=' + this.element.id + '_defaultCanvas' + '></canvas><div style=\"text-align:center;\"><span>' + this.l10n.getConstant('Default') + '</span></div></div>' });\n        }\n        if (isNullOrUndefined(this.toolbar) || (!isNullOrUndefined(this.toolbar) && this.toolbar.indexOf('Chrome') > -1)) {\n            toolbarItems.push({ id: this.element.id + '_chrome', prefixIcon: 'e-icons e-none', cssClass: 'top-icon e-none',\n                tooltipText: this.l10n.getConstant('Chrome'), align: 'Center',\n                template: '<div class=\"filterwrapper\" style=\"box-sizing: content-box;\"><canvas id=' + this.element.id + '_chromeCanvas' + '></canvas><div style=\"text-align:center;\"><span>' + this.l10n.getConstant('Chrome') + '</span></div></div>' });\n        }\n        if (isNullOrUndefined(this.toolbar) || (!isNullOrUndefined(this.toolbar) && this.toolbar.indexOf('Cold') > -1)) {\n            toolbarItems.push({ id: this.element.id + '_cold', prefixIcon: 'e-icons e-none', cssClass: 'top-icon e-none',\n                tooltipText: this.l10n.getConstant('Cold'), align: 'Center',\n                template: '<div class=\"filterwrapper\" style=\"box-sizing: content-box;\"><canvas id=' + this.element.id + '_coldCanvas' + '></canvas><div style=\"text-align:center;\"><span>' + this.l10n.getConstant('Cold') + '</span></div></div>' });\n        }\n        if (isNullOrUndefined(this.toolbar) || (!isNullOrUndefined(this.toolbar) && this.toolbar.indexOf('Warm') > -1)) {\n            toolbarItems.push({ id: this.element.id + '_warm', prefixIcon: 'e-icons e-none', cssClass: 'top-icon e-none',\n                tooltipText: this.l10n.getConstant('Warm'), align: 'Center',\n                template: '<div class=\"filterwrapper\" style=\"box-sizing: content-box;\"><canvas id=' + this.element.id + '_warmCanvas' + '></canvas><div style=\"text-align:center;\"><span>' + this.l10n.getConstant('Warm') + '</span></div></div>' });\n        }\n        if (isNullOrUndefined(this.toolbar) || (!isNullOrUndefined(this.toolbar) && this.toolbar.indexOf('Grayscale') > -1)) {\n            toolbarItems.push({ id: this.element.id + '_grayscale', prefixIcon: 'e-icons e-none', cssClass: 'top-icon e-none',\n                tooltipText: this.l10n.getConstant('Grayscale'), align: 'Center',\n                template: '<div class=\"filterwrapper\" style=\"box-sizing: content-box;\"><canvas id=' + this.element.id + '_grayscaleCanvas' + '></canvas><div style=\"text-align:center;\"><span>' + this.l10n.getConstant('Grayscale') + '</span></div></div>' });\n        }\n        if (isNullOrUndefined(this.toolbar) || (!isNullOrUndefined(this.toolbar) && this.toolbar.indexOf('Sepia') > -1)) {\n            toolbarItems.push({ id: this.element.id + '_sepia', prefixIcon: 'e-icons e-none', cssClass: 'top-icon e-none',\n                tooltipText: this.l10n.getConstant('Sepia'), align: 'Center',\n                template: '<div class=\"filterwrapper\" style=\"box-sizing: content-box;\"><canvas id=' + this.element.id + '_sepiaCanvas' + '></canvas><div style=\"text-align:center;\"><span>' + this.l10n.getConstant('Sepia') + '</span></div></div>' });\n        }\n        if (isNullOrUndefined(this.toolbar) || (!isNullOrUndefined(this.toolbar) && this.toolbar.indexOf('Invert') > -1)) {\n            toolbarItems.push({ id: this.element.id + '_invert', prefixIcon: 'e-icons e-none', cssClass: 'top-icon e-none',\n                tooltipText: this.l10n.getConstant('Invert'), align: 'Center',\n                template: '<div class=\"filterwrapper\" style=\"box-sizing: content-box;\"><canvas id=' + this.element.id + '_invertCanvas' + '></canvas><div style=\"text-align:center;\"><span>' + this.l10n.getConstant('Invert') + '</span></div></div>' });\n        }\n        var tempToolbarItems = this.processToolbar('center');\n        for (var i = 0, len = tempToolbarItems.length; i < len; i++) {\n            toolbarItems.push(tempToolbarItems[i]);\n        }\n        return toolbarItems;\n    };\n    ImageEditor.prototype.getPenToolbarItem = function (items) {\n        var toolbarItems = [];\n        if (items.indexOf('strokeColor') > -1) {\n            toolbarItems.push({ prefixIcon: 'e-icons e-copy', id: this.element.id + '_pen_strokecolor',\n                cssClass: 'top-icon e-pen-stroke-color',\n                tooltipText: this.l10n.getConstant('StrokeColor'), align: 'Center', type: 'Input',\n                template: '<button id=\"' + this.element.id + '_penColorBtn\"></button>' });\n        }\n        if (items.indexOf('strokeWidth') > -1) {\n            toolbarItems.push({ prefixIcon: 'e-icons e-copy', cssClass: 'top-icon e-size',\n                tooltipText: this.l10n.getConstant('StrokeWidth'),\n                align: 'Center', type: 'Input', template: '<button id=\"' + this.element.id + '_penStrokeWidth\"></button>' });\n        }\n        var tempToolbarItems = this.processSubToolbar(items);\n        for (var i = 0, len = tempToolbarItems.length; i < len; i++) {\n            toolbarItems.push(tempToolbarItems[i]);\n        }\n        if (!Browser.isDevice) {\n            toolbarItems.push({ id: this.element.id + '_ok', prefixIcon: 'e-icons e-check', cssClass: 'top-icon e-tick',\n                tooltipText: this.l10n.getConstant('OK'), align: 'Right' });\n            toolbarItems.push({ id: this.element.id + '_cancel', prefixIcon: 'e-icons e-close', cssClass: 'top-icon e-save',\n                tooltipText: this.l10n.getConstant('Cancel'), align: 'Right' });\n        }\n        return toolbarItems;\n    };\n    ImageEditor.prototype.initPenToolbarItem = function (items) {\n        var _this = this;\n        var leftItem = this.getLeftToolbarItem();\n        var rightItem = this.getRightToolbarItem();\n        var mainItem = this.getPenToolbarItem(items);\n        var zoomItem = this.getZoomToolbarItem();\n        if (Browser.isDevice) {\n            this.defToolbarItems = mainItem;\n        }\n        else {\n            this.defToolbarItems = leftItem.concat(zoomItem, mainItem, rightItem);\n        }\n        var toolbar = new Toolbar({\n            width: '100%',\n            items: this.defToolbarItems,\n            clicked: this.defToolbarClicked.bind(this),\n            created: function () {\n                _this.createPenColor(items);\n                _this.createPenBtn(items);\n                if (!Browser.isDevice) {\n                    _this.renderSaveBtn();\n                }\n                _this.trigger('toolbarCreated', { toolbarType: 'pen' });\n                if (Browser.isDevice) {\n                    if (_this.defToolbarItems.length > 0 && (!isNullOrUndefined(document.getElementById(_this.element.id + '_toolbar')))) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        toolbar.refreshOverflow();\n                    }\n                }\n                else {\n                    _this.createLeftToolbarControls();\n                    if (_this.defToolbarItems.length > 0 && (!isNullOrUndefined(document.getElementById(_this.element.id + '_toolbar')))) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        toolbar.refreshOverflow();\n                    }\n                }\n            }\n        });\n        if (Browser.isDevice) {\n            toolbar.appendTo('#' + this.element.id + '_bottomToolbar');\n        }\n        else {\n            toolbar.appendTo('#' + this.element.id + '_toolbar');\n        }\n        this.enableDisableToolbarBtn();\n    };\n    ImageEditor.prototype.createPenColor = function (items) {\n        var _this = this;\n        // eslint-disable-next-line @typescript-eslint/no-this-alias\n        var proxy = this;\n        if (items.indexOf('strokeColor') > -1) {\n            this.element.querySelector('.e-template.e-pen-stroke-color').appendChild(this.createElement('input', {\n                id: this.element.id + '_pen_stroke'\n            }));\n            var penColor = new ColorPicker({\n                modeSwitcher: false, value: '#fff',\n                showButtons: false, mode: 'Palette', cssClass: 'e-pen-color',\n                change: function (args) {\n                    /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                    var temp = extend([], _this.pointColl, [], true);\n                    _this.updateFreehandDrawColorChange();\n                    var prevCropObj = extend({}, _this.cropObj, {}, true);\n                    var prevObj = _this.getCurrentObj();\n                    prevObj.objColl = extend([], _this.objColl, [], true);\n                    prevObj.pointColl = extend([], _this.pointColl, [], true);\n                    prevObj.afterCropActions = extend([], _this.afterCropActions, [], true);\n                    _this.pointColl = temp;\n                    proxy.isFreehandDrawCustomized = true;\n                    proxy.activeObj.strokeSettings.strokeColor = proxy.selectedFreehandColor = args.currentValue.hex;\n                    if (_this.isFreehandDrawEditing) {\n                        _this.upperContext.clearRect(0, 0, _this.upperCanvas.width, _this.upperCanvas.height);\n                        _this.pointColl[_this.freehandDrawSelectedIndex].strokeColor = args.currentValue.hex;\n                        _this.hoverFreehandraw(args.currentValue.hex);\n                        _this.updateUndoRedoColl('freehanddrawCustomized', prevObj, prevObj.objColl, prevObj.pointColl, prevCropObj);\n                    }\n                    else if (!proxy.togglePen) {\n                        proxy.redrawShape(_this.activeObj);\n                    }\n                    strokeDDB_3.element.children[0].style.backgroundColor = args.currentValue.rgba;\n                    strokeDDB_3.toggle();\n                }\n            }, '#' + this.element.id + '_pen_stroke');\n            var strokeDDB_3 = new DropDownButton({\n                open: function (args) {\n                    if (Browser.isDevice) {\n                        args.element.parentElement.style.top = strokeDDB_3.element.getBoundingClientRect().top -\n                            args.element.parentElement.offsetHeight + 'px';\n                        args.element.parentElement.style.left = _this.element.offsetLeft + 'px';\n                    }\n                },\n                target: '.e-pen-color',\n                iconCss: 'e-dropdownbtn-preview'\n            }, '#' + this.element.id + '_penColorBtn');\n            penColor.inline = true;\n            if (!isNullOrUndefined(this.freehandDrawSelectedIndex) && this.freehandDrawSelectedIndex > -1) {\n                this.element.querySelector('.e-pen-stroke-color.e-template .e-dropdownbtn-preview').style.background\n                    = this.selectedFreehandColor === '#42a5f5' ? this.tempFreeHandDrawEditingStyles.strokeColor :\n                        this.pointColl[this.freehandDrawSelectedIndex].strokeColor;\n            }\n            else {\n                this.element.querySelector('.e-pen-stroke-color.e-template .e-dropdownbtn-preview').style.background\n                    = '#fff';\n            }\n        }\n    };\n    ImageEditor.prototype.createPenBtn = function (items) {\n        var _this = this;\n        var strokeWidthItems = [\n            { id: '1', text: this.l10n.getConstant('XSmall') },\n            { id: '2', text: this.l10n.getConstant('Small') },\n            { id: '3', text: this.l10n.getConstant('Medium') },\n            { id: '4', text: this.l10n.getConstant('Large') },\n            { id: '5', text: this.l10n.getConstant('XLarge') }\n        ];\n        if (items.indexOf('strokeWidth') > -1) {\n            var strokeWidthBtn = document.getElementById(this.element.id + '_penStrokeWidth');\n            var spanElem_3 = document.createElement('span');\n            if (!isNullOrUndefined(this.freehandDrawSelectedIndex) && this.freehandDrawSelectedIndex > -1) {\n                spanElem_3.innerHTML = this.getPenStroke(this.pointColl[this.freehandDrawSelectedIndex].strokeWidth);\n            }\n            else {\n                spanElem_3.innerHTML = this.l10n.getConstant('Small');\n            }\n            spanElem_3.className = 'e-pen-stroke-width';\n            strokeWidthBtn.appendChild(spanElem_3);\n            var drpDownBtn_2 = new DropDownButton({ items: strokeWidthItems,\n                open: function (args) {\n                    if (Browser.isDevice) {\n                        args.element.parentElement.style.top = drpDownBtn_2.element.getBoundingClientRect().top -\n                            args.element.parentElement.offsetHeight + 'px';\n                    }\n                    var activeBtn = spanElem_3.innerHTML;\n                    args.element.querySelector('[aria-label = ' + '\"' + activeBtn + '\"' + ']').classList.add('e-selected-btn');\n                },\n                select: function (args) {\n                    /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                    var temp = extend([], _this.pointColl, [], true);\n                    _this.updateFreehandDrawColorChange();\n                    var prevCropObj = extend({}, _this.cropObj, {}, true);\n                    var prevObj = _this.getCurrentObj();\n                    prevObj.objColl = extend([], _this.objColl, [], true);\n                    prevObj.pointColl = extend([], _this.pointColl, [], true);\n                    prevObj.afterCropActions = extend([], _this.afterCropActions, [], true);\n                    _this.pointColl = temp;\n                    _this.isFreehandDrawCustomized = true;\n                    spanElem_3.textContent = args.item.text;\n                    _this.setPenStroke(args.item.id);\n                    if (_this.isFreehandDrawEditing) {\n                        _this.upperContext.clearRect(0, 0, _this.upperCanvas.width, _this.upperCanvas.height);\n                        _this.hoverFreehandraw(null, _this.penStrokeWidth);\n                        _this.pointColl[_this.freehandDrawSelectedIndex].strokeWidth = _this.penStrokeWidth;\n                        _this.updateUndoRedoColl('freehanddrawCustomized', prevObj, prevObj.objColl, prevObj.pointColl, prevCropObj);\n                    }\n                    if (Browser.isDevice) {\n                        if (!isNullOrUndefined(document.getElementById(_this.element.id + '_bottomToolbar'))) {\n                            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                            var toolbar_8 = getComponent(_this.element.id + '_bottomToolbar', 'toolbar');\n                            toolbar_8.refreshOverflow();\n                        }\n                    }\n                    else {\n                        if (!isNullOrUndefined(document.getElementById(_this.element.id + '_toolbar'))) {\n                            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                            var toolbar_9 = getComponent(_this.element.id + '_toolbar', 'toolbar');\n                            toolbar_9.refreshOverflow();\n                        }\n                    }\n                }\n            });\n            // Render initialized DropDownButton.\n            drpDownBtn_2.appendTo('#' + this.element.id + '_penStrokeWidth');\n        }\n    };\n    ImageEditor.prototype.updateFreehandDrawColorChange = function () {\n        if (!isNullOrUndefined(this.freehandDrawSelectedIndex) && !isNullOrUndefined(this.pointColl[this.freehandDrawSelectedIndex])\n            && this.pointColl[this.freehandDrawSelectedIndex].strokeColor === '#42a5f5') {\n            this.pointColl[this.freehandDrawSelectedIndex].strokeColor = this.tempFreeHandDrawEditingStyles.strokeColor;\n        }\n    };\n    ImageEditor.prototype.setPenStroke = function (args) {\n        switch (parseInt(args, 10)) {\n            case 1:\n                this.penStrokeWidth = 1;\n                break;\n            case 2:\n                this.penStrokeWidth = 2;\n                break;\n            case 3:\n                this.penStrokeWidth = 3;\n                break;\n            case 4:\n                this.penStrokeWidth = 4;\n                break;\n            case 5:\n                this.penStrokeWidth = 5;\n                break;\n        }\n    };\n    ImageEditor.prototype.getPenStroke = function (value) {\n        var textContent = '';\n        if (value === 1) {\n            textContent = this.l10n.getConstant('XSmall');\n        }\n        else if (value === 2) {\n            textContent = this.l10n.getConstant('Small');\n        }\n        else if (value === 3) {\n            textContent = this.l10n.getConstant('Medium');\n        }\n        else if (value === 4) {\n            textContent = this.l10n.getConstant('Large');\n        }\n        else if (value === 5) {\n            textContent = this.l10n.getConstant('XLarge');\n        }\n        return textContent;\n    };\n    ImageEditor.prototype.initAdjustmentToolbarItem = function () {\n        var _this = this;\n        var leftItem = this.getLeftToolbarItem(null);\n        var rightItem = this.getRightToolbarItem();\n        var mainItem = this.getAdjustmentToolbarItem();\n        var zoomItem = this.getZoomToolbarItem();\n        if (Browser.isDevice) {\n            this.defToolbarItems = mainItem;\n        }\n        else {\n            this.defToolbarItems = leftItem.concat(zoomItem, mainItem, rightItem);\n        }\n        var toolbar = new Toolbar({\n            width: '100%',\n            items: this.defToolbarItems,\n            clicked: this.defToolbarClicked.bind(this),\n            created: function () {\n                if (!Browser.isDevice) {\n                    _this.renderSaveBtn();\n                }\n                if (Browser.isDevice) {\n                    if (_this.defToolbarItems.length > 0 && (!isNullOrUndefined(document.getElementById(_this.element.id + '_toolbar')))) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        toolbar.refreshOverflow();\n                    }\n                }\n                else {\n                    _this.createLeftToolbarControls();\n                    if (_this.defToolbarItems.length > 0 && (!isNullOrUndefined(document.getElementById(_this.element.id + '_toolbar')))) {\n                        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n                        toolbar.refreshOverflow();\n                    }\n                }\n            }\n        });\n        if (Browser.isDevice) {\n            toolbar.appendTo('#' + this.element.id + '_bottomToolbar');\n        }\n        else {\n            toolbar.appendTo('#' + this.element.id + '_toolbar');\n        }\n        this.enableDisableToolbarBtn();\n    };\n    ImageEditor.prototype.initFilterToolbarItem = function () {\n        var _this = this;\n        var mainItem = this.getFilterToolbarItem();\n        if (document.querySelector('#' + this.element.id + '_contextualToolbar').classList.contains('e-control')) {\n            getComponent(document.getElementById(this.element.id + '_contextualToolbar'), 'toolbar').destroy();\n        }\n        var toolbar = new Toolbar({\n            width: '100%',\n            items: mainItem,\n            clicked: this.contextualToolbarClicked.bind(this),\n            created: function () {\n                _this.createCanvasFilter();\n                if (_this.currentFilter === '') {\n                    _this.currentFilter = _this.element.id + '_default';\n                }\n                var hdrWrapper = document.querySelector('#' + _this.element.id + '_headWrapper');\n                if (hdrWrapper) {\n                    hdrWrapper.style.display = 'none';\n                }\n                document.getElementById(_this.currentFilter + 'Canvas').parentElement.parentElement.classList.add('e-selected');\n                _this.enableDisableToolbarBtn();\n                toolbar.refreshOverflow();\n            }\n        });\n        toolbar.appendTo('#' + this.element.id + '_contextualToolbar');\n    };\n    ImageEditor.prototype.getCurrentCanvasData = function () {\n        var tempFilter = this.lowerContext.filter;\n        this.lowerContext.filter = 'none';\n        var objColl = extend([], this.objColl, null, true);\n        this.objColl = [];\n        this.renderImage();\n        var data = this.lowerContext.getImageData(this.destLeft, this.destTop, this.destWidth, this.destHeight);\n        this.objColl = objColl;\n        this.iterateObjColl();\n        this.lowerContext.filter = tempFilter;\n        return data;\n    };\n    ImageEditor.prototype.createCanvasFilter = function () {\n        var imageData = this.getCurrentCanvasData();\n        this.inMemoryCanvas.width = imageData.width;\n        this.inMemoryCanvas.height = imageData.height;\n        this.inMemoryContext.putImageData(imageData, 0, 0);\n        var noFilter = document.querySelector('#' + this.element.id + '_defaultCanvas');\n        var ctx = noFilter.getContext('2d');\n        noFilter.style.width = '100px';\n        noFilter.style.height = '100px';\n        ctx.filter = this.updateAdjustment('default', null, true);\n        ctx.drawImage(this.inMemoryCanvas, 0, 0, 300, 150);\n        var chrome = document.querySelector('#' + this.element.id + '_chromeCanvas');\n        ctx = chrome.getContext('2d');\n        chrome.style.width = '100px';\n        chrome.style.height = '100px';\n        ctx.filter = this.updateAdjustment('chrome', null, true);\n        ctx.drawImage(this.inMemoryCanvas, 0, 0, 300, 150);\n        var cold = document.querySelector('#' + this.element.id + '_coldCanvas');\n        ctx = cold.getContext('2d');\n        cold.style.width = '100px';\n        cold.style.height = '100px';\n        ctx.filter = this.updateAdjustment('cold', null, true);\n        ctx.drawImage(this.inMemoryCanvas, 0, 0, 300, 150);\n        var warm = document.querySelector('#' + this.element.id + '_warmCanvas');\n        ctx = warm.getContext('2d');\n        warm.style.width = '100px';\n        warm.style.height = '100px';\n        ctx.filter = this.updateAdjustment('warm', null, true);\n        ctx.drawImage(this.inMemoryCanvas, 0, 0, 300, 150);\n        var grayscale = document.querySelector('#' + this.element.id + '_grayscaleCanvas');\n        ctx = grayscale.getContext('2d');\n        grayscale.style.width = '100px';\n        grayscale.style.height = '100px';\n        ctx.filter = this.updateAdjustment('grayscale', null, true);\n        ctx.drawImage(this.inMemoryCanvas, 0, 0, 300, 150);\n        var sepia = document.querySelector('#' + this.element.id + '_sepiaCanvas');\n        ctx = sepia.getContext('2d');\n        sepia.style.width = '100px';\n        sepia.style.height = '100px';\n        ctx.filter = this.updateAdjustment('sepia', null, true);\n        ctx.drawImage(this.inMemoryCanvas, 0, 0, 300, 150);\n        var invert = document.querySelector('#' + this.element.id + '_invertCanvas');\n        ctx = invert.getContext('2d');\n        invert.style.width = '100px';\n        invert.style.height = '100px';\n        ctx.filter = this.updateAdjustment('invert', null, true);\n        ctx.drawImage(this.inMemoryCanvas, 0, 0, 300, 150);\n    };\n    ImageEditor.prototype.callUpdateCurrentTransformedState = function () {\n        var tempObjColl = extend([], this.objColl, [], true);\n        var tempActiveObj = extend({}, this.activeObj, {}, true);\n        this.objColl = [];\n        this.refreshActiveObj();\n        this.isRotateZoom = true;\n        this.updateCurrentTransformedState('initial');\n        if (this.degree === 0 && this.rotateFlipColl.length > 0) {\n            this.destLeft += this.totalPannedPoint.x;\n            this.destTop += this.totalPannedPoint.y;\n        }\n        this.destLeft += this.totalPannedInternalPoint.x;\n        this.destTop += this.totalPannedInternalPoint.y;\n        var temp = this.lowerContext.filter;\n        if (this.degree === 0) {\n            this.setDestPointsForFlipState();\n        }\n        this.updateBrightnessFilter();\n        this.lowerContext.drawImage(this.baseImg, this.srcLeft, this.srcTop, this.srcWidth, this.srcHeight, this.destLeft, this.destTop, this.destWidth, this.destHeight);\n        this.updateCurrentTransformedState('reverse');\n        if (this.degree === 0 && this.rotateFlipColl.length > 0) {\n            this.destLeft += this.totalPannedPoint.x;\n            this.destTop += this.totalPannedPoint.y;\n        }\n        this.isRotateZoom = false;\n        this.objColl = tempObjColl;\n        var tempTogglePen = this.togglePen;\n        this.togglePen = false;\n        this.lowerContext.filter = 'none';\n        this.iterateObjColl();\n        this.destLeft += this.totalPannedInternalPoint.x;\n        this.destTop += this.totalPannedInternalPoint.y;\n        this.freehandRedraw(this.lowerContext);\n        this.destLeft -= this.totalPannedInternalPoint.x;\n        this.destTop -= this.totalPannedInternalPoint.y;\n        this.togglePen = tempTogglePen;\n        this.lowerContext.filter = temp;\n        this.activeObj = tempActiveObj;\n    };\n    ImageEditor.prototype.updateCurrentTransformedState = function (type, isPreventDestination, isRotatePan) {\n        if (this.rotateFlipColl.length > 0) {\n            if (type === 'initial') {\n                this.reverseTransformedState();\n                if (isNullOrUndefined(isPreventDestination)) {\n                    this.setDestinationPoints();\n                }\n            }\n            this.currentTransformedState(type, null, null, isRotatePan);\n        }\n        if (this.isCircleCrop || (!isNullOrUndefined(this.currSelectionPoint) && this.currSelectionPoint.shape === 'crop-circle')) {\n            if (isRotatePan) {\n                this.destLeft += this.totalPannedClientPoint.x;\n                this.destTop += this.totalPannedClientPoint.y;\n            }\n            this.cropCircle(this.lowerContext);\n            if (isRotatePan) {\n                this.destLeft -= this.totalPannedClientPoint.x;\n                this.destTop -= this.totalPannedClientPoint.y;\n            }\n        }\n    };\n    ImageEditor.prototype.reverseTransformedState = function () {\n        this.lowerContext.setTransform(1, 0, 0, 1, 0, 0);\n    };\n    ImageEditor.prototype.currentTransformedState = function (type, isPreventDimension, context, isPreventCircleCrop) {\n        context = context ? context : this.lowerContext;\n        if (type === 'initial') {\n            this.iterateRotateFlipColl(context, type);\n        }\n        else if (type === 'reverse') {\n            this.iterateRotateFlipColl(context, type);\n            this.setClientTransformedDimension(isPreventDimension);\n            if (this.isCircleCrop || (!isNullOrUndefined(this.currSelectionPoint) && this.currSelectionPoint.shape === 'crop-circle' && isNullOrUndefined(isPreventCircleCrop))) {\n                if (isPreventCircleCrop) {\n                    this.destLeft += this.totalPannedClientPoint.x;\n                    this.destTop += this.totalPannedClientPoint.y;\n                }\n                this.cropCircle(this.lowerContext);\n                if (isPreventCircleCrop) {\n                    this.destLeft -= this.totalPannedClientPoint.x;\n                    this.destTop -= this.totalPannedClientPoint.y;\n                }\n            }\n        }\n    };\n    ImageEditor.prototype.iterateRotateFlipColl = function (context, type) {\n        if (type === 'initial') {\n            for (var i = 0; i < this.rotateFlipColl.length; i++) {\n                this.setTransform(context, this.rotateFlipColl[i]);\n            }\n        }\n        else if (type === 'reverse') {\n            for (var i = this.rotateFlipColl.length - 1; i >= 0; i--) {\n                this.setTransform(context, this.rotateFlipColl[i], true);\n            }\n        }\n    };\n    ImageEditor.prototype.setTransform = function (context, value, isReverse) {\n        if (isReverse && value === 90) {\n            value = -90;\n        }\n        else if (isReverse && value === -90) {\n            value = 90;\n        }\n        if (value === 'horizontal' && this.degree % 90 === 0 && this.degree % 180 !== 0) {\n            value = 'vertical';\n        }\n        else if (value === 'vertical' && this.degree % 90 === 0 && this.degree % 180 !== 0) {\n            value = 'horizontal';\n        }\n        this.isReverseRotate = this.isReverseFlip = true;\n        if (isNullOrUndefined(isReverse)) {\n            context.clearRect(0, 0, context.canvas.width, context.canvas.height);\n        }\n        switch (value) {\n            case 90:\n            case -90:\n                context.translate(context.canvas.width / 2, context.canvas.height / 2);\n                context.rotate(Math.PI / 180 * value);\n                context.translate(-context.canvas.width / 2, -context.canvas.height / 2);\n                break;\n            case 'horizontal':\n                context.translate(context.canvas.width, 0);\n                context.scale(-1, 1);\n                break;\n            case 'vertical':\n                context.translate(0, context.canvas.height);\n                context.scale(1, -1);\n                break;\n        }\n        this.isReverseRotate = this.isReverseFlip = false;\n    };\n    ImageEditor.prototype.isObjInsideCropRegion = function (obj) {\n        var isInside = false;\n        if (obj.activePoint.startX >= this.destLeft && obj.activePoint.endX <= (this.destLeft + this.destWidth)) {\n            isInside = true;\n        }\n        else if (obj.activePoint.startX <= this.destLeft && obj.activePoint.endX >= this.destLeft) {\n            isInside = true;\n        }\n        else if (obj.activePoint.startX <= (this.destLeft + this.destWidth) && obj.activePoint.endX >= (this.destLeft + this.destWidth)) {\n            isInside = true;\n        }\n        else if (obj.activePoint.startY >= this.destTop && obj.activePoint.endY <= (this.destTop + this.destHeight)) {\n            isInside = true;\n        }\n        else if (obj.activePoint.startY <= this.destTop && obj.activePoint.endY >= this.destTop) {\n            isInside = true;\n        }\n        else if (obj.activePoint.startY <= (this.destTop + this.destHeight) && obj.activePoint.endY >= (this.destTop + this.destHeight)) {\n            isInside = true;\n        }\n        return isInside;\n    };\n    ImageEditor.prototype.panFreehandDrawColl = function (xDiff, yDiff, panRegion) {\n        for (var n = 0; n < this.freehandCounter; n++) {\n            this.points = extend([], this.pointColl[n].points, []);\n            this.pointCounter = 0;\n            var len = this.points.length;\n            for (var l = 0; l < len; l++) {\n                if (panRegion === '' || panRegion === 'vertical') {\n                    this.points[l].x += xDiff;\n                }\n                else {\n                    this.points[l].x -= xDiff;\n                }\n                if (panRegion === '' || panRegion === 'horizontal') {\n                    this.points[l].y += yDiff;\n                }\n                else {\n                    this.points[l].y -= yDiff;\n                }\n            }\n        }\n        this.freehandRedraw(this.lowerContext);\n    };\n    ImageEditor.prototype.panObjColl = function (xDiff, yDiff, panRegion) {\n        for (var i = 0; i < this.objColl.length; i++) {\n            if (panRegion === '' || panRegion === 'vertical') {\n                this.objColl[i].activePoint.startX += xDiff;\n                this.objColl[i].activePoint.endX += xDiff;\n            }\n            else {\n                this.objColl[i].activePoint.startX -= xDiff;\n                this.objColl[i].activePoint.endX -= xDiff;\n            }\n            if (panRegion === '' || panRegion === 'horizontal') {\n                this.objColl[i].activePoint.startY += yDiff;\n                this.objColl[i].activePoint.endY += yDiff;\n            }\n            else {\n                this.objColl[i].activePoint.startY -= yDiff;\n                this.objColl[i].activePoint.endY -= yDiff;\n            }\n            this.objColl[i].activePoint.width = this.objColl[i].activePoint.endX -\n                this.objColl[i].activePoint.startX;\n            this.objColl[i].activePoint.height = this.objColl[i].activePoint.endY -\n                this.objColl[i].activePoint.startY;\n            this.updateActiveObject(this.objColl[i].activePoint, this.objColl[i]);\n            var temp = this.lowerContext.filter;\n            this.lowerContext.filter = 'none';\n            this.apply(this.objColl[i].shape, this.objColl[i]);\n            this.lowerContext.filter = temp;\n            this.refreshActiveObj();\n        }\n    };\n    ImageEditor.prototype.cropObjColl = function () {\n        if (this.objColl.length > 0) {\n            for (var i = 0; i < this.objColl.length; i++) {\n                this.objColl[i].imageRatio = { startX: ((this.objColl[i].activePoint.startX -\n                        this.activeObj.activePoint.startX) / this.activeObj.activePoint.width),\n                    startY: ((this.objColl[i].activePoint.startY -\n                        this.activeObj.activePoint.startY) / this.activeObj.activePoint.height),\n                    endX: ((this.objColl[i].activePoint.endX -\n                        this.activeObj.activePoint.startX) / this.activeObj.activePoint.width),\n                    endY: ((this.objColl[i].activePoint.endY -\n                        this.activeObj.activePoint.startY) / this.activeObj.activePoint.height),\n                    width: this.activeObj.activePoint.width / this.objColl[i].activePoint.width,\n                    height: this.activeObj.activePoint.height / this.objColl[i].activePoint.height };\n                if (this.objColl[i].shape === 'text') {\n                    this.objColl[i].textSettings.fontRatio = this.objColl[i].activePoint.width / this.objColl[i].textSettings.fontSize;\n                }\n            }\n        }\n    };\n    ImageEditor.prototype.cropFreehandDrawColl = function () {\n        for (var n = 0; n < this.freehandCounter; n++) {\n            this.points = extend([], this.pointColl[n].points, []);\n            this.pointCounter = 0;\n            var len = this.points.length;\n            for (var l = 0; l < len; l++) {\n                this.points[l].ratioX = (this.points[l].x -\n                    this.activeObj.activePoint.startX) / this.activeObj.activePoint.width;\n                this.points[l].ratioY = (this.points[l].y -\n                    this.activeObj.activePoint.startY) / this.activeObj.activePoint.height;\n            }\n        }\n    };\n    ImageEditor.prototype.hoverFreehandraw = function (fillStyle, strokeWidth) {\n        var context = this.upperContext;\n        var idx = -1;\n        if (this.freehandDrawHoveredIndex > -1) {\n            idx = this.freehandDrawHoveredIndex;\n        }\n        else {\n            idx = this.freehandDrawSelectedIndex;\n        }\n        this.points = extend([], this.pointColl[idx].points);\n        this.pointCounter = 0;\n        var len = this.points.length;\n        var controlPoint1;\n        var controlPoint2;\n        var startPoint;\n        var endPoint;\n        var minStrokeWidth = 0;\n        var maxStrokeWidth = 0;\n        context.fillStyle = fillStyle ? fillStyle : '#42a5f5';\n        context.strokeStyle = '#fff';\n        minStrokeWidth = maxStrokeWidth = this.penStrokeWidth = strokeWidth ?\n            strokeWidth : this.pointColl[idx].strokeWidth;\n        if (len === 1) {\n            controlPoint1 = controlPoint2 = startPoint = endPoint = this.points[0];\n            this.startDraw(context, controlPoint1, controlPoint2, startPoint, endPoint, minStrokeWidth, maxStrokeWidth);\n        }\n        for (var l = 0; l < len - 3; l++) {\n            if (this.points[l + 1] && this.points[l + 2] && this.points[l + 2]) {\n                controlPoint1 = (this.calcCurveControlPoints(this.points[l + 0], this.points[l + 1], this.points[l + 2])).controlPoint2;\n                controlPoint2 = (this.calcCurveControlPoints(this.points[l + 1], this.points[l + 2], this.points[l + 3])).controlPoint1;\n                startPoint = this.points[l + 1];\n                endPoint = this.points[l + 2];\n                this.startDraw(context, controlPoint1, controlPoint2, startPoint, endPoint, minStrokeWidth, maxStrokeWidth);\n            }\n        }\n        context.closePath();\n    };\n    ImageEditor.prototype.pointsHorizontalFlip = function () {\n        for (var n = 0; n < this.freehandCounter; n++) {\n            if (this.pointColl[n].shapeFlip !== this.currFlipState) {\n                this.points = extend([], this.pointColl[n].points, []);\n                this.pointCounter = 0;\n                var len = this.points.length;\n                for (var l = 0; l < len; l++) {\n                    if (this.points[l].x <= this.destLeft + (this.destWidth / 2)) {\n                        this.points[l].x = (this.destLeft + this.destWidth) - (this.points[l].x - this.destLeft);\n                    }\n                    else if (this.points[l].x >= this.destLeft + (this.destWidth / 2)) {\n                        this.points[l].x = this.destLeft + (this.destLeft + this.destWidth - this.points[l].x);\n                    }\n                    this.points[l].ratioX = (this.points[l].x - this.destLeft) / this.destWidth;\n                    this.points[l].ratioY = (this.points[l].y - this.destTop) / this.destHeight;\n                }\n                this.pointColl[n].shapeFlip = this.currFlipState;\n            }\n        }\n    };\n    ImageEditor.prototype.pointsVerticalFlip = function () {\n        for (var n = 0; n < this.freehandCounter; n++) {\n            if (this.pointColl[n].shapeFlip !== this.currFlipState) {\n                this.points = extend([], this.pointColl[n].points, []);\n                this.pointCounter = 0;\n                var len = this.points.length;\n                for (var l = 0; l < len; l++) {\n                    if (this.points[l].y <= this.destTop + (this.destHeight / 2)) {\n                        this.points[l].y = (this.destTop + this.destHeight) - (this.points[l].y - this.destTop);\n                    }\n                    else if (this.points[l].y >= this.destTop + (this.destHeight / 2)) {\n                        this.points[l].y = this.destTop + (this.destTop + this.destHeight - this.points[l].y);\n                    }\n                    this.points[l].ratioX = (this.points[l].x - this.destLeft) / this.destWidth;\n                    this.points[l].ratioY = (this.points[l].y - this.destTop) / this.destHeight;\n                }\n                this.pointColl[n].shapeFlip = this.currFlipState;\n            }\n        }\n    };\n    ImageEditor.prototype.flipFreehandrawColl = function (value) {\n        if (value.toLowerCase() === 'horizontal') {\n            this.pointsHorizontalFlip();\n        }\n        else if (value.toLowerCase() === 'vertical') {\n            this.pointsVerticalFlip();\n        }\n        else {\n            this.pointsHorizontalFlip();\n            for (var i = 0; i < this.freehandCounter; i++) {\n                this.pointColl[i].shapeFlip = '';\n            }\n            this.pointsVerticalFlip();\n        }\n    };\n    ImageEditor.prototype.rotateFreehandDrawColl = function () {\n        for (var n = 0; n < this.freehandCounter; n++) {\n            this.points = extend([], this.pointColl[n].points, []);\n            this.pointCounter = 0;\n            var len = this.points.length;\n            for (var l = 0; l < len; l++) {\n                this.points[l].y = this.destTop + (this.destHeight * this.points[l].ratioX);\n                this.points[l].x = (this.destLeft + this.destWidth) - (this.destWidth * this.points[l].ratioY);\n            }\n        }\n        // Update current image ratio for all objects\n        for (var n = 0; n < this.freehandCounter; n++) {\n            this.points = extend([], this.pointColl[n].points, []);\n            this.pointCounter = 0;\n            var len = this.points.length;\n            for (var l = 0; l < len; l++) {\n                this.points[l].ratioX = (this.points[l].x - this.destLeft) / this.destWidth;\n                this.points[l].ratioY = (this.points[l].y - this.destTop) / this.destHeight;\n            }\n        }\n    };\n    ImageEditor.prototype.zoomFreehandDrawColl = function (isPreventApply) {\n        for (var n = 0; n < this.freehandCounter; n++) {\n            this.points = extend([], this.pointColl[n].points, []);\n            this.pointCounter = 0;\n            var len = this.points.length;\n            for (var l = 0; l < len; l++) {\n                this.points[l].x = this.zoomX(this.points[l].ratioX);\n                this.points[l].y = this.zoomY(this.points[l].ratioY);\n            }\n        }\n        if (isNullOrUndefined(isPreventApply)) {\n            this.freehandRedraw(this.lowerContext);\n        }\n    };\n    ImageEditor.prototype.zoomX = function (x) {\n        return (x * this.destWidth) + this.destLeft;\n    };\n    ImageEditor.prototype.zoomY = function (y) {\n        return (y * this.destHeight) + this.destTop;\n    };\n    ImageEditor.prototype.zoomObjColl = function (preventApply) {\n        for (var i = 0; i < this.objColl.length; i++) {\n            this.objColl[i].activePoint.startX = (this.objColl[i].imageRatio.startX * this.destWidth) + this.destLeft;\n            this.objColl[i].activePoint.startY = (this.objColl[i].imageRatio.startY * this.destHeight) + this.destTop;\n            this.objColl[i].activePoint.endX = (this.objColl[i].imageRatio.endX * this.destWidth) + this.destLeft;\n            this.objColl[i].activePoint.endY = (this.objColl[i].imageRatio.endY * this.destHeight) + this.destTop;\n            this.objColl[i].activePoint.width = this.objColl[i].activePoint.endX -\n                this.objColl[i].activePoint.startX;\n            this.objColl[i].activePoint.height = this.objColl[i].activePoint.endY -\n                this.objColl[i].activePoint.startY;\n            if (this.objColl[i].shape === 'text') {\n                this.updateFontSize(this.objColl[i]);\n            }\n            this.updateActiveObject(this.objColl[i].activePoint, this.objColl[i]);\n            if (isNullOrUndefined(preventApply)) {\n                var temp = this.lowerContext.filter;\n                this.lowerContext.filter = 'none';\n                this.apply(this.objColl[i].shape, this.objColl[i]);\n                this.refreshActiveObj();\n                this.lowerContext.filter = temp;\n            }\n        }\n    };\n    ImageEditor.prototype.calcRatio = function () {\n        var widthRatio;\n        var heightRatio;\n        if (this.degree === 0 || this.degree % 180 === 0) {\n            widthRatio = this.baseImg.width / this.destWidth;\n            heightRatio = this.baseImg.height / this.destHeight;\n        }\n        else {\n            widthRatio = this.baseImg.height / this.destWidth;\n            heightRatio = this.baseImg.width / this.destHeight;\n        }\n        return { width: widthRatio, height: heightRatio };\n    };\n    ImageEditor.prototype.drawCustomSelection = function (cropShape) {\n        this.currObjType.isCustomCrop = true;\n        this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n        this.currObjType.shape = this.activeObj.shape = cropShape.toLowerCase();\n        if (this.zoomFactor === 0) {\n            if (this.destLeft >= 0 && this.destTop >= 0) {\n                this.activeObj.activePoint.startX = this.destLeft;\n                this.activeObj.activePoint.startY = this.destTop;\n                this.activeObj.activePoint.endX = this.destLeft + this.destWidth;\n                this.activeObj.activePoint.endY = this.destTop + this.destHeight;\n            }\n            else if (this.destLeft >= 0) {\n                this.activeObj.activePoint.startX = this.destLeft;\n                this.activeObj.activePoint.startY = 7.5;\n                this.activeObj.activePoint.endX = this.destLeft + this.destWidth;\n                this.activeObj.activePoint.endY = this.lowerCanvas.height - 15;\n            }\n            else if (this.destTop >= 0) {\n                this.activeObj.activePoint.startX = 7.5;\n                this.activeObj.activePoint.startY = this.destTop;\n                this.activeObj.activePoint.endX = this.lowerCanvas.width - 15;\n                this.activeObj.activePoint.endY = this.destTop + this.destHeight;\n            }\n            else {\n                // arcRadius 7.5\n                this.activeObj.activePoint.startX = 7.5;\n                this.activeObj.activePoint.startY = 7.5;\n                this.activeObj.activePoint.endX = this.lowerCanvas.width - 15;\n                this.activeObj.activePoint.endY = this.lowerCanvas.height - 15;\n            }\n        }\n        else {\n            if (this.destLeft > 0) {\n                this.activeObj.activePoint.startX = this.destLeft;\n            }\n            else {\n                this.activeObj.activePoint.startX = 7.5;\n            }\n            if (this.destTop > 0) {\n                this.activeObj.activePoint.startY = this.destTop;\n            }\n            else {\n                this.activeObj.activePoint.startY = 7.5;\n            }\n            if (this.destLeft + this.destWidth + 15 < this.lowerCanvas.width) {\n                this.activeObj.activePoint.endX = this.destLeft + this.destWidth - 15;\n            }\n            else {\n                this.activeObj.activePoint.endX = this.lowerCanvas.width - 15;\n            }\n            if (this.destTop + this.destHeight + 15 < this.lowerCanvas.height) {\n                this.activeObj.activePoint.endY = this.destTop + this.destHeight - 15;\n            }\n            else {\n                this.activeObj.activePoint.endY = this.lowerCanvas.height - 15;\n            }\n        }\n        if (this.activeObj.activePoint.startX < this.destLeft) {\n            this.activeObj.activePoint.startX = this.destLeft;\n        }\n        if (this.activeObj.activePoint.startY < this.destTop) {\n            this.activeObj.activePoint.startY = this.destTop;\n        }\n        if (this.activeObj.activePoint.endX > this.destLeft + this.destWidth) {\n            this.activeObj.activePoint.endX = this.destLeft + this.destWidth;\n        }\n        if (this.activeObj.activePoint.endY > this.destTop + this.destHeight) {\n            this.activeObj.activePoint.endY = this.destTop + this.destHeight;\n        }\n        if (this.activeObj.activePoint.startX === this.destLeft && this.destLeft + this.destWidth > this.lowerCanvas.clientWidth) {\n            this.activeObj.activePoint.endX = this.lowerCanvas.clientWidth - 15;\n        }\n        if (this.activeObj.activePoint.startY === this.destTop && this.destTop + this.destHeight > this.lowerCanvas.clientHeight) {\n            this.activeObj.activePoint.endY = this.lowerCanvas.clientHeight - 15;\n        }\n        this.activeObj.activePoint.width = this.activeObj.activePoint.endX - this.activeObj.activePoint.startX;\n        this.activeObj.activePoint.height = this.activeObj.activePoint.endY - this.activeObj.activePoint.startY;\n        this.updateActiveObject(this.activeObj.activePoint, this.activeObj);\n        this.drawObject('duplicate', this.activeObj, null, null, true);\n    };\n    ImageEditor.prototype.clearOuterCanvas = function (context) {\n        var destLeft = this.destLeft;\n        var destTop = this.destTop;\n        if (this.currFlipState !== '') {\n            this.destLeft = this.lowerCanvas.clientWidth - (this.destWidth + this.destLeft);\n            this.destTop = this.lowerCanvas.clientHeight - (this.destHeight + this.destTop);\n        }\n        if (this.destWidth < this.lowerCanvas.width) {\n            var left = this.destLeft > 0 ? this.destLeft : 0;\n            context.clearRect(0, 0, left, this.lowerCanvas.height);\n            context.clearRect(this.destLeft + this.destWidth, 0, left, this.lowerCanvas.height);\n        }\n        if (this.destHeight < this.lowerCanvas.height) {\n            var top_1 = this.destTop > 0 ? this.destTop : 0;\n            context.clearRect(0, 0, this.lowerCanvas.width, top_1);\n            context.clearRect(0, this.destTop + this.destHeight, this.lowerCanvas.width, top_1);\n        }\n        if (this.currFlipState !== '') {\n            this.destLeft = destLeft;\n            this.destTop = destTop;\n        }\n    };\n    ImageEditor.prototype.cropCircle = function (context, isSave, isFlip) {\n        if (isFlip && this.currFlipState !== '') {\n            this.setTransform(context, this.currFlipState);\n        }\n        context.globalCompositeOperation = 'destination-in';\n        context.beginPath();\n        if (isNullOrUndefined(isSave)) {\n            context.arc(this.destLeft + (this.destWidth / 2), this.destTop + (this.destHeight / 2), this.destWidth / 2, 0, Math.PI * 2);\n        }\n        else {\n            context.arc(this.destWidth / 2, this.destHeight / 2, this.destWidth / 2, 0, Math.PI * 2);\n        }\n        context.closePath();\n        context.fill();\n        context.restore();\n        context.globalCompositeOperation = 'source-over';\n        this.currObjType.isActiveObj = this.isCircleCrop = true;\n        if (isFlip && this.currFlipState !== '') {\n            this.setTransform(context, this.currFlipState);\n        }\n    };\n    ImageEditor.prototype.updateCropObj = function () {\n        this.afterCropActions = [];\n        var obj = this.getCurrentObj();\n        this.cropObj = extend({}, obj, {}, true);\n    };\n    ImageEditor.prototype.setCurrentObj = function (obj) {\n        var isObj = obj ? true : false;\n        obj = obj ? obj : this.cropObj;\n        this.cropZoomFactor = obj.cropZoom;\n        this.defaultZoomFactor = obj.defaultZoom;\n        if (!isObj) {\n            this.zoomFactor = obj.cropZoom;\n        }\n        else {\n            if (!isNullOrUndefined(obj.activeObj.shape) && obj.activeObj.shape.split('-')[0] === 'crop') {\n                this.zoomFactor = obj.cropZoom;\n            }\n            else {\n                this.zoomFactor = obj.defaultZoom;\n            }\n        }\n        this.totalPannedPoint = extend({}, obj.totalPannedPoint, {}, true);\n        this.totalPannedClientPoint = extend({}, obj.totalPannedClientPoint, {}, true);\n        this.totalPannedInternalPoint = extend({}, obj.totalPannedInternalPoint, {}, true);\n        this.tempFlipPanPoint = extend({}, obj.tempFlipPanPoint, {}, true);\n        this.rotateFlipColl = extend([], obj.rotateFlipColl, [], true);\n        this.degree = obj.degree;\n        this.currFlipState = obj.currFlipState;\n        this.destLeft = obj.destPoints.startX;\n        this.destTop = obj.destPoints.startY;\n        this.destWidth = obj.destPoints.width;\n        this.destHeight = obj.destPoints.height;\n        this.srcLeft = obj.srcPoints.startX;\n        this.srcTop = obj.srcPoints.startY;\n        this.srcWidth = obj.srcPoints.width;\n        this.srcHeight = obj.srcPoints.height;\n        this.lowerContext.filter = obj.filter;\n        if (this.lowerContext.filter.split(' ').length > 1) {\n            if (this.lowerContext.filter.split(' ')[0].split('(')[1].split(')')[0] === '1') {\n                this.isBrightnessAdjusted = false;\n            }\n            else {\n                this.isBrightnessAdjusted = true;\n            }\n        }\n        var isCircleCrop = this.isCircleCrop;\n        var currSelectionPoint = extend({}, this.currSelectionPoint, {}, true);\n        this.currSelectionPoint = null;\n        this.isCircleCrop = false;\n        this.drawCropSelectionImage(obj, false);\n        if (this.degree !== 0) {\n            this.currentPannedPoint = { x: 0, y: 0 };\n            this.rotatePan();\n        }\n        this.activeObj = extend({}, obj.activeObj, {}, true);\n        this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n        if (this.activeObj.activePoint.width !== 0 && this.activeObj.activePoint.height !== 0) {\n            this.drawObject('duplicate');\n        }\n        var activeObj = extend({}, obj.activeObj, {}, true);\n        var isAfterCropAction = false;\n        this.afterCropActions = this.alignRotateFlipColl(this.afterCropActions);\n        var afterCropActions = extend([], this.afterCropActions, [], true);\n        if (!isObj && afterCropActions.length > 0) {\n            isAfterCropAction = true;\n            for (var i = 0; i < afterCropActions.length; i++) {\n                if (this.degree % 90 === 0 && this.degree % 180 !== 0 &&\n                    (afterCropActions[i] === 'horizontalflip' || afterCropActions[i] === 'verticalflip')) {\n                    this.rotatedFlipCropSelection = true;\n                }\n                this.updateTransform(afterCropActions[i]);\n                if (afterCropActions[i] === 'horizontalflip' || afterCropActions[i] === 'verticalflip') {\n                    if (afterCropActions.length === 1) {\n                        this.activeObj = extend({}, this.cropObj.activeObj, {}, true);\n                        this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n                        this.drawObject('duplicate');\n                    }\n                }\n            }\n            activeObj = extend({}, this.activeObj, {}, true);\n            this.totalPannedPoint = { x: 0, y: 0 };\n            this.totalPannedClientPoint = { x: 0, y: 0 };\n            this.totalPannedInternalPoint = { x: 0, y: 0 };\n            this.activeObj = activeObj;\n            this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n            if (this.activeObj.activePoint.width !== 0 && this.activeObj.activePoint.height !== 0) {\n                this.drawObject('duplicate');\n            }\n            if (obj.degree !== this.degree) {\n                this.cropZoomFactor = this.zoomFactor = 0;\n            }\n            this.updateObjAndFreeHandDrawColl();\n            if (this.rotatedFlipCropSelection) {\n                // this.totalPannedInternalPoint = extend({}, this.cropObj.totalPannedInternalPoint, {}, true) as Point;\n                this.rotatedFlipCropSelection = false;\n            }\n        }\n        this.afterCropActions = afterCropActions;\n        if (!this.isCancelAction && !isAfterCropAction) {\n            this.updateObjAndFreeHandDrawColl();\n            this.zoomFreehandDrawColl();\n            this.destLeft = obj.destPoints.startX;\n            this.destTop = obj.destPoints.startY;\n        }\n        this.activeObj = activeObj;\n        this.isCircleCrop = isCircleCrop;\n        this.currSelectionPoint = currSelectionPoint;\n    };\n    ImageEditor.prototype.drawCropSelectionImage = function (obj, isObj) {\n        var temp = this.lowerContext.filter;\n        this.upperContext.clearRect(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n        this.lowerContext.clearRect(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n        this.reverseTransformedState();\n        if (isObj) {\n            this.updateCurrentTransformedState('initial');\n        }\n        else {\n            this.iterateRotateFlipColl(this.lowerContext, 'initial');\n        }\n        this.setDestPointsForFlipState();\n        this.updateBrightnessFilter();\n        this.lowerContext.drawImage(this.baseImg, this.srcLeft, this.srcTop, this.srcWidth, this.srcHeight, this.destLeft, this.destTop, this.destWidth, this.destHeight);\n        if (isObj) {\n            this.updateCurrentTransformedState('reverse');\n        }\n        else {\n            this.iterateRotateFlipColl(this.lowerContext, 'reverse');\n        }\n        this.destLeft = this.cropObj.destPoints.startX;\n        this.destTop = this.cropObj.destPoints.startY;\n        var activeObj = extend({}, obj.activeObj, {}, true);\n        this.lowerContext.filter = 'none';\n        if (this.isCancelAction) {\n            this.zoomObjColl();\n            this.zoomFreehandDrawColl();\n        }\n        else {\n            this.destLeft = obj.destPoints.startX;\n            this.destTop = obj.destPoints.startY;\n            this.destWidth = obj.destPoints.width;\n            this.destHeight = obj.destPoints.height;\n            this.srcLeft = obj.srcPoints.startX;\n            this.srcTop = obj.srcPoints.startY;\n            this.srcWidth = obj.srcPoints.width;\n            this.srcHeight = obj.srcPoints.height;\n            var destPoints = { startX: this.destLeft, startY: this.destTop, width: this.destWidth, height: this.destHeight };\n            this.destLeft = obj.activeObj.activePoint.startX;\n            this.destTop = obj.activeObj.activePoint.startY;\n            this.destWidth = obj.activeObj.activePoint.width;\n            this.destHeight = obj.activeObj.activePoint.height;\n            this.zoomObjColl();\n            this.zoomFreehandDrawColl();\n            this.destLeft = destPoints.startX;\n            this.destTop = destPoints.startY;\n            this.destWidth = destPoints.width;\n            this.destHeight = destPoints.height;\n        }\n        this.activeObj = activeObj;\n        this.lowerContext.filter = temp;\n    };\n    ImageEditor.prototype.cropImg = function (isRotateCrop) {\n        if (isNullOrUndefined(isRotateCrop)) {\n            this.croppedDegree = this.degree;\n        }\n        if (isNullOrUndefined(isRotateCrop) && this.degree !== 0) {\n            this.updateCropObj();\n            this.currDestinationPoint = { startX: this.destLeft, startY: this.destTop, width: this.destWidth, height: this.destHeight };\n            this.rotateCrop();\n        }\n        else if (isNullOrUndefined(isRotateCrop) && this.currFlipState !== '') {\n            this.updateCropObj();\n            this.currDestinationPoint = { startX: this.destLeft, startY: this.destTop, width: this.destWidth, height: this.destHeight };\n            this.flipCrop();\n        }\n        else {\n            this.tempZoomFactor = this.zoomFactor;\n            var ratio = this.calcRatio();\n            if (isNullOrUndefined(isRotateCrop) || !isRotateCrop) {\n                this.updateCropObj();\n                this.resetPanPoints();\n                this.updateImageRatioForActObj();\n                this.currDestinationPoint = { startX: this.destLeft, startY: this.destTop, width: this.destWidth, height: this.destHeight };\n                this.currSelectionPoint = extend({}, this.activeObj, {}, true);\n                this.cropDestPoints = { startX: this.destLeft, startY: this.destTop, width: this.destWidth, height: this.destHeight };\n            }\n            var maxDimension = this.calcMaxDimension(this.activeObj.activePoint.width *\n                ratio.width, this.activeObj.activePoint.height * ratio.height);\n            this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n            this.lowerContext.clearRect(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n            this.srcLeft = (this.activeObj.activePoint.startX * ratio.width) - (this.destLeft * ratio.width);\n            this.srcTop = (this.activeObj.activePoint.startY * ratio.height) - (this.destTop * ratio.height);\n            this.srcWidth = (this.activeObj.activePoint.width * ratio.width);\n            this.srcHeight = (this.activeObj.activePoint.height * ratio.height);\n            this.destLeft = (this.lowerCanvas.clientWidth - maxDimension.width) / 2;\n            this.destTop = (this.lowerCanvas.clientHeight - maxDimension.height) / 2;\n            this.destWidth = maxDimension.width;\n            this.destHeight = maxDimension.height;\n            var temp = this.lowerContext.filter;\n            this.updateBrightnessFilter();\n            this.lowerContext.drawImage(this.baseImg, this.srcLeft, this.srcTop, this.srcWidth, this.srcHeight, this.destLeft, this.destTop, this.destWidth, this.destHeight);\n            this.lowerContext.filter = 'none';\n            var activeObj = extend({}, this.activeObj, {}, true);\n            this.cropObjColl();\n            this.zoomObjColl();\n            for (var i = 0; i < this.objColl.length; i++) {\n                if (this.isObjInsideCropRegion(this.objColl[i])) {\n                    this.apply(this.objColl[i].shape, this.objColl[i]);\n                    this.refreshActiveObj();\n                }\n            }\n            this.activeObj = activeObj;\n            this.cropFreehandDrawColl();\n            this.zoomFreehandDrawColl();\n            this.clearOuterCanvas(this.lowerContext);\n            this.clearOuterCanvas(this.upperContext);\n            if (this.currSelectionPoint.shape === 'crop-circle') {\n                this.cropCircle(this.lowerContext);\n            }\n            else {\n                this.isCircleCrop = false;\n            }\n            this.lowerContext.filter = temp;\n            this.refreshActiveObj();\n            this.currObjType.isCustomCrop = false;\n            this.pan(false);\n            this.defaultZoomFactor = 0;\n        }\n    };\n    ImageEditor.prototype.updateImageRatioForActObj = function () {\n        this.activeObj.imageRatio = { startX: ((this.activeObj.activePoint.startX - this.destLeft) / this.destWidth),\n            startY: ((this.activeObj.activePoint.startY - this.destTop) / this.destHeight),\n            endX: ((this.activeObj.activePoint.endX - this.destLeft) / this.destWidth),\n            endY: ((this.activeObj.activePoint.endY - this.destTop) / this.destHeight),\n            width: this.destWidth / this.activeObj.activePoint.width, height: this.destHeight / this.activeObj.activePoint.height };\n    };\n    ImageEditor.prototype.drawImgToCanvas = function (maxDimension) {\n        this.lowerContext.clearRect(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n        this.destWidth = maxDimension.width;\n        this.destHeight = maxDimension.height;\n        if (this.isInitialLoading) {\n            this.initializeFilter();\n            this.isInitialLoading = false;\n        }\n        var temp = this.lowerContext.filter;\n        this.updateBrightnessFilter();\n        this.lowerContext.drawImage(this.baseImg, this.srcLeft, this.srcTop, this.srcWidth, this.srcHeight, this.destLeft, this.destTop, this.destWidth, this.destHeight);\n        if ((!isNullOrUndefined(this.currSelectionPoint) && this.currSelectionPoint.shape === 'crop-circle') || this.isCircleCrop) {\n            this.cropCircle(this.lowerContext);\n        }\n        this.lowerContext.filter = temp;\n    };\n    ImageEditor.prototype.limitPan = function () {\n        if (this.activeObj.activePoint) {\n            if (this.destLeft > this.activeObj.activePoint.startX) {\n                this.destLeft = this.activeObj.activePoint.startX;\n            }\n            if (this.destTop > this.activeObj.activePoint.startY) {\n                this.destTop = this.activeObj.activePoint.startY;\n            }\n            if (this.destLeft + this.destWidth < this.activeObj.activePoint.endX) {\n                this.destLeft = this.activeObj.activePoint.endX - this.destWidth;\n            }\n            if (this.destTop + this.destHeight < this.activeObj.activePoint.endY) {\n                this.destTop = this.activeObj.activePoint.endY - this.destHeight;\n            }\n        }\n    };\n    ImageEditor.prototype.updatePanPoints = function (panRegion) {\n        var tempDestLeft = this.destLeft;\n        var tempDestTop = this.destTop;\n        var xDiff = this.panMove.x - this.tempPanMove.x;\n        var yDiff = this.panMove.y - this.tempPanMove.y;\n        if (panRegion === '') {\n            this.destLeft += xDiff;\n            this.destTop += yDiff;\n            this.limitPan();\n        }\n        else if (panRegion === 'horizontal') {\n            var tempActObj = extend({}, this.activeObj, {}, true);\n            this.updateFlipActiveObj(panRegion);\n            xDiff = this.tempPanMove.x - this.panMove.x;\n            this.destLeft += xDiff;\n            this.destTop += yDiff;\n            this.limitPan();\n            this.activeObj = tempActObj;\n        }\n        else if (panRegion === 'vertical') {\n            var tempActObj = extend({}, this.activeObj, {}, true);\n            this.updateFlipActiveObj(panRegion);\n            yDiff = this.tempPanMove.y - this.panMove.y;\n            this.destLeft += xDiff;\n            this.destTop += yDiff;\n            this.limitPan();\n            this.activeObj = tempActObj;\n        }\n        else if (panRegion === 'horizontalVertical') {\n            var tempActObj = extend({}, this.activeObj, {}, true);\n            this.updateFlipActiveObj(panRegion);\n            xDiff = this.tempPanMove.x - this.panMove.x;\n            this.destLeft += xDiff;\n            this.destTop -= yDiff;\n            this.limitPan();\n            this.activeObj = tempActObj;\n        }\n        else if (panRegion === 'verticalHorizontal') {\n            var tempActObj = extend({}, this.activeObj, {}, true);\n            this.updateFlipActiveObj(panRegion);\n            yDiff = this.tempPanMove.y - this.panMove.y;\n            this.destLeft -= xDiff;\n            this.destTop += yDiff;\n            this.limitPan();\n            this.activeObj = tempActObj;\n        }\n        // returns panned difference for manipulating object collection\n        return { x: this.destLeft - tempDestLeft, y: this.destTop - tempDestTop };\n    };\n    ImageEditor.prototype.setCurrentPanRegion = function (region, type) {\n        var panRegion = region;\n        if (region === '') {\n            if (type === 'horizontal') {\n                panRegion = 'horizontal';\n            }\n            else if (type === 'vertical') {\n                panRegion = 'vertical';\n            }\n        }\n        else if (region === 'horizontal') {\n            if (type === 'horizontal') {\n                panRegion = 'horizontalVertical';\n            }\n            else if (type === 'vertical') {\n                panRegion = 'verticalHorizontal';\n            }\n            else if (type === 90) {\n                panRegion = 'vertical';\n            }\n            else if (type === -90) {\n                panRegion = 'horizontal';\n            }\n        }\n        else if (region === 'vertical') {\n            if (type === 'horizontal') {\n                panRegion = 'horizontalVertical';\n            }\n            else if (type === 'vertical') {\n                panRegion = 'verticalHorizontal';\n            }\n            else if (type === 90) {\n                panRegion = 'horizontal';\n            }\n            else if (type === -90) {\n                panRegion = 'vertical';\n            }\n        }\n        else {\n            if (type === 'horizontal') {\n                panRegion = 'vertical';\n            }\n            else if (type === 'vertical') {\n                panRegion = 'horizontal';\n            }\n        }\n        return panRegion;\n    };\n    ImageEditor.prototype.getCurrentPanRegion = function () {\n        var panRegion = '';\n        for (var i = 0; i < this.rotateFlipColl.length; i++) {\n            panRegion = this.setCurrentPanRegion(panRegion, this.rotateFlipColl[i]);\n        }\n        return panRegion;\n    };\n    ImageEditor.prototype.drawPannImage = function (point) {\n        var destPoints = { startX: this.destLeft, startY: this.destTop, width: this.destWidth, height: this.destHeight };\n        this.lowerContext.clearRect(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n        this.updateCurrentTransformedState('initial');\n        this.destLeft = destPoints.startX;\n        this.destTop = destPoints.startY;\n        this.destWidth = destPoints.width;\n        this.destHeight = destPoints.height;\n        this.setDestPointsForFlipState();\n        this.updateBrightnessFilter();\n        this.lowerContext.drawImage(this.baseImg, this.srcLeft, this.srcTop, this.srcWidth, this.srcHeight, this.destLeft, this.destTop, this.destWidth, this.destHeight);\n        if ((!isNullOrUndefined(this.currSelectionPoint) && this.currSelectionPoint.shape === 'crop-circle') || this.isCircleCrop) {\n            this.cropCircle(this.lowerContext, null, true);\n        }\n        this.updateCurrentTransformedState('reverse');\n        this.destLeft = destPoints.startX;\n        this.destTop = destPoints.startY;\n        this.destWidth = destPoints.width;\n        this.destHeight = destPoints.height;\n        this.lowerContext.filter = 'none';\n        this.panObjColl(point.x, point.y, '');\n        this.panFreehandDrawColl(point.x, point.y, '');\n        if (this.isCircleCrop) {\n            this.cropCircle(this.lowerContext, null, true);\n        }\n    };\n    ImageEditor.prototype.drawPannedImage = function (xDiff, yDiff) {\n        var panEventArgs = { startPoint: this.panDown, endPoint: this.panMove };\n        this.trigger('panning', panEventArgs);\n        var isObjCreated = false;\n        if (isNullOrUndefined(this.activeObj.shape)) {\n            isObjCreated = true;\n            this.activeObj.activePoint = { startX: this.destLeft, startY: this.destTop,\n                endX: this.destLeft + this.destWidth, endY: this.destTop + this.destHeight };\n            if (this.activeObj.activePoint.startX < 0) {\n                this.activeObj.activePoint.startX = 0;\n            }\n            if (this.activeObj.activePoint.startY < 0) {\n                this.activeObj.activePoint.startY = 0;\n            }\n            if (this.activeObj.activePoint.endX > this.lowerCanvas.width) {\n                this.activeObj.activePoint.endX = this.lowerCanvas.width;\n            }\n            if (this.activeObj.activePoint.endY > this.lowerCanvas.height) {\n                this.activeObj.activePoint.endY = this.lowerCanvas.height;\n            }\n            this.activeObj.activePoint.width = this.activeObj.activePoint.endX - this.activeObj.activePoint.startX;\n            this.activeObj.activePoint.height = this.activeObj.activePoint.endY - this.activeObj.activePoint.startY;\n            this.activeObj.shape = 'crop-custom';\n            this.activeObj.strokeSettings = this.strokeSettings;\n            this.updateActiveObject(this.activeObj.activePoint, this.activeObj);\n            this.isCropTab = true;\n        }\n        if (this.degree === 0) {\n            var point = void 0;\n            if (isNullOrUndefined(xDiff) && isNullOrUndefined(yDiff)) {\n                point = this.updatePanPoints('');\n            }\n            else {\n                point = { x: xDiff, y: yDiff };\n            }\n            this.totalPannedPoint.x += point.x;\n            this.totalPannedPoint.y += point.y;\n            var tempSelectionObj = extend({}, this.activeObj, {}, true);\n            var temp = this.lowerContext.filter;\n            this.drawPannImage(point);\n            this.lowerContext.filter = temp;\n            this.tempPanMove = extend({}, this.panMove, {}, true);\n            this.activeObj = extend({}, tempSelectionObj, {}, true);\n            this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n            if (!isNullOrUndefined(this.activeObj.shape)) {\n                this.drawObject('duplicate', this.activeObj);\n            }\n        }\n        else {\n            var tempFlipState = this.currFlipState;\n            this.isCropTab = true;\n            if (isNullOrUndefined(xDiff) && isNullOrUndefined(yDiff)) {\n                this.currentPannedPoint = this.updatePanPoints('');\n            }\n            else {\n                this.currentPannedPoint = { x: xDiff, y: yDiff };\n            }\n            this.currFlipState = tempFlipState;\n            this.rotatePan();\n            this.isCropTab = false;\n            this.tempPanMove = extend({}, this.panMove, {}, true);\n        }\n        if (isObjCreated) {\n            this.refreshActiveObj();\n            this.isCropTab = false;\n            this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n        }\n    };\n    ImageEditor.prototype.updateFlipPan = function (tempSelectionObj) {\n        if (this.currFlipState !== '') {\n            var temp = this.lowerContext.filter;\n            this.refreshActiveObj();\n            this.rotatedFlip();\n            this.lowerContext.filter = 'none';\n            this.freehandRedraw(this.lowerContext);\n            this.lowerContext.filter = temp;\n            this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n            if (!isNullOrUndefined(tempSelectionObj)) {\n                this.drawObject('duplicate', tempSelectionObj);\n            }\n        }\n    };\n    ImageEditor.prototype.updateFlipActiveObj = function (panRegion) {\n        if (panRegion === 'horizontal') {\n            if (this.activeObj.activePoint.startX > this.lowerCanvas.width / 2) {\n                this.activeObj.activePoint.endX = (this.lowerCanvas.width / 2) -\n                    (this.activeObj.activePoint.startX - (this.lowerCanvas.width / 2));\n            }\n            else {\n                this.activeObj.activePoint.endX = (this.lowerCanvas.width / 2) + ((this.lowerCanvas.width / 2) -\n                    this.activeObj.activePoint.startX);\n            }\n            this.activeObj.activePoint.startX = this.activeObj.activePoint.endX - this.activeObj.activePoint.width;\n        }\n        else if (panRegion === 'vertical') {\n            if (this.activeObj.activePoint.startX > this.lowerCanvas.width / 2) {\n                this.activeObj.activePoint.endY = (this.lowerCanvas.height / 2) -\n                    (this.activeObj.activePoint.startY - (this.lowerCanvas.height / 2));\n            }\n            else {\n                this.activeObj.activePoint.endY = (this.lowerCanvas.height / 2) +\n                    ((this.lowerCanvas.height / 2) - this.activeObj.activePoint.startY);\n            }\n            this.activeObj.activePoint.startY = this.activeObj.activePoint.endY - this.activeObj.activePoint.height;\n        }\n        else if (panRegion === 'verticalHorizontal' || panRegion === 'horizontalVertical') {\n            if (this.activeObj.activePoint.startX > this.lowerCanvas.width / 2) {\n                this.activeObj.activePoint.endX = (this.lowerCanvas.width / 2) -\n                    (this.activeObj.activePoint.startX - (this.lowerCanvas.width / 2));\n                this.activeObj.activePoint.endY = (this.lowerCanvas.height / 2) -\n                    (this.activeObj.activePoint.startY - (this.lowerCanvas.height / 2));\n            }\n            else {\n                this.activeObj.activePoint.endX = (this.lowerCanvas.width / 2) + ((this.lowerCanvas.width / 2) -\n                    this.activeObj.activePoint.startX);\n                this.activeObj.activePoint.endY = (this.lowerCanvas.height / 2) +\n                    ((this.lowerCanvas.height / 2) - this.activeObj.activePoint.startY);\n            }\n            this.activeObj.activePoint.startX = this.activeObj.activePoint.endX - this.activeObj.activePoint.width;\n            this.activeObj.activePoint.startY = this.activeObj.activePoint.endY - this.activeObj.activePoint.height;\n        }\n        this.updateActiveObject(this.activeObj.activePoint, this.activeObj);\n    };\n    ImageEditor.prototype.resetPanPoints = function () {\n        this.totalPannedPoint = { x: 0, y: 0 };\n        this.totalPannedClientPoint = { x: 0, y: 0 };\n        this.totalPannedInternalPoint = { x: 0, y: 0 };\n    };\n    ImageEditor.prototype.flipCrop = function () {\n        this.isReverseFlip = true;\n        this.totalPannedPoint.x += this.tempFlipPanPoint.x;\n        this.totalPannedPoint.y += this.tempFlipPanPoint.y;\n        var tempCurrFlipState = this.currFlipState;\n        var tempFlipColl = this.flipColl;\n        this.flipColl = [];\n        this.updateImageRatioForActObj();\n        this.objColl.push(this.activeObj);\n        if (this.zoomFactor > 0) {\n            var zoomFactor = this.zoomFactor;\n            var isUndoRedo = this.isUndoRedo;\n            for (var i = 0; i < (zoomFactor * 10); i++) {\n                this.isUndoRedo = true;\n                this.zoom(-0.1);\n            }\n            this.isUndoRedo = isUndoRedo;\n            this.resetPanPoints();\n        }\n        this.currSelectionPoint = extend({}, this.objColl[this.objColl.length - 1], {}, true);\n        this.lowerContext.clearRect(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n        this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n        var temp = this.lowerContext.filter;\n        this.updateBrightnessFilter();\n        this.lowerContext.drawImage(this.baseImg, this.srcLeft, this.srcTop, this.srcWidth, this.srcHeight, this.destLeft, this.destTop, this.destWidth, this.destHeight);\n        for (var i = 0; i < this.objColl.length; i++) {\n            this.objColl[i].shapeFlip = '';\n        }\n        for (var i = 0; i < this.freehandCounter; i++) {\n            this.pointColl[i].shapeFlip = '';\n        }\n        this.redrawObj(this.getCurrentPanRegion());\n        this.flipFreehandrawColl(this.getCurrentPanRegion());\n        this.activeObj = extend({}, this.objColl[this.objColl.length - 1], {}, true);\n        this.objColl.pop();\n        this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n        this.drawObject('duplicate');\n        this.cropImg(true);\n        this.isReverseRotate = true;\n        this.reverseTransformedState();\n        this.setDestinationPoints();\n        this.currentTransformedState('initial');\n        this.updateBrightnessFilter();\n        this.lowerContext.drawImage(this.baseImg, this.srcLeft, this.srcTop, this.srcWidth, this.srcHeight, this.destLeft, this.destTop, this.destWidth, this.destHeight);\n        this.lowerContext.filter = temp;\n        this.isRotateZoom = false;\n        this.updateCurrentTransformedState('reverse');\n        this.currFlipState = tempCurrFlipState;\n        this.flipColl = tempFlipColl;\n        this.lowerContext.filter = 'none';\n        for (var i = 0; i < this.objColl.length; i++) {\n            this.objColl[i].shapeFlip = '';\n        }\n        for (var i = 0; i < this.freehandCounter; i++) {\n            this.pointColl[i].shapeFlip = '';\n        }\n        this.redrawObj(this.getCurrentPanRegion());\n        this.flipFreehandrawColl(this.getCurrentPanRegion());\n        this.zoomObjColl();\n        this.zoomFreehandDrawColl();\n        this.lowerContext.filter = temp;\n        if ((!isNullOrUndefined(this.currSelectionPoint) && this.currSelectionPoint.shape === 'crop-circle') || this.isCircleCrop) {\n            this.cropCircle(this.lowerContext);\n        }\n        this.refreshActiveObj();\n        this.clearOuterCanvas(this.lowerContext);\n        this.clearOuterCanvas(this.upperContext);\n        this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n        this.isReverseFlip = false;\n        this.resetPanPoints();\n        this.tempFlipPanPoint = { x: 0, y: 0 };\n    };\n    ImageEditor.prototype.rotateCrop = function () {\n        var shape = '';\n        if (!isNullOrUndefined(this.activeObj.shape)) {\n            shape = this.activeObj.shape;\n        }\n        var tempDegree = this.degree;\n        if (this.degree % 90 === 0 && this.degree % 180 !== 0) {\n            this.rotatedDestPoints.startX = this.destLeft;\n            this.rotatedDestPoints.startY = this.destTop;\n            this.rotatedDestPoints.width = this.destWidth;\n            this.rotatedDestPoints.height = this.destHeight;\n            this.rotatedDestPoints.startX -= this.totalPannedClientPoint.x;\n            this.rotatedDestPoints.startY -= this.totalPannedClientPoint.y;\n        }\n        this.updateImageRatioForActObj();\n        this.currSelectionPoint = extend({}, this.activeObj, {}, true);\n        this.objColl.push(this.activeObj);\n        this.activeObj = extend({}, this.objColl[this.objColl.length - 1], {}, true);\n        this.reverseTransformedState();\n        this.setClientTransformedDimension();\n        this.lowerContext.clearRect(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n        var temp = this.lowerContext.filter;\n        this.updateBrightnessFilter();\n        this.lowerContext.drawImage(this.baseImg, this.srcLeft, this.srcTop, this.srcWidth, this.srcHeight, this.destLeft, this.destTop, this.destWidth, this.destHeight);\n        this.lowerContext.filter = temp;\n        var length = 0;\n        if (tempDegree === 90 || tempDegree === -270) {\n            length = 3;\n        }\n        else if (tempDegree === 180 || tempDegree === -180) {\n            length = 2;\n        }\n        else if (tempDegree === 270 || tempDegree === -90) {\n            length = 1;\n        }\n        for (var i = 0; i < length; i++) {\n            this.rotateObjColl();\n            this.rotateFreehandDrawColl();\n        }\n        var activeObj = extend({}, this.objColl[this.objColl.length - 1], {}, true);\n        if (this.currFlipState !== '') {\n            for (var i = 0; i < this.objColl.length; i++) {\n                this.objColl[i].shapeFlip = '';\n            }\n            for (var i = 0; i < this.freehandCounter; i++) {\n                this.pointColl[i].shapeFlip = '';\n            }\n            var flipState = this.getCurrentCropState('initial');\n            this.redrawObj(flipState);\n            this.flipFreehandrawColl(flipState);\n        }\n        this.zoomObjColl();\n        this.zoomFreehandDrawColl();\n        activeObj = extend({}, this.objColl[this.objColl.length - 1], {}, true);\n        this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n        this.drawObject('duplicate', activeObj);\n        this.objColl.pop();\n        this.degree = 0;\n        this.cropImg(true);\n        this.isReverseRotate = true;\n        this.reverseTransformedState();\n        this.degree = tempDegree;\n        this.setDestinationPoints();\n        this.currentTransformedState('initial');\n        this.updateBrightnessFilter();\n        this.lowerContext.drawImage(this.baseImg, this.srcLeft, this.srcTop, this.srcWidth, this.srcHeight, this.destLeft, this.destTop, this.destWidth, this.destHeight);\n        this.lowerContext.filter = temp;\n        this.currentTransformedState('reverse');\n        length = 0;\n        if (tempDegree === 90 || tempDegree === -270) {\n            length = 1;\n        }\n        else if (tempDegree === 180 || tempDegree === -180) {\n            length = 2;\n        }\n        else if (tempDegree === 270 || tempDegree === -90) {\n            length = 3;\n        }\n        for (var i = 0; i < length; i++) {\n            this.rotateObjColl();\n            this.rotateFreehandDrawColl();\n        }\n        if (this.getCurrentPanRegion() !== '') {\n            for (var i = 0; i < this.objColl.length; i++) {\n                this.objColl[i].shapeFlip = '';\n            }\n            for (var i = 0; i < this.freehandCounter; i++) {\n                this.pointColl[i].shapeFlip = '';\n            }\n            var flipState = this.getCurrentCropState('reverse');\n            this.redrawObj(flipState);\n            this.flipFreehandrawColl(flipState);\n        }\n        this.isReverseRotate = false;\n        if (shape === 'crop-circle') {\n            this.cropCircle(this.lowerContext);\n        }\n        this.lowerContext.filter = 'none';\n        for (var i = 0; i < this.objColl.length; i++) {\n            if (this.isObjInsideCropRegion(this.objColl[i])) {\n                this.apply(this.objColl[i].shape, this.objColl[i]);\n                this.refreshActiveObj();\n            }\n        }\n        this.zoomFreehandDrawColl();\n        this.lowerContext.filter = temp;\n        this.clearOuterCanvas(this.lowerContext);\n        this.clearOuterCanvas(this.upperContext);\n        if (shape === 'crop-circle') {\n            this.cropCircle(this.lowerContext);\n        }\n        this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n        this.resetPanPoints();\n    };\n    ImageEditor.prototype.getCurrentCropState = function (type, isAllowInvert) {\n        var flipState = '';\n        var state = [];\n        if (type === 'initial') {\n            if (this.degree === 180 || this.degree === -180) {\n                flipState = this.flipColl.length > 1 ? this.getCurrentPanRegion() : this.currFlipState;\n            }\n            else {\n                for (var i = 0; i < this.rotateFlipColl.length; i++) {\n                    if (typeof (this.rotateFlipColl[i]) === 'number') {\n                        state.push('number');\n                    }\n                    else if (typeof (this.rotateFlipColl[i]) === 'string') {\n                        state.push('string');\n                    }\n                }\n                if (state.length > 1 && state[state.length - 1] === 'string' && state[state.length - 2] === 'number') {\n                    if (this.currFlipState === 'horizontal') {\n                        flipState = 'vertical';\n                    }\n                    else if (this.currFlipState === 'vertical') {\n                        flipState = 'horizontal';\n                    }\n                }\n                else if (state.length > 1 && state[state.length - 1] === 'number' && state[state.length - 2] === 'string') {\n                    flipState = this.flipColl.length > 1 ? this.getCurrentPanRegion() : this.currFlipState;\n                }\n            }\n        }\n        else {\n            flipState = this.getCurrentPanRegion();\n            if (isAllowInvert || !this.isInitialRotate()) {\n                if (this.degree === -90 || this.degree === -270) {\n                    if (flipState === 'horizontal') {\n                        flipState = 'vertical';\n                    }\n                    else if (flipState === 'vertical') {\n                        flipState = 'horizontal';\n                    }\n                }\n            }\n        }\n        if (flipState === '') {\n            flipState = this.flipColl.length > 1 ? this.getCurrentPanRegion() : this.currFlipState;\n        }\n        return flipState;\n    };\n    ImageEditor.prototype.isInitialRotate = function () {\n        var isRotate = false;\n        if (this.rotateFlipColl.length > 0 && typeof (this.rotateFlipColl[0]) === 'number') {\n            isRotate = true;\n        }\n        return isRotate;\n    };\n    ImageEditor.prototype.updateRotatePanPoints = function () {\n        var panRegion = '';\n        if (this.isInitialRotate() && this.degree < 0) {\n            panRegion = this.getCurrentCropState('reverse', true);\n        }\n        else {\n            panRegion = this.getCurrentPanRegion();\n        }\n        if (this.degree % 90 === 0 && this.degree % 180 !== 0) {\n            if (this.degree === 90 || (this.degree === -90 && (panRegion === 'horizontal' || panRegion === 'vertical'))\n                || (this.degree === -270 && (panRegion === '' || panRegion === 'verticalHorizontal' || panRegion === 'horizontalVertical'))) {\n                if (panRegion === '') {\n                    this.destLeft += this.currentPannedPoint.y;\n                    this.destTop -= this.currentPannedPoint.x;\n                }\n                else if (panRegion === 'horizontal') {\n                    this.destLeft += this.currentPannedPoint.y;\n                    this.destTop += this.currentPannedPoint.x;\n                }\n                else if (panRegion === 'vertical') {\n                    this.destLeft -= this.currentPannedPoint.y;\n                    this.destTop -= this.currentPannedPoint.x;\n                }\n                else {\n                    this.destLeft -= this.currentPannedPoint.y;\n                    this.destTop += this.currentPannedPoint.x;\n                }\n            }\n            else if (this.degree === 270 || (this.degree === -270 && (panRegion === 'horizontal' || panRegion === 'vertical'))\n                || (this.degree === -90 && (panRegion === '' || panRegion === 'verticalHorizontal' || panRegion === 'horizontalVertical'))) {\n                if (panRegion === '') {\n                    this.destLeft -= this.currentPannedPoint.y;\n                    this.destTop += this.currentPannedPoint.x;\n                }\n                else if (panRegion === 'horizontal') {\n                    this.destLeft -= this.currentPannedPoint.y;\n                    this.destTop -= this.currentPannedPoint.x;\n                }\n                else if (panRegion === 'vertical') {\n                    this.destLeft += this.currentPannedPoint.y;\n                    this.destTop += this.currentPannedPoint.x;\n                }\n                else {\n                    this.destLeft += this.currentPannedPoint.y;\n                    this.destTop -= this.currentPannedPoint.x;\n                }\n            }\n        }\n        else {\n            if (this.degree === 180 || this.degree === -180) {\n                if (panRegion === '') {\n                    this.destLeft -= this.currentPannedPoint.x;\n                    this.destTop -= this.currentPannedPoint.y;\n                }\n                else if (panRegion === 'horizontal') {\n                    this.destLeft += this.currentPannedPoint.x;\n                    this.destTop -= this.currentPannedPoint.y;\n                }\n                else if (panRegion === 'vertical') {\n                    this.destLeft -= this.currentPannedPoint.x;\n                    this.destTop += this.currentPannedPoint.y;\n                }\n                else {\n                    this.destLeft += this.currentPannedPoint.x;\n                    this.destTop += this.currentPannedPoint.y;\n                }\n            }\n        }\n    };\n    ImageEditor.prototype.rotatePan = function (isCropSelection, isDefaultZoom) {\n        this.isReverseRotate = true;\n        var tempDegree = this.degree;\n        var rotatePanActiveObj;\n        if (!isNullOrUndefined(this.activeObj.activePoint) && !isNullOrUndefined(this.activeObj.shape)) {\n            rotatePanActiveObj = extend({}, this.activeObj, {}, true);\n        }\n        var tempObjColl = extend([], this.objColl, [], true);\n        var tempPointColl = extend([], this.pointColl, [], true);\n        this.objColl = [];\n        this.pointColl = [];\n        this.freehandCounter = 0;\n        this.refreshActiveObj();\n        this.isRotateZoom = true;\n        this.updateCurrentTransformedState('initial');\n        var initialDestLeft = this.destLeft;\n        var initialDestTop = this.destTop;\n        if (this.isCropTab) {\n            this.destLeft += this.totalPannedInternalPoint.x;\n            this.destTop += this.totalPannedInternalPoint.y;\n        }\n        this.updateRotatePanPoints();\n        if (this.isCropTab) {\n            this.totalPannedInternalPoint.x = this.destLeft - initialDestLeft;\n            this.totalPannedInternalPoint.y = this.destTop - initialDestTop;\n        }\n        var temp = this.lowerContext.filter;\n        this.updateBrightnessFilter();\n        this.lowerContext.drawImage(this.baseImg, this.srcLeft, this.srcTop, this.srcWidth, this.srcHeight, this.destLeft, this.destTop, this.destWidth, this.destHeight);\n        this.isRotateZoom = false;\n        this.updateCurrentTransformedState('reverse', true, true);\n        var destLeft = this.destLeft;\n        var destTop = this.destTop;\n        this.destLeft += this.totalPannedClientPoint.x;\n        this.destTop += this.totalPannedClientPoint.y;\n        this.destLeft += this.currentPannedPoint.x;\n        this.destTop += this.currentPannedPoint.y;\n        this.totalPannedClientPoint.x = this.destLeft - destLeft;\n        this.totalPannedClientPoint.y = this.destTop - destTop;\n        this.objColl = tempObjColl;\n        this.pointColl = tempPointColl;\n        this.freehandCounter = this.pointColl.length;\n        this.degree = tempDegree;\n        this.lowerContext.filter = 'none';\n        if (isCropSelection) {\n            if (isDefaultZoom) {\n                this.totalPannedClientPoint.x = -this.totalPannedClientPoint.x;\n                this.totalPannedClientPoint.y = -this.totalPannedClientPoint.y;\n                this.currentPannedPoint = extend({}, this.totalPannedClientPoint, {}, true);\n                this.totalPannedClientPoint = { x: 0, y: 0 };\n                this.destLeft += this.currentPannedPoint.x;\n                this.destTop += this.currentPannedPoint.y;\n            }\n            else {\n                this.currentPannedPoint = extend({}, this.totalPannedClientPoint, {}, true);\n            }\n        }\n        this.panObjColl(this.currentPannedPoint.x, this.currentPannedPoint.y, '');\n        this.panFreehandDrawColl(this.currentPannedPoint.x, this.currentPannedPoint.y, '');\n        this.lowerContext.filter = temp;\n        this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n        this.activeObj = extend({}, rotatePanActiveObj, {}, true);\n        if (!isNullOrUndefined(this.activeObj.activePoint)) {\n            this.drawObject('duplicate', this.activeObj, null, null, true);\n        }\n        this.isReverseRotate = false;\n    };\n    ImageEditor.prototype.rotateZoom = function (value) {\n        var powerOften = Math.pow(10, 1);\n        if ((Math.round(this.zoomFactor * powerOften) / powerOften) === 0.1 && value === -0.1) {\n            this.zoomFactor = 0;\n        }\n        else {\n            this.zoomFactor += value;\n        }\n        if (this.isCropTab) {\n            this.cropZoomFactor = this.zoomFactor;\n        }\n        else {\n            this.defaultZoomFactor = this.zoomFactor;\n        }\n        var tempObjColl = extend([], this.objColl, [], true);\n        var tempActiveObj = extend({}, this.activeObj, {}, true);\n        this.objColl = [];\n        this.refreshActiveObj();\n        this.updateCurrentTransformedState('initial');\n        this.isRotateZoom = true;\n        this.setDestinationPoints();\n        var temp = this.lowerContext.filter;\n        this.updateBrightnessFilter();\n        this.lowerContext.drawImage(this.baseImg, this.srcLeft, this.srcTop, this.srcWidth, this.srcHeight, this.destLeft, this.destTop, this.destWidth, this.destHeight);\n        this.lowerContext.filter = temp;\n        this.isRotateZoom = false;\n        this.updateCurrentTransformedState('reverse');\n        this.objColl = tempObjColl;\n        this.activeObj = tempActiveObj;\n    };\n    ImageEditor.prototype.drawZoomImgToCanvas = function (value, selectionObj) {\n        var powerOften = Math.pow(10, 1);\n        if ((Math.round(this.zoomFactor * powerOften) / powerOften) === 0.1 && value === -0.1) {\n            this.zoomFactor = 0;\n        }\n        else {\n            this.zoomFactor += value;\n        }\n        if (this.isCropTab) {\n            this.cropZoomFactor = this.zoomFactor;\n        }\n        else {\n            this.defaultZoomFactor = this.zoomFactor;\n        }\n        var maxDimension = { width: 0, height: 0 };\n        if (this.isCropTab) {\n            maxDimension = this.cropZoom(value, selectionObj);\n        }\n        else {\n            maxDimension = this.calcMaxDimension(this.srcWidth, this.srcHeight);\n            maxDimension.width += (maxDimension.width * this.zoomFactor);\n            maxDimension.height += (maxDimension.height * this.zoomFactor);\n            this.destLeft = (this.lowerCanvas.clientWidth - maxDimension.width) / 2;\n            this.destTop = (this.lowerCanvas.clientHeight - maxDimension.height) / 2;\n        }\n        this.drawImgToCanvas(maxDimension);\n    };\n    ImageEditor.prototype.cropZoom = function (value, selectionObj) {\n        var destLeft = this.destLeft;\n        var destTop = this.destTop;\n        var maxDimension = { width: 0, height: 0 };\n        if (this.srcLeft === 0 || this.srcTop === 0) {\n            if (isNullOrUndefined(selectionObj)) {\n                maxDimension = this.setZoomDimension(value, null);\n            }\n            else {\n                maxDimension = this.setZoomDimension(value, selectionObj);\n            }\n        }\n        else {\n            if (this.degree % 90 === 0 && this.degree % 180 !== 0) {\n                maxDimension = this.calcMaxDimension(this.srcHeight, this.srcWidth);\n            }\n            else {\n                maxDimension = this.calcMaxDimension(this.srcWidth, this.srcHeight);\n            }\n            maxDimension.width += (maxDimension.width * this.zoomFactor);\n            maxDimension.height += (maxDimension.height * this.zoomFactor);\n        }\n        this.destLeft = destLeft - ((maxDimension.width - this.destWidth) / 2);\n        this.destTop = destTop - ((maxDimension.height - this.destHeight) / 2);\n        destLeft = this.destLeft;\n        destTop = this.destTop;\n        if (!isNullOrUndefined(selectionObj)) {\n            if (this.destLeft > selectionObj.activePoint.startX) {\n                this.destLeft = selectionObj.activePoint.startX;\n                if (this.degree === 0) {\n                    this.totalPannedPoint.x -= (destLeft - this.destLeft);\n                }\n            }\n            if (this.destTop > selectionObj.activePoint.startY) {\n                this.destTop = selectionObj.activePoint.startY;\n                if (this.degree === 0) {\n                    this.totalPannedPoint.y -= (destTop - this.destTop);\n                }\n            }\n            if (this.destLeft + maxDimension.width < selectionObj.activePoint.endX) {\n                this.destLeft = selectionObj.activePoint.endX - maxDimension.width;\n                if (this.degree === 0) {\n                    this.totalPannedPoint.x -= (destLeft - this.destLeft);\n                }\n            }\n            if (this.destTop + maxDimension.height < selectionObj.activePoint.endY) {\n                this.destTop = selectionObj.activePoint.endY - maxDimension.height;\n                if (this.degree === 0) {\n                    this.totalPannedPoint.y -= (destTop - this.destTop);\n                }\n            }\n        }\n        return maxDimension;\n    };\n    ImageEditor.prototype.updateCanvas = function () {\n        var fileOpened = { fileName: this.fileName, fileType: this.fileType };\n        this.srcWidth = this.baseImg.width;\n        this.srcHeight = this.baseImg.height;\n        var maxDimension = this.calcMaxDimension(this.srcWidth, this.srcHeight);\n        this.destLeft = (this.lowerCanvas.clientWidth - maxDimension.width) / 2;\n        this.destTop = (this.lowerCanvas.clientHeight - maxDimension.height) / 2;\n        this.drawImgToCanvas(maxDimension);\n        this.cropDestPoints = { startX: this.destLeft, startY: this.destTop, width: this.destWidth, height: this.destHeight };\n        var temp = this.lowerContext.filter;\n        this.lowerContext.filter = 'none';\n        this.iterateObjColl();\n        this.zoomFreehandDrawColl();\n        this.lowerContext.filter = temp;\n        if (this.destWidth > 0 && this.destHeight > 0) {\n            this.isImageLoaded = true;\n        }\n        if (this.isUndoRedo) {\n            if (this.currFlipState !== '') {\n                this.flip(this.toPascalCase(this.currFlipState));\n            }\n        }\n        if (this.disabled) {\n            this.element.setAttribute('class', 'e-disabled');\n        }\n        this.trigger('fileOpened', fileOpened);\n    };\n    ImageEditor.prototype.imageOnLoad = function (src) {\n        var _this = this;\n        // eslint-disable-next-line @typescript-eslint/no-this-alias\n        var proxy = this;\n        proxy.baseImg.src = src;\n        this.baseImg.onload = function () {\n            _this.lowerContext.drawImage(_this.baseImg, 0, 0, _this.lowerCanvas.width, _this.lowerCanvas.height);\n            hideSpinner(_this.element);\n            _this.element.style.opacity = '1';\n            _this.updateCanvas();\n            if (_this.currObjType.isUndoZoom) {\n                _this.currObjType.isUndoZoom = false;\n                _this.lowerCanvas.style.display = 'block';\n            }\n            _this.isUndoRedo = false;\n            if (Browser.isDevice) {\n                if (_this.isToolbar() && (!isNullOrUndefined(document.getElementById(_this.element.id + '_toolbar'))) &&\n                    (!isNullOrUndefined(getComponent(document.getElementById(_this.element.id + '_toolbar'), 'toolbar')))) {\n                    getComponent(document.getElementById(_this.element.id + '_toolbar'), 'toolbar').destroy();\n                }\n                if (!isNullOrUndefined(document.getElementById(_this.element.id + '_bottomToolbar')) &&\n                    (!isNullOrUndefined(getComponent(document.getElementById(_this.element.id + '_bottomToolbar'), 'toolbar')))) {\n                    getComponent(document.getElementById(_this.element.id + '_bottomToolbar'), 'toolbar').destroy();\n                }\n                _this.initToolbarItem(false, Browser.isDevice, null);\n                _this.createBottomToolbar();\n            }\n            else {\n                if (_this.isToolbar() && (!isNullOrUndefined(document.getElementById(_this.element.id + '_toolbar'))) &&\n                    (!isNullOrUndefined(getComponent(document.getElementById(_this.element.id + '_toolbar'), 'toolbar')))) {\n                    getComponent(document.getElementById(_this.element.id + '_toolbar'), 'toolbar').destroy();\n                }\n                _this.initToolbarItem(false, false, null);\n            }\n        };\n    };\n    ImageEditor.prototype.refreshActiveObj = function () {\n        this.activeObj = {};\n        this.activeObj.activePoint = { startX: 0, startY: 0, endX: 0, endY: 0, width: 0, height: 0 };\n        this.activeObj.flipObjColl = [];\n        this.activeObj.strokeSettings = this.strokeSettings;\n        this.activeObj.textSettings = this.textSettings;\n    };\n    ImageEditor.prototype.redrawText = function () {\n        if (this.activeObj.textSettings.bold) {\n            this.upperContext.font = 'bold ' + this.activeObj.textSettings.fontSize + 'px' + ' ' + this.activeObj.textSettings.fontFamily;\n        }\n        if (this.activeObj.textSettings.italic) {\n            this.upperContext.font = 'bold ' + this.activeObj.textSettings.fontSize + 'px' + ' ' + this.activeObj.textSettings.fontFamily;\n        }\n        if (this.activeObj.textSettings.bold && this.activeObj.textSettings.italic) {\n            this.upperContext.font = 'italic bold ' + this.activeObj.textSettings.fontSize + 'px' + ' ' + this.activeObj.textSettings.fontFamily;\n        }\n        if (!this.activeObj.textSettings.bold && !this.activeObj.textSettings.italic) {\n            this.upperContext.font = this.activeObj.textSettings.fontSize + 'px' + ' ' + this.activeObj.textSettings.fontFamily;\n        }\n        var rows = this.activeObj.keyHistory.split('\\n');\n        var text = this.textArea.style.display === 'block' ? this.getMaxText(true) : this.getMaxText();\n        var width = this.upperContext.measureText(text).width + this.activeObj.textSettings.fontSize * 0.5;\n        var height = rows.length * (this.activeObj.textSettings.fontSize + this.activeObj.textSettings.fontSize * 0.25);\n        this.setTextSelection(width, height);\n        this.updateActiveObject(this.activeObj.activePoint, this.activeObj);\n        this.redrawShape(this.activeObj);\n    };\n    ImageEditor.prototype.setTextSelection = function (width, height) {\n        var degree = this.degree;\n        if (this.activeObj.shapeDegree === 0) {\n            degree = this.degree;\n        }\n        else {\n            degree = this.degree - this.activeObj.shapeDegree;\n        }\n        if (degree < 0) {\n            degree = 360 + degree;\n        }\n        for (var i = 0; i < this.activeObj.flipObjColl.length; i++) {\n            if (degree === 0) {\n                if (this.activeObj.flipObjColl[i].toLowerCase() === 'horizontal') {\n                    this.activeObj.activePoint = { startX: this.activeObj.activePoint.endX - width,\n                        startY: this.activeObj.activePoint.startY,\n                        endX: (this.activeObj.activePoint.endX),\n                        endY: this.activeObj.activePoint.startY + (height ? height : 0) };\n                }\n                else if (this.activeObj.flipObjColl[i].toLowerCase() === 'vertical') {\n                    this.activeObj.activePoint.startY = this.activeObj.activePoint.endY - height;\n                    this.activeObj.activePoint = { startX: this.activeObj.activePoint.startX, startY: this.activeObj.activePoint.startY,\n                        endX: (this.activeObj.activePoint.startX + (width ? width : 0)),\n                        endY: this.activeObj.activePoint.endY };\n                }\n                else {\n                    this.activeObj.activePoint = { startX: this.activeObj.activePoint.startX, startY: this.activeObj.activePoint.startY,\n                        endX: (this.activeObj.activePoint.startX + (width ? width : 0)),\n                        endY: this.activeObj.activePoint.startY + (height ? height : 0) };\n                }\n            }\n            else if (degree === 90) {\n                if (this.activeObj.flipObjColl[i].toLowerCase() === 'vertical') {\n                    this.activeObj.activePoint.startX = this.activeObj.activePoint.endX - height;\n                    this.activeObj.activePoint = { startX: this.activeObj.activePoint.startX,\n                        startY: this.activeObj.activePoint.endY - width,\n                        endX: (this.activeObj.activePoint.endX),\n                        endY: this.activeObj.activePoint.endY };\n                }\n                else if (this.activeObj.flipObjColl[i].toLowerCase() === 'horizontal') {\n                    this.activeObj.activePoint.endX = this.activeObj.activePoint.startX + height;\n                    this.activeObj.activePoint = { startX: this.activeObj.activePoint.startX, startY: this.activeObj.activePoint.startY,\n                        endX: (this.activeObj.activePoint.endX),\n                        endY: this.activeObj.activePoint.startY + (width ? width : 0) };\n                }\n                else {\n                    this.activeObj.activePoint.startX = this.activeObj.activePoint.endX - height;\n                    this.activeObj.activePoint = { startX: this.activeObj.activePoint.startX, startY: this.activeObj.activePoint.startY,\n                        endX: (this.activeObj.activePoint.endX),\n                        endY: this.activeObj.activePoint.startY + (width ? width : 0) };\n                }\n            }\n            else if (degree === 180) {\n                if (this.activeObj.flipObjColl[i].toLowerCase() === 'horizontal') {\n                    this.activeObj.activePoint.startY = this.activeObj.activePoint.endY - height;\n                    this.activeObj.activePoint = { startX: this.activeObj.activePoint.startX,\n                        startY: this.activeObj.activePoint.startY,\n                        endX: (this.activeObj.activePoint.startX + width),\n                        endY: this.activeObj.activePoint.endY };\n                }\n                else if (this.activeObj.flipObjColl[i].toLowerCase() === 'vertical') {\n                    this.activeObj.activePoint.endY = this.activeObj.activePoint.startY + height;\n                    this.activeObj.activePoint = { endX: this.activeObj.activePoint.endX, endY: this.activeObj.activePoint.endY,\n                        startX: (this.activeObj.activePoint.endX - (width ? width : 0)),\n                        startY: this.activeObj.activePoint.startY };\n                }\n                else {\n                    this.activeObj.activePoint = { endX: this.activeObj.activePoint.endX, endY: this.activeObj.activePoint.endY,\n                        startX: (this.activeObj.activePoint.endX - (width ? width : 0)),\n                        startY: this.activeObj.activePoint.endY - (height ? height : 0) };\n                }\n            }\n            else if (degree === 270) {\n                if (this.activeObj.flipObjColl[i].toLowerCase() === 'vertical') {\n                    this.activeObj.activePoint = { startX: this.activeObj.activePoint.startX,\n                        startY: this.activeObj.activePoint.startY,\n                        endX: (this.activeObj.activePoint.startX + height),\n                        endY: this.activeObj.activePoint.startY + (width ? width : 0) };\n                }\n                else if (this.activeObj.flipObjColl[i].toLowerCase() === 'horizontal') {\n                    this.activeObj.activePoint.startX = this.activeObj.activePoint.endX - height;\n                    this.activeObj.activePoint = { startX: this.activeObj.activePoint.startX,\n                        startY: this.activeObj.activePoint.endY - (width ? width : 0),\n                        endX: this.activeObj.activePoint.endX,\n                        endY: this.activeObj.activePoint.endY };\n                }\n                else {\n                    this.activeObj.activePoint.endX = this.activeObj.activePoint.startX + height;\n                    this.activeObj.activePoint = { startX: this.activeObj.activePoint.startX,\n                        startY: this.activeObj.activePoint.endY - (width ? width : 0),\n                        endX: this.activeObj.activePoint.endX,\n                        endY: this.activeObj.activePoint.endY };\n                }\n            }\n        }\n        if (this.activeObj.flipObjColl.length === 0) {\n            if (degree === 0) {\n                this.activeObj.activePoint = { startX: this.activeObj.activePoint.startX, startY: this.activeObj.activePoint.startY,\n                    endX: (this.activeObj.activePoint.startX + (width ? width : 0)),\n                    endY: this.activeObj.activePoint.startY + (height ? height : 0) };\n            }\n            else if (degree === 90) {\n                this.activeObj.activePoint.startX = this.activeObj.activePoint.endX - height;\n                this.activeObj.activePoint = { startX: this.activeObj.activePoint.startX, startY: this.activeObj.activePoint.startY,\n                    endX: (this.activeObj.activePoint.endX),\n                    endY: this.activeObj.activePoint.startY + (width ? width : 0) };\n            }\n            else if (degree === 180) {\n                this.activeObj.activePoint = { endX: this.activeObj.activePoint.endX, endY: this.activeObj.activePoint.endY,\n                    startX: (this.activeObj.activePoint.endX - (width ? width : 0)),\n                    startY: this.activeObj.activePoint.endY - (height ? height : 0) };\n            }\n            else if (degree === 270) {\n                this.activeObj.activePoint.endX = this.activeObj.activePoint.startX + height;\n                this.activeObj.activePoint = { startX: this.activeObj.activePoint.startX,\n                    startY: this.activeObj.activePoint.endY - (width ? width : 0),\n                    endX: this.activeObj.activePoint.endX,\n                    endY: this.activeObj.activePoint.endY };\n            }\n        }\n        this.activeObj.activePoint.width = this.activeObj.activePoint.endX - this.activeObj.activePoint.startX;\n        this.activeObj.activePoint.height = this.activeObj.activePoint.endY - this.activeObj.activePoint.startY;\n        if (this.degree === 360 || this.degree === -360) {\n            this.degree = 0;\n        }\n    };\n    ImageEditor.prototype.getCurrentObj = function () {\n        var obj = { cropZoom: 0, defaultZoom: 0, totalPannedPoint: { x: 0, y: 0 }, totalPannedClientPoint: { x: 0, y: 0 },\n            totalPannedInternalPoint: { x: 0, y: 0 }, tempFlipPanPoint: { x: 0, y: 0 }, activeObj: {},\n            rotateFlipColl: [], degree: 0, currFlipState: '',\n            destPoints: { startX: 0, startY: 0, width: 0, height: 0 },\n            srcPoints: { startX: 0, startY: 0, width: 0, height: 0 }, filter: '' };\n        obj.cropZoom = this.cropZoomFactor;\n        obj.defaultZoom = this.defaultZoomFactor;\n        obj.totalPannedPoint = extend({}, this.totalPannedPoint, {}, true);\n        obj.totalPannedClientPoint = extend({}, this.totalPannedClientPoint, {}, true);\n        obj.totalPannedInternalPoint = extend({}, this.totalPannedInternalPoint, {}, true);\n        obj.tempFlipPanPoint = extend({}, this.tempFlipPanPoint, {}, true);\n        obj.activeObj = extend({}, this.activeObj, {}, true);\n        obj.rotateFlipColl = extend([], this.rotateFlipColl, [], true);\n        obj.degree = this.degree;\n        obj.currFlipState = this.currFlipState;\n        obj.destPoints = { startX: this.destLeft, startY: this.destTop, endX: 0, endY: 0,\n            width: this.destWidth, height: this.destHeight };\n        obj.srcPoints = { startX: this.srcLeft, startY: this.srcTop, endX: 0, endY: 0,\n            width: this.srcWidth, height: this.srcHeight };\n        obj.filter = this.lowerContext.filter;\n        return obj;\n    };\n    ImageEditor.prototype.updateUndoRedoColl = function (operation, previousObj, previousObjColl, previousPointColl, previousCropObj, previousText, currentText, previousFilter) {\n        if (!this.isInitialLoading && this.allowUndoRedo) {\n            if (this.currObjType.isUndoAction) {\n                this.refreshUndoRedoColl();\n            }\n            this.undoRedoStep++;\n            var currentObj = this.getCurrentObj();\n            currentObj.objColl = extend([], this.objColl, [], true);\n            currentObj.pointColl = extend([], this.pointColl, [], true);\n            currentObj.afterCropActions = extend([], this.afterCropActions, [], true);\n            this.undoRedoColl.push({ operation: operation, previousObj: previousObj, currentObj: currentObj,\n                previousObjColl: previousObjColl, currentObjColl: currentObj.objColl,\n                previousPointColl: previousPointColl, currentPointColl: currentObj.pointColl,\n                previousCropObj: previousCropObj, currentCropObj: extend({}, this.cropObj, {}, true),\n                previousText: previousText, currentText: currentText, filter: previousFilter });\n            if (this.undoRedoColl.length > 16) {\n                this.undoRedoColl.splice(0, 1);\n                this.undoRedoStep--;\n            }\n            this.enableDisableToolbarBtn();\n        }\n    };\n    ImageEditor.prototype.fileSelect = function (inputElement, args) {\n        showSpinner(this.element);\n        this.element.style.opacity = '0.5';\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        var filesData = args.target.files[0];\n        if (this.isImageLoaded) {\n            this.isImageLoaded = false;\n            this.reset();\n        }\n        if (isNullOrUndefined(this.toolbarTemplate)) {\n            this.reset();\n            this.update();\n        }\n        this.fileName = inputElement.value.split('\\\\')[inputElement.value.split('\\\\').length - 1];\n        this.fileName = this.fileName.split('.')[0];\n        /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n        var URL = window.URL;\n        var url = URL.createObjectURL(filesData);\n        this.imageOnLoad(url.toString());\n        inputElement.value = '';\n    };\n    ImageEditor.prototype.findTextPoint = function (e) {\n        if (this.activeObj.shape === 'text') {\n            this.textArea.style.transformOrigin = '0 0';\n            var degree = void 0;\n            var scale = '';\n            if (this.activeObj.shapeDegree === 0) {\n                degree = this.degree;\n            }\n            else {\n                degree = this.degree - this.activeObj.shapeDegree;\n            }\n            if (degree < 0) {\n                degree = 360 + degree;\n            }\n            if (this.activeObj.flipObjColl.length > 0) {\n                // need to add scale value according to length.\n                for (var i = 0; i < this.activeObj.flipObjColl.length; i++) {\n                    if (degree !== 0 && degree % 90 === 0 && degree !== 180) {\n                        scale += this.activeObj.flipObjColl[i].toLowerCase() === 'horizontal' ? 'scale(1, -1)' :\n                            'scale(-1, 1)';\n                    }\n                    else {\n                        scale += this.activeObj.flipObjColl[i].toLowerCase() === 'horizontal' ? 'scale(-1, 1)' :\n                            'scale(1, -1)';\n                    }\n                    if (this.activeObj.flipObjColl[i].toLowerCase() === 'horizontal') {\n                        this.textArea.style.transform = 'rotate(' + degree + 'deg)' + scale;\n                    }\n                    else if (this.activeObj.flipObjColl[i].toLowerCase() === 'vertical') {\n                        this.textArea.style.transform = 'rotate(' + degree + 'deg)' + scale;\n                    }\n                }\n            }\n            else {\n                this.textArea.style.transform = 'rotate(' + degree + 'deg)';\n            }\n            this.findTextTarget(e);\n        }\n    };\n    ImageEditor.prototype.getStrokeWidth = function (text) {\n        var strokeWidth;\n        var currentWidth = parseInt(text, 10) / 2;\n        switch (currentWidth) {\n            case 1:\n                strokeWidth = this.l10n.getConstant('XSmall');\n                break;\n            case 2:\n                strokeWidth = this.l10n.getConstant('Small');\n                break;\n            case 3:\n                strokeWidth = this.l10n.getConstant('Medium');\n                break;\n            case 4:\n                strokeWidth = this.l10n.getConstant('Large');\n                break;\n            case 5:\n                strokeWidth = this.l10n.getConstant('XLarge');\n                break;\n        }\n        return strokeWidth;\n    };\n    ImageEditor.prototype.updateToolbarItems = function () {\n        var selFillElem = this.element.querySelector('.e-fill.e-template .e-dropdownbtn-preview');\n        var selStrokeElem = this.element.querySelector('.e-stroke.e-template .e-dropdownbtn-preview');\n        var selTextStrokeElem = this.element.querySelector('.e-text-font-color.e-template .e-dropdownbtn-preview');\n        var selPenStrokeElem = this.element.querySelector('.e-pen-stroke-color.e-template .e-dropdownbtn-preview');\n        var strokeWidthElem = this.element.querySelector('.e-shape-stroke-width');\n        var fontFamilyElem = this.element.querySelector('.e-text-font-family');\n        var fontSizeElem = this.element.querySelector('.e-text-font-size');\n        var fontStyleElem = this.element.querySelector('.e-text-font-style');\n        if (selFillElem) {\n            if (this.activeObj.strokeSettings.fillColor === '') {\n                selFillElem.classList.add('e-nocolor-item');\n            }\n            else {\n                selFillElem.classList.remove('e-nocolor-item');\n                selFillElem.style.background = this.activeObj.strokeSettings.fillColor;\n            }\n            getComponent(this.element.id + '_shape_fill', 'colorpicker').value\n                = this.activeObj.strokeSettings.fillColor + 'ff';\n        }\n        if (selStrokeElem) {\n            selStrokeElem.style.background = this.activeObj.strokeSettings.strokeColor;\n            getComponent(this.element.id + '_shape_stroke', 'colorpicker').value\n                = this.activeObj.strokeSettings.strokeColor + 'ff';\n        }\n        if (selTextStrokeElem) {\n            selTextStrokeElem.style.background = this.activeObj.strokeSettings.strokeColor;\n            getComponent(this.element.id + '_text_font', 'colorpicker').value\n                = this.activeObj.strokeSettings.strokeColor + 'ff';\n        }\n        if (selPenStrokeElem) {\n            selPenStrokeElem.style.background = this.activeObj.strokeSettings.strokeColor;\n            getComponent(this.element.id + '_pen_stroke', 'colorpicker').value\n                = this.activeObj.strokeSettings.strokeColor + 'ff';\n        }\n        if (fontFamilyElem) {\n            if (Browser.isDevice) {\n                fontFamilyElem.setAttribute('style', 'font-family:' + this.activeObj.textSettings.fontFamily.toLowerCase());\n            }\n            else {\n                fontFamilyElem.textContent = this.activeObj.textSettings.fontFamily;\n            }\n        }\n        if (fontSizeElem) {\n            for (var i = 0; i < this.fontSizeColl.length; i++) {\n                if (parseInt(this.fontSizeColl[i].text, 10) >= Math.round(this.activeObj.textSettings.fontSize)) {\n                    fontSizeElem.textContent = (i + 1).toString();\n                    break;\n                }\n            }\n        }\n        if (fontStyleElem) {\n            if (Browser.isDevice) {\n                if (!this.activeObj.textSettings.bold && !this.activeObj.textSettings.italic) {\n                    fontStyleElem.setAttribute('style', '');\n                }\n                else if (this.activeObj.textSettings.bold && this.activeObj.textSettings.italic) {\n                    fontStyleElem.setAttribute('style', 'font-style: italic;font-weight: bold');\n                }\n                else if (this.activeObj.textSettings.bold) {\n                    fontStyleElem.setAttribute('style', 'font-weight: bold');\n                }\n                else {\n                    fontStyleElem.setAttribute('style', 'font-style: italic');\n                }\n            }\n            else {\n                if (!this.activeObj.textSettings.bold && !this.activeObj.textSettings.italic) {\n                    fontStyleElem.textContent = 'Default';\n                }\n                else if (this.activeObj.textSettings.bold && this.activeObj.textSettings.italic) {\n                    fontStyleElem.textContent = 'Bold Italic';\n                }\n                else if (this.activeObj.textSettings.bold) {\n                    fontStyleElem.textContent = 'Bold';\n                }\n                else {\n                    fontStyleElem.textContent = 'Italic';\n                }\n            }\n        }\n        if (strokeWidthElem) {\n            var strokeWidth = Math.round((this.activeObj.strokeSettings.strokeWidth)).toString();\n            strokeWidthElem.textContent = this.getStrokeWidth(strokeWidth);\n        }\n    };\n    ImageEditor.prototype.setTimer = function (e) {\n        if (!this.isTimer && this.timer > 10) {\n            this.findTextPoint(e);\n            if (Browser.isDevice) {\n                this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n            }\n        }\n    };\n    // eslint-disable-next-line\n    ImageEditor.prototype.targetTouches = function (touches) {\n        var p1 = { x: touches[0].pageX, y: touches[0].pageY };\n        var p2 = { x: touches[1].pageX, y: touches[1].pageY };\n        var points = [p1, p2];\n        return points;\n    };\n    ImageEditor.prototype.calculateScale = function (startTouches, endTouches) {\n        var startDistance = this.getDistance(startTouches[0], startTouches[1]);\n        var endDistance = this.getDistance(endTouches[0], endTouches[1]);\n        return endDistance / startDistance;\n    };\n    ImageEditor.prototype.getDistance = function (a, b) {\n        var x = 0;\n        var y = 0;\n        if (!isNullOrUndefined(a) && !isNullOrUndefined(b)) {\n            x = a.x - b.x;\n            y = a.y - b.y;\n        }\n        return Math.sqrt(x * x + y * y);\n    };\n    ImageEditor.prototype.setXYPoints = function (e) {\n        e.preventDefault();\n        var x;\n        var y;\n        if (e.type === 'mousedown') {\n            x = e.clientX;\n            y = e.clientY;\n        }\n        else {\n            this.touchEndPoint.x = x = e.touches[0].clientX;\n            this.touchEndPoint.y = y = e.touches[0].clientY;\n        }\n        var bbox = this.lowerCanvas.getBoundingClientRect();\n        x -= bbox.left;\n        y -= bbox.top;\n        return { x: x, y: y };\n    };\n    ImageEditor.prototype.touchStartHandler = function (e) {\n        e.preventDefault();\n        if (e.touches.length === 2) {\n            this.isFirstMove = true;\n        }\n        else {\n            this.timer = setTimeout(this.setTimer.bind(this), 1000, e);\n            this.mouseDownEventHandler(e);\n        }\n        EventHandler.add(this.lowerCanvas, 'touchend', this.mouseUpEventHandler, this);\n        EventHandler.add(this.lowerCanvas, 'touchmove', this.mouseMoveEventHandler, this);\n        EventHandler.add(this.upperCanvas, 'touchend', this.mouseUpEventHandler, this);\n        EventHandler.add(this.upperCanvas, 'touchmove', this.mouseMoveEventHandler, this);\n    };\n    ImageEditor.prototype.isShapeTouch = function (e, isCropSelection) {\n        var isShape = false;\n        if (e.type === 'touchstart') {\n            this.redrawActObj();\n            var points = this.setXYPoints(e);\n            var x = points.x;\n            var y = points.y;\n            isShape = this.findTargetObj(x, y, isCropSelection);\n        }\n        return isShape;\n    };\n    ImageEditor.prototype.isFreehandDrawTouch = function (e, isCropSelection) {\n        var isFreehandDraw = false;\n        if (e.type === 'touchstart' && !isCropSelection) {\n            this.redrawActObj();\n            var points = this.setXYPoints(e);\n            var x = points.x;\n            var y = points.y;\n            this.setCursor(x, y);\n            if (this.isFreehandDrawingPoint) {\n                isFreehandDraw = true;\n            }\n        }\n        return isFreehandDraw;\n    };\n    ImageEditor.prototype.selectFreehandDraw = function (index) {\n        this.isFreehandDrawEditing = true;\n        if (!isNullOrUndefined(index) || index === 0) {\n            if (this.isFreehandDrawIndex(index)) {\n                this.freehandDrawSelectedIndex = this.freehandDrawHoveredIndex = index;\n                this.hoverFreehandraw();\n                this.upperCanvas.style.cursor = 'pointer';\n            }\n            else {\n                return;\n            }\n        }\n        this.freehandDrawSelectedIndex = this.freehandDrawHoveredIndex;\n        this.pointColl[this.freehandDrawSelectedIndex].isSelected = true;\n        this.freehandDrawSelectedId = this.pointColl[this.freehandDrawSelectedIndex].id;\n        if (this.pointColl[this.freehandDrawHoveredIndex].strokeColor !== '#42a5f5') {\n            this.tempFreeHandDrawEditingStyles.strokeColor = this.pointColl[this.freehandDrawHoveredIndex].strokeColor;\n        }\n        this.tempFreeHandDrawEditingStyles.strokeWidth = this.pointColl[this.freehandDrawHoveredIndex].strokeWidth;\n        if (this.isFreehandDrawEditing) {\n            this.refreshToolbar('pen');\n        }\n        else {\n            this.okBtn();\n        }\n    };\n    ImageEditor.prototype.closeContextualToolbar = function () {\n        var isContextualToolbar = false;\n        if ((!isNullOrUndefined(this.element.querySelector('#' + this.element.id + '_contextualToolbar')) &&\n            !this.element.querySelector('#' + this.element.id + '_contextualToolbar').parentElement.classList.contains('e-hide')) ||\n            (!isNullOrUndefined(this.element.querySelector('#' + this.element.id + '_headWrapper'))\n                && !this.element.querySelector('#' + this.element.id + '_headWrapper').parentElement.classList.contains('e-hide'))) {\n            this.element.querySelector('.e-contextual-toolbar-wrapper').classList.add('e-hide');\n            this.okBtn();\n            this.refreshToolbar('main');\n            isContextualToolbar = true;\n        }\n        return isContextualToolbar;\n    };\n    ImageEditor.prototype.mouseDownEventHandler = function (e) {\n        if (e.type === 'touchstart') {\n            this.isTouch = true;\n        }\n        if (e.type === 'touchstart' && e.currentTarget === this.lowerCanvas && !this.isImageLoaded) {\n            return;\n        }\n        var isCropSelection = false;\n        var splitWords;\n        var isPan = true;\n        if (this.activeObj.shape !== undefined) {\n            splitWords = this.activeObj.shape.split('-');\n        }\n        if (splitWords !== undefined && splitWords[0] === 'crop') {\n            isCropSelection = true;\n        }\n        if (isCropSelection) {\n            this.dragCanvas = this.togglePan = true;\n        }\n        if (isCropSelection && this.dragCanvas) {\n            var points = this.setXYPoints(e);\n            var x = points.x;\n            var y = points.y;\n            this.setCursor(x, y);\n            if (this.upperCanvas.style.cursor !== 'move' && this.upperCanvas.style.cursor !== 'crosshair' &&\n                this.upperCanvas.style.cursor !== 'default' && this.upperCanvas.style.cursor !== 'grab') {\n                isPan = false;\n            }\n        }\n        var isShape = this.isShapeTouch(e, isCropSelection);\n        var isFreehandDraw = this.isFreehandDrawTouch(e, isCropSelection);\n        if (!isShape && !this.togglePen && !isCropSelection) {\n            this.refreshToolbar('main');\n            this.closeContextualToolbar();\n        }\n        if (this.dragCanvas && isPan && (this.upperCanvas.style.cursor === 'grab' || this.isTouch)\n            && !isShape && !isFreehandDraw && !this.togglePen) {\n            if (this.isFreehandDrawEditing) {\n                this.applyFreehandDraw();\n            }\n            this.applyShape();\n            this.canvasMouseDownHandler(e);\n        }\n        else {\n            var points = this.setXYPoints(e);\n            var x = points.x;\n            var y = points.y;\n            this.redrawActObj(x, y);\n            if (this.isFreehandDrawingPoint || (this.isFreehandDrawCustomized && !this.togglePen)) {\n                if (!isNullOrUndefined(this.freehandDrawSelectedIndex) &&\n                    this.freehandDrawSelectedIndex !== this.freehandDrawHoveredIndex) {\n                    var tempHoveredIndex = this.freehandDrawHoveredIndex;\n                    this.okBtn();\n                    this.isFreehandDrawCustomized = false;\n                    this.freehandDrawHoveredIndex = tempHoveredIndex;\n                    if (this.freehandDrawHoveredIndex > -1) {\n                        var strokeColor = this.pointColl[this.freehandDrawHoveredIndex].strokeColor === '#fff' ? '#42a5f5' : this.pointColl[this.freehandDrawHoveredIndex].strokeColor;\n                        this.hoverFreehandraw(strokeColor, this.pointColl[this.freehandDrawHoveredIndex].strokeWidth);\n                    }\n                }\n                if (!isNullOrUndefined(this.freehandDrawHoveredIndex) && this.freehandDrawHoveredIndex > -1) {\n                    this.selectFreehandDraw();\n                }\n                else if (this.freehandDrawSelectedIndex) {\n                    this.okBtn();\n                    var strokeColor = this.pointColl[this.freehandDrawSelectedIndex].strokeColor;\n                    this.hoverFreehandraw(strokeColor, this.pointColl[this.freehandDrawSelectedIndex].strokeWidth);\n                }\n            }\n            else {\n                if (this.isFreehandDrawEditing) {\n                    this.cancelFreehandDraw();\n                }\n                this.closeContextualToolbar();\n                this.isFreehandDrawEditing = false;\n                if (this.upperCanvas.style.cursor === 'crosshair' || (Browser.isDevice && this.togglePen)) {\n                    if (this.togglePen) {\n                        if (isNullOrUndefined(this.activeObj.strokeSettings)) {\n                            this.activeObj.strokeSettings = this.strokeSettings;\n                        }\n                        if (isNullOrUndefined(this.penStrokeWidth)) {\n                            this.penStrokeWidth = 2;\n                        }\n                        this.upperContext.strokeStyle = this.activeObj.strokeSettings.strokeColor;\n                        this.upperContext.fillStyle = this.activeObj.strokeSettings.strokeColor;\n                        this.freehandDownHandler(e, this.upperCanvas); // To handle Freehand drawing\n                    }\n                    else {\n                        this.refreshActiveObj();\n                        this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n                    }\n                    this.currObjType.isActiveObj = false;\n                    this.dragElement = '';\n                    this.dragPoint.startX = this.dragPoint.startY = this.dragPoint.endX = this.dragPoint.endY = 0;\n                }\n                if ((this.upperCanvas.style.cursor !== 'crosshair' && e.type.toLowerCase() === 'touchstart') ||\n                    (this.currObjType.isActiveObj && this.upperCanvas.style.cursor !== 'default' && !this.togglePen)) {\n                    if (this.currObjType.isUndoAction) {\n                        this.refreshUndoRedoColl();\n                    }\n                    this.findTarget(x, y, e.type);\n                }\n                else if ((this.currObjType.shape === '' || this.currObjType.isCustomCrop) && !this.togglePen && this.upperCanvas.style.cursor !== 'default') {\n                    this.setActivePoint(x, y);\n                }\n                if (!isNullOrUndefined(this.activeObj)) {\n                    var isCropSelection_1 = false;\n                    var splitWords_1;\n                    if (this.activeObj.shape !== undefined) {\n                        splitWords_1 = this.activeObj.shape.split('-');\n                    }\n                    if (splitWords_1 === undefined && (this.currObjType.isCustomCrop || this.togglePen)) {\n                        isCropSelection_1 = true;\n                    }\n                    else if (splitWords_1 !== undefined && splitWords_1[0] === 'crop') {\n                        isCropSelection_1 = true;\n                    }\n                    if ((this.activeObj.shape === 'rectangle') || (this.activeObj.shape === 'ellipse')\n                        || (this.activeObj.shape === 'line')) {\n                        this.refreshToolbar('shapes');\n                    }\n                    else if (this.activeObj.shape === 'text') {\n                        this.refreshToolbar('text');\n                    }\n                    else if (!isCropSelection_1) {\n                        this.callMainToolbar();\n                    }\n                    this.updateToolbarItems();\n                }\n            }\n        }\n        this.isShapeInserted = false;\n        this.tempActiveObj = extend({}, this.activeObj, {}, true);\n    };\n    ImageEditor.prototype.mouseMoveEventHandler = function (e) {\n        e.preventDefault();\n        if (e.type === 'touchmove' && e.touches.length === 2) {\n            if (this.isFirstMove) {\n                this.startTouches = this.targetTouches(e.touches);\n                this.tempTouches = [];\n                this.tempTouches.push({ x: e.touches[0].clientX || (e.touches[0].pageX - this.lowerCanvas.offsetLeft),\n                    y: e.touches[0].clientY || (e.touches[0].pageY - this.lowerCanvas.offsetTop) });\n                this.tempTouches.push({ x: e.touches[1].clientX || (e.touches[1].pageX - this.lowerCanvas.offsetLeft),\n                    y: e.touches[1].clientY || (e.touches[1].pageY - this.lowerCanvas.offsetTop) });\n            }\n            else {\n                var firstFingerX = e.touches[0].clientX || (e.touches[0].pageX - this.lowerCanvas.offsetLeft);\n                var firstFingerY = e.touches[0].clientY || (e.touches[0].pageY - this.lowerCanvas.offsetTop);\n                var secondFingerX = e.touches[1].clientX || (e.touches[1].pageX - this.lowerCanvas.offsetLeft);\n                var secondFingerY = e.touches[1].clientY || (e.touches[1].pageY - this.lowerCanvas.offsetTop);\n                var scale = this.calculateScale(this.startTouches, this.targetTouches(e.touches));\n                // Need to set lastX and lastY points\n                if (this.tempTouches[0].x !== firstFingerX && this.tempTouches[0].y !== firstFingerY &&\n                    this.tempTouches[1].x !== secondFingerX && this.tempTouches[1].y !== secondFingerY) {\n                    if (scale > 1) {\n                        this.zoom(1.1);\n                    }\n                    else {\n                        this.zoom(-1.1);\n                    }\n                    this.tempTouches = [];\n                    this.tempTouches.push({ x: e.touches[0].clientX || (e.touches[0].pageX - this.lowerCanvas.offsetLeft),\n                        y: e.touches[0].clientY || (e.touches[0].pageY - this.lowerCanvas.offsetTop) });\n                    this.tempTouches.push({ x: e.touches[1].clientX || (e.touches[1].pageX - this.lowerCanvas.offsetLeft),\n                        y: e.touches[1].clientY || (e.touches[1].pageY - this.lowerCanvas.offsetTop) });\n                }\n            }\n            this.isFirstMove = false;\n            return;\n        }\n        if (this.textArea.style.display === 'none') {\n            this.isTimer = true;\n        }\n        var x;\n        var y;\n        if (e.type === 'mousemove') {\n            x = e.clientX;\n            y = e.clientY;\n        }\n        else {\n            this.touchEndPoint.x = x = e.touches[0].clientX;\n            this.touchEndPoint.y = y = e.touches[0].clientY;\n        }\n        var bbox = this.lowerCanvas.getBoundingClientRect();\n        x -= bbox.left;\n        y -= bbox.top;\n        this.canvasMouseMoveHandler(e);\n        var isCropSelection = false;\n        var splitWords;\n        if (this.activeObj.shape !== undefined) {\n            splitWords = this.activeObj.shape.split('-');\n        }\n        if (splitWords !== undefined && splitWords[0] === 'crop') {\n            isCropSelection = true;\n        }\n        if (isCropSelection && this.zoomFactor > 0) {\n            this.disableZoomOutBtn();\n        }\n        if (this.currObjType.isActiveObj && (this.activeObj.activePoint !== undefined || this.objColl.length > 0) &&\n            !this.dragCanvas || this.activeObj.activePoint !== undefined) {\n            if (this.dragElement === '') {\n                this.setCursor(x, y);\n                if ((!isNullOrUndefined(this.activeObj.activePoint) && this.activeObj.activePoint.width === 0) && this.upperCanvas.style.cursor !== 'default' &&\n                    this.upperCanvas.style.cursor !== 'move' && this.upperCanvas.style.cursor !== 'crosshair'\n                    && this.upperCanvas.style.cursor !== 'grab' && this.upperCanvas.style.cursor !== 'pointer') {\n                    this.upperCanvas.style.cursor = 'move';\n                }\n                this.findTarget(x, y, e.type);\n            }\n        }\n        if (this.currObjType.isDragging) {\n            this.upperContext.clearRect(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n            this.updateActivePoint(x, y, isCropSelection);\n            if (this.isPreventDragging) {\n                if ((this.activeObj.activePoint.startX > this.destLeft) &&\n                    (this.activeObj.activePoint.endX < this.destLeft + this.destWidth) && (this.activeObj.activePoint.startY > this.destTop)\n                    && (this.activeObj.activePoint.endY < this.destTop + this.destHeight)) {\n                    this.isPreventDragging = false;\n                }\n                this.drawObject('duplicate', null, null, null, true);\n            }\n            else {\n                this.drawObject('duplicate');\n            }\n            if (isCropSelection) {\n                this.dragCanvas = this.togglePan = true;\n            }\n        }\n    };\n    ImageEditor.prototype.mouseUpEventHandler = function (e) {\n        if (e.type === 'touchstart') {\n            this.isTouch = false;\n        }\n        e.preventDefault();\n        if (this.togglePan) {\n            this.canvasMouseUpHandler(e);\n        }\n        var x;\n        var y;\n        if (e.type === 'mouseup') {\n            x = e.clientX;\n            y = e.clientY;\n        }\n        else {\n            x = this.touchEndPoint.x;\n            y = this.touchEndPoint.y;\n        }\n        var bbox = this.lowerCanvas.getBoundingClientRect();\n        x -= bbox.left;\n        y -= bbox.top;\n        if (e.type === 'touchend') {\n            this.startTouches = this.tempTouches = [];\n            this.isFirstMove = false;\n            if (this.textArea.style.display === 'none') {\n                this.isTimer = false;\n                this.timer = 0;\n            }\n        }\n        var isCropSelection = false;\n        var splitWords;\n        if (this.activeObj.shape !== undefined) {\n            splitWords = this.activeObj.shape.split('-');\n        }\n        if (splitWords !== undefined && splitWords[0] === 'crop') {\n            isCropSelection = true;\n        }\n        if (e.currentTarget === this.upperCanvas) {\n            this.currObjType.shape = this.currObjType.shape.toLowerCase();\n            var prevCropObj = extend({}, this.cropObj, {}, true);\n            var prevObj = this.getCurrentObj();\n            prevObj.objColl = extend([], this.objColl, [], true);\n            prevObj.pointColl = extend([], this.pointColl, [], true);\n            prevObj.afterCropActions = extend([], this.afterCropActions, [], true);\n            if (!this.togglePen && !isCropSelection) {\n                if (!isNullOrUndefined(this.tempObjColl) && this.activeObj.activePoint.width !== 0) {\n                    this.objColl.push(this.activeObj);\n                    if (JSON.stringify(this.activeObj.activePoint) !== JSON.stringify(this.tempActiveObj.activePoint)) {\n                        this.updateUndoRedoColl('shapeTransform', prevObj, this.tempObjColl, prevObj.pointColl, prevCropObj);\n                    }\n                    this.redrawShape(this.objColl[this.objColl.length - 1]);\n                    this.tempObjColl = undefined;\n                }\n                if (!this.isFreehandDrawEditing) {\n                    this.applyCurrActObj(x, y);\n                }\n            }\n            else if (isCropSelection && !this.togglePen) {\n                if (JSON.stringify(this.activeObj.activePoint) !== JSON.stringify(this.tempActiveObj.activePoint)) {\n                    prevObj.activeObj = extend([], this.tempActiveObj, {}, true);\n                    this.updateUndoRedoColl('selectionTransform', prevObj, prevObj.objColl, prevObj.pointColl, prevCropObj);\n                }\n            }\n        }\n        if (this.togglePen && e.currentTarget === this.upperCanvas) {\n            this.freehandUpHandler(e, this.upperCanvas, this.upperContext);\n        }\n        else {\n            this.currObjType.shape = '';\n        }\n        this.dragElement = '';\n        this.currObjType.isInitialLine = this.currObjType.isDragging = false;\n        this.oldPoint.x = undefined;\n        this.oldPoint.y = undefined;\n    };\n    ImageEditor.prototype.keyDownEventHandler = function (e) {\n        var _this = this;\n        var shapeChangingArgs = {};\n        var previousShapeSettings = {};\n        var beforeSave = { fileName: this.fileName, fileType: this.fileType, cancel: false };\n        var splitWords;\n        switch (e.key) {\n            case (e.ctrlKey && 's'):\n                this.trigger('beforeSave', beforeSave, function (observableSaveArgs) {\n                    if (!beforeSave.cancel) {\n                        _this.export(observableSaveArgs.fileType, observableSaveArgs.fileName);\n                    }\n                });\n                e.preventDefault();\n                e.stopImmediatePropagation();\n                break;\n            // case (e.ctrlKey && 'z'):\n            //     if (this.allowUndoRedo) {\n            //         this.callUndo();\n            //     }\n            //     break;\n            // case (e.ctrlKey && 'y'):\n            //     if (this.allowUndoRedo) {\n            //         this.callRedo();\n            //     }\n            //     break;\n            case 'Delete':\n                if (this.isFreehandDrawEditing) {\n                    this.updateFreehandDrawColorChange();\n                    var prevCropObj = extend({}, this.cropObj, {}, true);\n                    var prevObj = this.getCurrentObj();\n                    prevObj.objColl = extend([], this.objColl, [], true);\n                    prevObj.pointColl = extend([], this.pointColl, [], true);\n                    prevObj.afterCropActions = extend([], this.afterCropActions, [], true);\n                    this.deleteFreehandDraw(parseInt(this.freehandDrawSelectedId.split('_')[1], 10) - 1, true);\n                    this.updateUndoRedoColl('deleteFreehandDrawing', prevObj, prevObj.objColl, prevObj.pointColl, prevCropObj);\n                }\n                else if (this.textArea.style.display === 'none') {\n                    this.objColl.push(this.activeObj);\n                    var prevCropObj = extend({}, this.cropObj, {}, true);\n                    var prevObj = this.getCurrentObj();\n                    prevObj.objColl = extend([], this.objColl, [], true);\n                    prevObj.pointColl = extend([], this.pointColl, [], true);\n                    prevObj.afterCropActions = extend([], this.afterCropActions, [], true);\n                    this.objColl.pop();\n                    previousShapeSettings = this.updatePreviousShapeSettings();\n                    shapeChangingArgs = { action: 'delete', previousShapeSettings: previousShapeSettings, currentShapeSettings: null };\n                    this.keyHistory = '';\n                    this.clearSelection();\n                    this.trigger('shapeChanging', shapeChangingArgs);\n                    this.refreshToolbar('main');\n                    this.updateUndoRedoColl('deleteObj', prevObj, prevObj.objColl, prevObj.pointColl, prevCropObj);\n                }\n                break;\n            case 'Escape':\n                if (this.togglePan) {\n                    this.refreshToolbar(this.currentToolbar);\n                    this.pan(false);\n                }\n                else if (this.textArea.style.display === 'block') {\n                    this.redrawActObj();\n                }\n                else {\n                    this.performCancel();\n                }\n                break;\n            case 'Enter':\n                if (this.activeObj.shape !== undefined) {\n                    splitWords = this.activeObj.shape.split('-');\n                }\n                if (this.activeObj.horTopLine !== undefined && (this.activeObj.shape !== undefined && splitWords[0] === 'crop')) {\n                    this.crop();\n                }\n                break;\n            default:\n                if (Browser.isDevice && this.textArea.style.display === 'block') {\n                    setTimeout(this.textKeyDown.bind(this), 1, e);\n                }\n                break;\n        }\n    };\n    ImageEditor.prototype.keyUpEventHandler = function (e) {\n        // eslint-disable-next-line\n        if (this.textArea.style.display === 'block' && e.target.id === this.element.id + '_textArea') {\n            setTimeout(this.textKeyDown.bind(this), 1, e);\n        }\n    };\n    ImageEditor.prototype.canvasMouseDownHandler = function (e) {\n        e.preventDefault();\n        var x;\n        var y;\n        if (e.type === 'mousedown') {\n            x = e.offsetX || (e.pageX - this.lowerCanvas.offsetLeft);\n            y = e.offsetY || (e.pageY - this.lowerCanvas.offsetTop);\n        }\n        else {\n            x = e.touches[0].clientX || (e.touches[0].pageX - this.lowerCanvas.offsetLeft);\n            y = e.touches[0].clientY || (e.touches[0].pageY - this.lowerCanvas.offsetTop);\n        }\n        var bbox = this.lowerCanvas.getBoundingClientRect();\n        x -= bbox.left;\n        y -= bbox.top;\n        this.panDown = { x: x, y: y };\n        this.lastPan = { x: this.destLeft, y: this.destTop };\n        if (isNullOrUndefined(this.tempPanMove)) {\n            this.tempPanMove = { x: x, y: y };\n            this.panStartObj = this.getCurrentObj();\n            this.panStartObj.objColl = extend([], this.objColl, [], true);\n            this.panStartObj.pointColl = extend([], this.pointColl, [], true);\n            this.panStartObj.afterCropActions = this.afterCropActions;\n        }\n    };\n    ImageEditor.prototype.canvasMouseMoveHandler = function (e) {\n        if (this.dragCanvas) {\n            this.lowerCanvas.style.cursor = 'grab';\n        }\n        else {\n            this.dragCanvas = this.togglePan = false;\n            this.lowerCanvas.style.cursor = this.upperCanvas.style.cursor = 'default';\n        }\n        var x;\n        var y;\n        if (e.type === 'mousemove') {\n            x = e.offsetX || (e.pageX - this.lowerCanvas.offsetLeft);\n            y = e.offsetY || (e.pageY - this.lowerCanvas.offsetTop);\n        }\n        else {\n            x = e.touches[0].clientX || (e.touches[0].pageX - this.lowerCanvas.offsetLeft);\n            y = e.touches[0].clientY || (e.touches[0].pageY - this.lowerCanvas.offsetTop);\n        }\n        var bbox = this.lowerCanvas.getBoundingClientRect();\n        x -= bbox.left;\n        y -= bbox.top;\n        this.panMove = { x: x, y: y };\n        if (this.panDown && this.panMove && this.togglePan && this.dragCanvas) {\n            this.drawPannedImage();\n        }\n    };\n    ImageEditor.prototype.canvasMouseUpHandler = function (e) {\n        e.preventDefault();\n        if (this.togglePan) {\n            if (this.panDown && this.panMove && this.togglePan && this.dragCanvas) {\n                var prevCropObj = extend({}, this.cropObj, {}, true);\n                this.updateUndoRedoColl('pan', this.panStartObj, this.panStartObj.objColl, this.panStartObj.pointColl, prevCropObj);\n                this.panDown = null;\n                this.panMove = null;\n                this.tempPanMove = null;\n                this.panStartObj = null;\n            }\n        }\n        this.currObjType.isDragging = false;\n    };\n    ImageEditor.prototype.handleScroll = function (e) {\n        var x;\n        var y;\n        var isInsideCanvas = false;\n        if (e.type === 'mousewheel') {\n            // eslint-disable-next-line\n            x = e.clientX;\n            y = e.clientY;\n        }\n        var bbox = this.lowerCanvas.getBoundingClientRect();\n        x -= bbox.left;\n        y -= bbox.top;\n        if (x > this.destLeft && x < this.destLeft + this.destWidth && y > this.destTop && y < this.destTop + this.destHeight) {\n            isInsideCanvas = true;\n        }\n        if (e.ctrlKey === true && isInsideCanvas) {\n            e.preventDefault();\n        }\n    };\n    ImageEditor.prototype.textKeyDown = function (e) {\n        if (String.fromCharCode(e.which) === '\\r') {\n            this.textRow += 1;\n        }\n        this.textArea.setAttribute('rows', this.textRow.toString());\n        this.textArea.style.height = 'auto';\n        this.textArea.style.height = this.textArea.scrollHeight + 'px';\n        this.setTextBoxWidth(e);\n        if (Browser.isDevice) {\n            this.textArea.style.width = parseFloat(this.textArea.style.width) + this.textArea.style.fontSize + 'px';\n        }\n        var rows = this.textArea.value.split('\\n');\n        this.textRow = rows.length;\n        this.textArea.setAttribute('rows', this.textRow.toString());\n    };\n    ImageEditor.prototype.adjustToScreen = function () {\n        // eslint-disable-next-line @typescript-eslint/no-this-alias\n        var proxy = this;\n        if ((!isNullOrUndefined(this.element.querySelector('#' + this.element.id + '_contextualToolbar')) &&\n            !this.element.querySelector('#' + this.element.id + '_contextualToolbar').parentElement.classList.contains('e-hide')) ||\n            (!isNullOrUndefined(this.element.querySelector('#' + this.element.id + '_headWrapper'))\n                && !this.element.querySelector('#' + this.element.id + '_headWrapper').parentElement.classList.contains('e-hide'))) {\n            this.element.querySelector('.e-contextual-toolbar-wrapper').classList.add('e-hide');\n            this.okBtn();\n            this.refreshToolbar('main');\n        }\n        var splitWords;\n        var isSelectionCrop = false;\n        if (this.activeObj.shape !== undefined) {\n            splitWords = this.activeObj.shape.split('-');\n        }\n        if (splitWords !== undefined && splitWords[0] === 'crop') {\n            isSelectionCrop = true;\n            this.updateImageRatioForActObj();\n            this.objColl.push(this.activeObj);\n            this.refreshActiveObj();\n        }\n        if (this.textArea.style.display === 'block') {\n            this.redrawActObj();\n        }\n        var tempFilter = this.lowerContext.filter;\n        this.update();\n        this.applyActObj();\n        this.refreshActiveObj();\n        this.lowerContext.filter = this.initialAdjustmentValue = tempFilter;\n        if (this.isImageLoaded) {\n            showSpinner(this.element);\n            this.element.style.opacity = '0.5';\n        }\n        this.lowerContext.clearRect(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n        this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n        var canvasWrapper = document.querySelector('#' + this.element.id + '_canvasWrapper');\n        if (!isNullOrUndefined(canvasWrapper)) {\n            canvasWrapper.style.width = this.element.offsetWidth + 'px';\n            canvasWrapper.style.height = this.element.offsetHeight + 'px';\n            if (Browser.isDevice) {\n                canvasWrapper.style.height = (parseFloat(canvasWrapper.style.height) - (2 * this.toolbarHeight)) - 3 + 'px';\n            }\n            else {\n                canvasWrapper.style.height = (parseFloat(canvasWrapper.style.height) - this.toolbarHeight) - 3 + 'px';\n            }\n        }\n        var maxDimension = this.calcMaxDimension(this.srcWidth, this.srcHeight);\n        if (this.defaultZoomFactor > 0) {\n            maxDimension.width += (maxDimension.width * this.defaultZoomFactor);\n            maxDimension.height += (maxDimension.height * this.defaultZoomFactor);\n        }\n        this.destLeft = (this.lowerCanvas.clientWidth - maxDimension.width) / 2;\n        this.destTop = (this.lowerCanvas.clientHeight - maxDimension.height) / 2;\n        if (this.degree === 0 && this.currFlipState === '') {\n            if (this.defaultZoomFactor > 0) {\n                this.destLeft += this.totalPannedPoint.x;\n                this.destTop += this.totalPannedPoint.y;\n            }\n            this.drawImgToCanvas(maxDimension);\n        }\n        else {\n            this.drawImgToCanvas(maxDimension);\n            this.updateCurrentTransformedState('initial');\n            var temp = this.lowerContext.filter;\n            this.updateBrightnessFilter();\n            this.lowerContext.drawImage(this.baseImg, this.srcLeft, this.srcTop, this.srcWidth, this.srcHeight, this.destLeft, this.destTop, this.destWidth, this.destHeight);\n            this.lowerContext.filter = temp;\n            this.updateCurrentTransformedState('reverse');\n        }\n        this.zoomObjColl();\n        this.zoomFreehandDrawColl();\n        if (this.isCircleCrop) {\n            this.cropCircle(this.lowerContext);\n        }\n        hideSpinner(this.element);\n        this.element.style.opacity = '1';\n        if (this.defToolbarItems.length > 0 && (!isNullOrUndefined(document.getElementById(this.element.id + '_toolbar')))) {\n            /* eslint-disable-next-line @typescript-eslint/no-explicit-any */\n            var toolbar_10 = getComponent(proxy.element.id + '_toolbar', 'toolbar');\n            toolbar_10.refreshOverflow();\n            if (!isNullOrUndefined(this.element.querySelector('.e-contextual-toolbar-wrapper'))) {\n                this.element.querySelector('.e-contextual-toolbar-wrapper').classList.add('e-hide');\n            }\n        }\n        this.refreshActiveObj();\n        this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n        if (isSelectionCrop) {\n            this.activeObj = extend({}, this.objColl[this.objColl.length - 1], null, true);\n            this.objColl.pop();\n            this.drawObject('duplicate', this.activeObj);\n        }\n        if ((this.degree !== 0 || this.currFlipState !== '') && this.defaultZoomFactor > 0) {\n            var totalPannedPoint = extend({}, this.totalPannedPoint, null, true);\n            var totalPannedInternalPoint = extend({}, this.totalPannedInternalPoint, null, true);\n            var totalPannedClientPoint = extend({}, this.totalPannedClientPoint, null, true);\n            this.zoom(.1);\n            this.zoom(-.1);\n            if (this.degree === 0) {\n                this.destLeft += totalPannedPoint.x;\n                this.destTop += totalPannedPoint.y;\n                this.totalPannedPoint = totalPannedPoint;\n                this.updateFlipPan();\n            }\n            else {\n                this.totalPannedInternalPoint = totalPannedInternalPoint;\n                this.totalPannedClientPoint = totalPannedClientPoint;\n                this.currentPannedPoint = { x: 0, y: 0 };\n                this.isCropTab = true;\n                this.rotatePan();\n                this.isCropTab = false;\n            }\n        }\n        else if (this.degree !== 0 && this.cropZoomFactor > 0) {\n            this.zoomFactor = this.cropZoomFactor = 0;\n            this.enableDisableToolbarBtn();\n        }\n    };\n    ImageEditor.prototype.screenOrientation = function () {\n        if (Browser.isDevice) {\n            setTimeout(this.adjustToScreen.bind(this), 100);\n        }\n    };\n    ImageEditor.prototype.windowResizeHandler = function () {\n        if (!Browser.isDevice) {\n            this.adjustToScreen();\n        }\n    };\n    ImageEditor.prototype.updatePreviousShapeSettings = function () {\n        var fontStyle = [];\n        if (this.activeObj.shape === 'text' && !isNullOrUndefined(this.activeObj.textSettings)) {\n            if (this.activeObj.textSettings.bold) {\n                fontStyle.push('bold');\n            }\n            if (this.activeObj.textSettings.italic) {\n                fontStyle.push('italic');\n            }\n            if (this.activeObj.textSettings.underline) {\n                fontStyle.push('underline');\n            }\n        }\n        return { id: !isNullOrUndefined(this.activeObj.currIndex) ? this.activeObj.currIndex : null,\n            type: this.toPascalCase(this.activeObj.shape),\n            startX: this.activeObj.activePoint.startX, startY: this.activeObj.activePoint.startY,\n            width: this.activeObj.activePoint.width, height: this.activeObj.activePoint.height,\n            strokeColor: !isNullOrUndefined(this.activeObj.strokeSettings) ? this.activeObj.strokeSettings.strokeColor : null,\n            strokeWidth: !isNullOrUndefined(this.activeObj.strokeSettings) ? this.activeObj.strokeSettings.strokeWidth : null,\n            fillColor: !isNullOrUndefined(this.activeObj.strokeSettings) ? this.activeObj.strokeSettings.fillColor : null,\n            radius: this.activeObj.shape === 'ellipse' ? this.activeObj.activePoint.width / 2 : null,\n            length: this.activeObj.shape === 'line' ? this.activeObj.activePoint.width : null,\n            text: this.activeObj.shape === 'text' ? (!isNullOrUndefined(this.activeObj.keyHistory) ? this.activeObj.keyHistory : null) : null,\n            fontSize: this.activeObj.shape === 'text' ? (!isNullOrUndefined(this.activeObj.textSettings) ? this.activeObj.textSettings.fontSize : null) : null,\n            fontStyle: this.activeObj.shape === 'text' ? fontStyle : null,\n            color: this.activeObj.shape === 'text' ? (!isNullOrUndefined(this.activeObj.strokeSettings) ? this.activeObj.strokeSettings.strokeColor : null) : null\n        };\n    };\n    ImageEditor.prototype.disableZoomOutBtn = function () {\n        var isDisabled = false;\n        var zoomOut = document.querySelector('#' + this.element.id + '_zoomOut');\n        var destLeft = this.destLeft;\n        var destTop = this.destTop;\n        var destWidth = this.destWidth;\n        var destHeight = this.destHeight;\n        if (this.degree === 0 || this.degree === 180) {\n            if (!isNullOrUndefined(this.activeObj.shape)) {\n                this.setZoomDimension(-0.1, this.activeObj);\n                if (this.destLeft > this.activeObj.activePoint.startX || this.destTop > this.activeObj.activePoint.startY ||\n                    this.destLeft + this.destWidth < this.activeObj.activePoint.endX || this.destTop + this.destHeight <\n                    this.activeObj.activePoint.endY) {\n                    zoomOut.classList.add('e-disabled');\n                    zoomOut.parentElement.classList.add('e-overlay');\n                    isDisabled = true;\n                }\n                else {\n                    zoomOut.classList.remove('e-disabled');\n                    zoomOut.parentElement.classList.remove('e-overlay');\n                    isDisabled = false;\n                }\n            }\n            else {\n                this.setZoomDimension(-0.1, null);\n            }\n        }\n        this.destLeft = destLeft;\n        this.destTop = destTop;\n        this.destWidth = destWidth;\n        this.destHeight = destHeight;\n        return isDisabled;\n    };\n    ImageEditor.prototype.setZoomDimension = function (value, selectionObj) {\n        var maxDimension = { width: 0, height: 0 };\n        if (this.degree % 90 === 0 && this.degree % 180 !== 0) {\n            maxDimension = this.calcMaxDimension(this.srcHeight, this.srcWidth);\n        }\n        else {\n            maxDimension = this.calcMaxDimension(this.srcWidth, this.srcHeight);\n        }\n        maxDimension.width += (maxDimension.width * this.zoomFactor);\n        maxDimension.height += (maxDimension.height * this.zoomFactor);\n        this.destLeft += ((this.destWidth - maxDimension.width) / 2);\n        this.destTop += ((this.destHeight - maxDimension.height) / 2);\n        // While zoom out limit image to draw inside the selection range\n        if (value < 0 && !isNullOrUndefined(selectionObj)) {\n            if (this.destLeft > selectionObj.activePoint.startX) {\n                this.destLeft = selectionObj.activePoint.startX;\n            }\n            if (this.destTop > selectionObj.activePoint.startY) {\n                this.destTop = selectionObj.activePoint.startY;\n            }\n            if (this.destLeft + maxDimension.width < selectionObj.activePoint.startX + selectionObj.activePoint.width) {\n                this.destLeft = this.destLeft + (selectionObj.activePoint.startX + selectionObj.activePoint.width) -\n                    (this.destLeft + maxDimension.width);\n            }\n            if (this.destTop + maxDimension.height < selectionObj.activePoint.startY + selectionObj.activePoint.height) {\n                this.destTop = this.destTop + (selectionObj.activePoint.startY + selectionObj.activePoint.height) -\n                    (this.destTop + maxDimension.height);\n            }\n        }\n        else if (value < 0 && isNullOrUndefined(selectionObj)) {\n            if (this.destLeft > 0) {\n                this.destLeft = 0;\n            }\n            if (this.destTop > 0) {\n                this.destTop = 0;\n            }\n            if (this.destLeft + maxDimension.width < this.lowerCanvas.width) {\n                this.destLeft = this.lowerCanvas.width - this.destWidth;\n            }\n            if (this.destTop + maxDimension.height < this.lowerCanvas.height) {\n                this.destTop = this.lowerCanvas.height - this.destHeight;\n            }\n        }\n        return maxDimension;\n    };\n    ImageEditor.prototype.applyCurrActObj = function (x, y) {\n        var isInside = false;\n        var actObj = extend({}, this.activeObj, {}, true);\n        if (isNullOrUndefined(actObj.activePoint)) {\n            return;\n        }\n        if ((x >= Math.floor(actObj.activePoint.startX) && x <= Math.ceil(actObj.activePoint.endX) &&\n            y >= Math.floor(actObj.activePoint.startY) && y <= Math.ceil(actObj.activePoint.endY))) {\n            isInside = true;\n        }\n        if (!isInside) {\n            this.updateImageRatioForActObj();\n            if (this.activeObj.horTopLine !== undefined && this.activeObj.horTopLine.startX !== 0 && this.activeObj.horTopLine.endX !== 0\n                && !this.currObjType.isCustomCrop && this.currObjType.shape !== '') {\n                this.objColl.push(extend({}, this.activeObj, {}, true));\n            }\n            if (this.activeObj.shape === 'text' || (this.currObjType.shape === 'ellipse' || this.currObjType.shape === 'rectangle' ||\n                this.currObjType.shape === 'line')) {\n                var tempFilter = this.lowerContext.filter;\n                this.lowerContext.filter = this.getDefaultFilter();\n                for (var i = 0; i < this.objColl.length; i++) {\n                    if (this.isObjInsideCropRegion(this.objColl[i])) {\n                        this.apply(this.objColl[i].shape, this.objColl[i]);\n                        this.refreshActiveObj();\n                    }\n                }\n                this.zoomFreehandDrawColl();\n                this.lowerContext.filter = tempFilter;\n                this.apply('shape');\n                this.clearOuterCanvas(this.lowerContext);\n                this.clearOuterCanvas(this.upperContext);\n                if (this.isCircleCrop) {\n                    this.cropCircle(this.lowerContext);\n                }\n            }\n            this.refreshToolbar('main');\n        }\n    };\n    ImageEditor.prototype.updateTextFromTextArea = function () {\n        if (this.activeObj.keyHistory !== this.textArea.value) {\n            var prevCropObj = extend({}, this.cropObj, {}, true);\n            var prevObj = this.getCurrentObj();\n            prevObj.objColl = extend([], this.objColl, [], true);\n            prevObj.pointColl = extend([], this.pointColl, [], true);\n            prevObj.afterCropActions = extend([], this.afterCropActions, [], true);\n            this.updateUndoRedoColl('text', prevObj, prevObj.objColl, prevObj.pointColl, prevCropObj, this.activeObj.keyHistory, this.textArea.value);\n        }\n        this.activeObj.keyHistory = this.textArea.value;\n        this.textArea.style.display = 'none';\n        this.textArea.value = '';\n        this.updateFontStyles();\n        var width = this.upperContext.measureText(this.activeObj.keyHistory).width +\n            this.activeObj.textSettings.fontSize * 0.5;\n        var height = this.activeObj.textSettings.fontSize + this.activeObj.textSettings.fontSize * 0.25;\n        var rows = this.activeObj.keyHistory.split('\\n');\n        if (rows.length > 1) {\n            height *= rows.length;\n            var widthColl = [];\n            for (var i = 0; i < rows.length; i++) {\n                widthColl.push(this.upperContext.measureText(rows[i]).width +\n                    this.activeObj.textSettings.fontSize * 0.5);\n            }\n            width = Math.max.apply(Math, widthColl);\n        }\n        this.setTextSelection(width, height);\n        this.updateActiveObject(this.activeObj.activePoint, this.activeObj);\n        this.updateImageRatioForActObj();\n    };\n    ImageEditor.prototype.setTextBoxStylesToActObj = function () {\n        this.activeObj.textSettings.fontFamily = this.textArea.style.fontFamily;\n        this.activeObj.strokeSettings.strokeColor = this.textArea.style.color;\n        if (this.textArea.style.fontWeight === 'bold') {\n            this.activeObj.textSettings.bold = true;\n        }\n        else {\n            this.activeObj.textSettings.bold = false;\n        }\n        if (this.textArea.style.fontStyle === 'italic') {\n            this.activeObj.textSettings.italic = true;\n        }\n        else {\n            this.activeObj.textSettings.italic = false;\n        }\n        this.activeObj.textSettings.fontSize = (parseFloat(this.textArea.style.fontSize));\n    };\n    ImageEditor.prototype.redrawActObj = function (x, y) {\n        var splitWords;\n        if (this.activeObj.shape !== undefined) {\n            splitWords = this.activeObj.shape.split('-');\n        }\n        if (this.activeObj.horTopLine !== undefined && (this.activeObj.shape !== undefined && splitWords[0] !== 'crop')) {\n            if (this.textArea.style.display === 'block') {\n                this.setTextBoxStylesToActObj();\n                this.updateFontRatio(this.activeObj, true);\n                if (x && y) {\n                    if ((x !== this.activeObj.activePoint.startX) && (y !== this.activeObj.activePoint.startY)) {\n                        this.updateTextFromTextArea();\n                        this.applyActObj();\n                    }\n                }\n                else {\n                    this.updateTextFromTextArea();\n                    this.apply(this.activeObj.shape, this.activeObj);\n                    this.objColl.push(this.activeObj);\n                    this.refreshActiveObj();\n                    this.textArea.style.transform = '';\n                    this.refreshToolbar('main');\n                }\n            }\n            else {\n                this.applyActObj();\n            }\n        }\n    };\n    ImageEditor.prototype.setTextBoxPos = function (actObj, degree, flip, x, y) {\n        var point = { x: x, y: y };\n        if (degree === 0) {\n            if (flip.toLowerCase() === 'horizontal') {\n                point.x = actObj.activePoint.endX;\n                point.y = actObj.activePoint.startY;\n            }\n            else if (flip.toLowerCase() === 'vertical') {\n                point.x = actObj.activePoint.startX;\n                point.y = actObj.activePoint.endY;\n            }\n            else {\n                point.x = actObj.activePoint.startX;\n                point.y = actObj.activePoint.startY;\n            }\n        }\n        else if (degree === 90) {\n            if (flip.toLowerCase() === 'horizontal') {\n                point.x = actObj.activePoint.startX;\n                point.y = actObj.activePoint.startY;\n            }\n            else if (flip.toLowerCase() === 'vertical') {\n                point.x = actObj.activePoint.endX;\n                point.y = actObj.activePoint.endY;\n            }\n            else {\n                point.x = actObj.activePoint.endX;\n                point.y = actObj.activePoint.startY;\n            }\n        }\n        else if (degree === 180) {\n            if (flip.toLowerCase() === 'horizontal') {\n                point.x = actObj.activePoint.startX;\n                point.y = actObj.activePoint.endY;\n            }\n            else if (flip.toLowerCase() === 'vertical') {\n                point.x = actObj.activePoint.endX;\n                point.y = actObj.activePoint.startY;\n            }\n            else {\n                point.x = actObj.activePoint.endX;\n                point.y = actObj.activePoint.endY;\n            }\n        }\n        else if (degree === 270) {\n            if (flip.toLowerCase() === 'horizontal') {\n                point.x = actObj.activePoint.endX;\n                point.y = actObj.activePoint.endY;\n            }\n            else if (flip.toLowerCase() === 'vertical') {\n                point.x = actObj.activePoint.startX;\n                point.y = actObj.activePoint.startY;\n            }\n            else {\n                point.x = actObj.activePoint.startX;\n                point.y = actObj.activePoint.endY;\n            }\n        }\n        return point;\n    };\n    ImageEditor.prototype.setTextBoxPoints = function (actObj, degree, flip, x, y) {\n        var point = { x: x, y: y };\n        if (degree === 0) {\n            if (actObj.flipObjColl[0].toLowerCase() === 'horizontal') {\n                if (flip.toLowerCase() === 'horizontal') {\n                    point.x = (actObj.activePoint.startX);\n                    point.y = (actObj.activePoint.startY);\n                }\n                else if (flip.toLowerCase() === 'vertical') {\n                    point.x = (actObj.activePoint.endX);\n                    point.y = (actObj.activePoint.endY);\n                }\n            }\n            else {\n                if (flip.toLowerCase() === 'horizontal') {\n                    point.x = (actObj.activePoint.endX);\n                    point.y = (actObj.activePoint.endY);\n                }\n                else if (flip.toLowerCase() === 'vertical') {\n                    point.x = (actObj.activePoint.endX);\n                    point.y = (actObj.activePoint.startY);\n                }\n            }\n        }\n        else if (degree === 90) {\n            if (actObj.flipObjColl[0].toLowerCase() === 'horizontal') {\n                if (flip.toLowerCase() === 'horizontal') {\n                    point.x = (actObj.activePoint.endX);\n                    point.y = (actObj.activePoint.endY);\n                }\n                else if (flip.toLowerCase() === 'vertical') {\n                    point.x = (actObj.activePoint.startX);\n                    point.y = (actObj.activePoint.endY);\n                }\n            }\n            else {\n                if (flip.toLowerCase() === 'horizontal') {\n                    point.x = (actObj.activePoint.startX);\n                    point.y = (actObj.activePoint.endY);\n                }\n                else if (flip.toLowerCase() === 'vertical') {\n                    point.x = (actObj.activePoint.startX);\n                    point.y = (actObj.activePoint.startY);\n                }\n            }\n        }\n        else if (degree === 180) {\n            if (actObj.flipObjColl[0].toLowerCase() === 'horizontal') {\n                if (flip.toLowerCase() === 'horizontal') {\n                    point.x = (actObj.activePoint.startX);\n                    point.y = (actObj.activePoint.startY);\n                }\n                else if (flip.toLowerCase() === 'vertical') {\n                    point.x = (actObj.activePoint.startX);\n                    point.y = (actObj.activePoint.startY);\n                }\n            }\n            else {\n                if (flip.toLowerCase() === 'horizontal') {\n                    point.x = (actObj.activePoint.startX);\n                    point.y = (actObj.activePoint.startY);\n                }\n                else if (flip.toLowerCase() === 'vertical') {\n                    point.x = (actObj.activePoint.startX);\n                    point.y = (actObj.activePoint.endY);\n                }\n            }\n        }\n        else if (degree === 270) {\n            if (actObj.flipObjColl[0].toLowerCase() === 'horizontal') {\n                if (flip.toLowerCase() === 'horizontal') {\n                    point.x = (actObj.activePoint.startX);\n                    point.y = (actObj.activePoint.startY);\n                }\n                else if (flip.toLowerCase() === 'vertical') {\n                    point.x = (actObj.activePoint.endX);\n                    point.y = (actObj.activePoint.startY);\n                }\n            }\n            else {\n                if (flip.toLowerCase() === 'horizontal') {\n                    point.x = (actObj.activePoint.endX);\n                    point.y = (actObj.activePoint.startY);\n                }\n                else if (flip.toLowerCase() === 'vertical') {\n                    point.x = (actObj.activePoint.endX);\n                    point.y = (actObj.activePoint.endY);\n                }\n            }\n        }\n        return point;\n    };\n    ImageEditor.prototype.findTextTarget = function (e) {\n        var x;\n        var y;\n        if (e.type === 'dblclick') {\n            x = e.clientX;\n            y = e.clientY;\n        }\n        else if (e.type === 'touchstart') {\n            this.touchEndPoint.x = x = e.touches[0].clientX;\n            this.touchEndPoint.y = y = e.touches[0].clientY;\n        }\n        this.preventZoomBtn = true;\n        this.refreshToolbar('text');\n        this.preventZoomBtn = false;\n        this.updateToolbarItems();\n        if (!isNullOrUndefined(x) && !isNullOrUndefined(y)) {\n            var bbox = this.lowerCanvas.getBoundingClientRect();\n            x -= bbox.left;\n            y -= bbox.top;\n            var degree = void 0;\n            var flip = '';\n            if (this.activeObj.shapeDegree === 0) {\n                degree = this.degree;\n            }\n            else {\n                degree = this.degree - this.activeObj.shapeDegree;\n            }\n            if (degree < 0) {\n                degree = 360 + degree;\n            }\n            if (this.activeObj.textFlip === '') {\n                if (this.activeObj.textFlip === this.currFlipState) {\n                    flip = '';\n                }\n                else {\n                    flip = this.currFlipState;\n                }\n            }\n            else {\n                if (this.activeObj.textFlip === this.currFlipState) {\n                    flip = '';\n                }\n                else if (this.currFlipState === '') {\n                    flip = this.activeObj.textFlip;\n                }\n                else {\n                    flip = this.currFlipState;\n                }\n            }\n            var temp = void 0;\n            if (this.textArea.style.display === 'none') {\n                temp = extend({}, this.activeObj, {}, true);\n                for (var i = 0; i < this.objColl.length; i++) {\n                    if (JSON.stringify(this.activeObj) === JSON.stringify(this.objColl[i])) {\n                        this.objColl.splice(i, 1);\n                    }\n                }\n                this.refreshActiveObj();\n                this.lowerContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n                this.redrawImgWithObj();\n                if ((!isNullOrUndefined(this.currSelectionPoint) && this.currSelectionPoint.shape === 'crop-circle') || this.isCircleCrop) {\n                    this.cropCircle(this.lowerContext);\n                }\n                this.activeObj = temp;\n                this.updateFontStyles();\n                var actObj = extend({}, this.activeObj, {}, true);\n                if (x >= (actObj.activePoint.startX - (actObj.topLeftCircle.radius * 2)) &&\n                    x <= (actObj.activePoint.endX + (actObj.topLeftCircle.radius * 2)) &&\n                    y >= (actObj.activePoint.startY - (actObj.topLeftCircle.radius * 2)) &&\n                    y <= (actObj.activePoint.endY + (actObj.topLeftCircle.radius * 2))) {\n                    this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n                    if (actObj.flipObjColl.length === 4) {\n                        actObj.flipObjColl = [];\n                        flip = '';\n                    }\n                    if (flip === '' && actObj.flipObjColl.length > 1) {\n                        flip = actObj.flipObjColl[actObj.flipObjColl.length - 1];\n                    }\n                    if (actObj.flipObjColl.length <= 1) {\n                        var points = this.setTextBoxPos(actObj, degree, flip, x, y);\n                        x = points.x;\n                        y = points.y;\n                    }\n                    else {\n                        var points = this.setTextBoxPoints(actObj, degree, flip, x, y);\n                        x = points.x;\n                        y = points.y;\n                    }\n                    this.textArea.style.display = 'block';\n                    this.textArea.style.left = x + 'px';\n                    this.textArea.style.top = y + 'px';\n                    this.textArea.style.fontFamily = actObj.textSettings.fontFamily;\n                    this.textArea.style.fontSize = actObj.textSettings.fontSize + 'px';\n                    this.textArea.style.color = actObj.strokeSettings.strokeColor;\n                    this.textArea.style.fontWeight = actObj.textSettings.bold ? 'bold' : 'normal';\n                    this.textArea.style.fontStyle = actObj.textSettings.italic ? 'italic' : 'normal';\n                    this.textArea.style.border = '2px solid ' + this.themeColl[this.theme]['primaryColor'];\n                    this.textArea.value = actObj.keyHistory;\n                    this.textArea.style.overflow = 'hidden';\n                    this.textArea.style.height = 'auto';\n                    this.textArea.focus();\n                    if (degree % 90 === 0 && degree % 180 !== 0 && degree !== 0) {\n                        if (this.zoomFactor === 0) {\n                            this.textArea.style.width = (actObj.activePoint.height) + 'px';\n                            this.textArea.style.height = (actObj.activePoint.width) + 'px';\n                        }\n                        else {\n                            this.textArea.style.width = actObj.activePoint.height + 'px';\n                            this.textArea.style.height = actObj.activePoint.width + 'px';\n                        }\n                    }\n                    else {\n                        if (this.zoomFactor === 0) {\n                            this.textArea.style.width = (actObj.activePoint.width) + 'px';\n                            this.textArea.style.height = (actObj.activePoint.height) + 'px';\n                        }\n                        else {\n                            this.textArea.style.width = actObj.activePoint.width + 'px';\n                            this.textArea.style.height = actObj.activePoint.height + 'px';\n                        }\n                    }\n                    this.setTextBoxWidth();\n                    if (this.flipColl.length <= 1) {\n                        this.setTextBoxHeight();\n                    }\n                }\n                else {\n                    this.applyActObj();\n                }\n            }\n        }\n        else if (this.textArea.style.display === 'block' && this.selectedText() !== '' && e.type === 'mousedown') {\n            var temp = this.textArea.value;\n            this.textArea.value += 'a';\n            this.textArea.value = temp;\n        }\n    };\n    ImageEditor.prototype.selectedText = function () {\n        var start = this.textArea.selectionStart;\n        var finish = this.textArea.selectionEnd;\n        return this.textArea.value.substring(start, finish);\n    };\n    ImageEditor.prototype.setTextBoxHeight = function () {\n        var textAreaTop;\n        var degree;\n        var flip = '';\n        var actObj = extend({}, this.activeObj, {}, true);\n        if (actObj.shapeDegree === 0) {\n            degree = this.degree;\n        }\n        else {\n            degree = this.degree - actObj.shapeDegree;\n        }\n        if (degree < 0) {\n            degree = 360 + degree;\n        }\n        if (actObj.textFlip === '') {\n            if (actObj.textFlip === this.currFlipState) {\n                flip = '';\n            }\n            else {\n                flip = this.currFlipState;\n            }\n        }\n        else {\n            if (actObj.textFlip === this.currFlipState) {\n                flip = '';\n            }\n            else if (this.currFlipState === '') {\n                flip = actObj.textFlip;\n            }\n            else {\n                flip = this.currFlipState;\n            }\n        }\n        if (degree === 0) {\n            if (flip.toLowerCase() === 'vertical') {\n                this.textArea.style.maxHeight = (this.destHeight - (this.destHeight\n                    - parseFloat(this.textArea.style.top))) + 'px';\n            }\n            else {\n                textAreaTop = parseFloat(this.textArea.style.top) - this.destTop;\n                this.textArea.style.maxHeight = (this.destHeight - textAreaTop) + 'px';\n            }\n        }\n        else if (degree === 90) {\n            if (flip.toLowerCase() === 'horizontal') {\n                this.textArea.style.maxHeight = (this.destWidth - (parseFloat(this.textArea.style.left)\n                    - this.destLeft)) + 'px';\n            }\n            else {\n                this.textArea.style.maxHeight = (parseFloat(this.textArea.style.left)\n                    - this.destLeft) + 'px';\n            }\n        }\n        else if (degree === 180) {\n            if (flip.toLowerCase() === 'vertical') {\n                textAreaTop = parseFloat(this.textArea.style.top) - this.destTop;\n                this.textArea.style.maxHeight = (this.destHeight - textAreaTop) + 'px';\n            }\n            else {\n                this.textArea.style.maxHeight = (parseFloat(this.textArea.style.top)\n                    - this.destTop) + 'px';\n            }\n        }\n        else if (degree === 270) {\n            if (flip.toLowerCase() === 'horizontal') {\n                this.textArea.style.maxHeight = (parseFloat(this.textArea.style.left)\n                    - this.destLeft) + 'px';\n            }\n            else {\n                this.textArea.style.maxHeight = this.destWidth - (parseFloat(this.textArea.style.left)\n                    - this.destLeft) + 'px';\n            }\n        }\n        //this.textArea.style.maxHeight = ((parseFloat(this.textArea.style.maxHeight) - parseFloat(this.textArea.style.fontSize) * 0.5)) + 'px';\n    };\n    ImageEditor.prototype.setTextBoxWidth = function (e) {\n        var text = this.getMaxText(true);\n        if (this.textArea.style.display === 'block') {\n            this.updateFontStyles(true);\n        }\n        else {\n            this.updateFontStyles();\n        }\n        var textAreaWidth = (this.upperContext.measureText(text).width + (parseFloat(this.textArea.style.fontSize) / 2));\n        var letterWidth = e ? this.upperContext.measureText(String.fromCharCode(e.which)).width : 0;\n        var actObj = extend({}, this.activeObj, {}, true);\n        var degree;\n        var flip = '';\n        if (actObj.shapeDegree === 0) {\n            degree = this.degree;\n        }\n        else {\n            degree = this.degree - actObj.shapeDegree;\n        }\n        if (degree < 0) {\n            degree = 360 + degree;\n        }\n        if (actObj.shapeFlip !== this.currFlipState) {\n            flip = '';\n        }\n        else {\n            flip = this.currFlipState;\n        }\n        if ((!isNullOrUndefined(e) && parseFloat(this.textArea.style.width) < (textAreaWidth + letterWidth)) || isNullOrUndefined(e)) {\n            if (degree === 0) {\n                if (flip.toLowerCase() === 'horizontal') {\n                    if ((parseFloat(this.textArea.style.left) - this.destLeft) - textAreaWidth - letterWidth > 0) {\n                        this.textArea.style.width = (textAreaWidth + letterWidth) + 'px';\n                    }\n                }\n                else {\n                    if ((this.destWidth - (parseFloat(this.textArea.style.left)\n                        - this.destLeft)) > (textAreaWidth + letterWidth)) {\n                        this.textArea.style.width = (textAreaWidth + letterWidth) + 'px';\n                    }\n                }\n            }\n            else if (degree === 90) {\n                if (flip.toLowerCase() === 'vertical') {\n                    if ((parseFloat(this.textArea.style.top) - this.destTop) - textAreaWidth - letterWidth > 0) {\n                        this.textArea.style.width = (textAreaWidth + letterWidth) + 'px';\n                    }\n                }\n                else {\n                    if ((this.destWidth - (parseFloat(this.textArea.style.top)\n                        - this.destTop)) > (textAreaWidth + letterWidth)) {\n                        this.textArea.style.width = (textAreaWidth + letterWidth) + 'px';\n                    }\n                }\n            }\n            else if (degree === 180) {\n                if (flip.toLowerCase() === 'horizontal') {\n                    if ((this.destWidth - (parseFloat(this.textArea.style.left)\n                        - this.destLeft)) > (textAreaWidth + letterWidth)) {\n                        this.textArea.style.width = (textAreaWidth + letterWidth) + 'px';\n                    }\n                }\n                else {\n                    if ((parseFloat(this.textArea.style.left) - this.destLeft) - textAreaWidth - letterWidth > 0) {\n                        this.textArea.style.width = (textAreaWidth + letterWidth) + 'px';\n                    }\n                }\n            }\n            else if (degree === 270) {\n                if (flip.toLowerCase() === 'vertical') {\n                    if ((this.destHeight - (parseFloat(this.textArea.style.top)\n                        - this.destTop)) > (textAreaWidth + letterWidth)) {\n                        this.textArea.style.width = (textAreaWidth + letterWidth) + 'px';\n                    }\n                }\n                else {\n                    if ((parseFloat(this.textArea.style.top) - this.destTop) - textAreaWidth - letterWidth > 0) {\n                        this.textArea.style.width = (textAreaWidth + letterWidth) + 'px';\n                    }\n                }\n            }\n        }\n    };\n    ImageEditor.prototype.setActivePoint = function (startX, startY) {\n        if (isNullOrUndefined(this.activeObj.activePoint)) {\n            return;\n        }\n        if (this.currObjType.isText) {\n            var textWidth = startX ? startX : 0;\n            var textHeight = startY ? startY : this.activeObj.textSettings.fontSize;\n            if (this.activeObj.textSettings.fontSize === undefined) {\n                this.activeObj.textSettings.fontSize = (Math.abs(this.baseImg.width - this.baseImg.height)) * 0.1;\n            }\n            this.setTextSelection(textWidth, textHeight);\n            this.mouseDownPoint.x = this.activeObj.activePoint.endX;\n            this.mouseDownPoint.y = this.activeObj.activePoint.endY;\n            if (this.activeObj.horTopLine !== undefined) {\n                this.activeObj.activePoint = extend({}, this.activeObj.activePoint, {}, true);\n            }\n            this.drawObject('duplicate');\n        }\n        else if (startX && startY) {\n            this.activeObj.activePoint.startX = this.mouseDownPoint.x = startX;\n            this.activeObj.activePoint.startY = this.mouseDownPoint.y = startY;\n            this.currObjType.isDragging = true;\n        }\n        else {\n            var selectInfo = this.activeObj;\n            this.activeObj.activePoint = { startX: selectInfo.horTopLine.startX, startY: selectInfo.horTopLine.startY,\n                endX: selectInfo.horTopLine.endX, endY: selectInfo.horTopLine.endY };\n            this.activeObj.activePoint.width = this.activeObj.activePoint.endX - this.activeObj.activePoint.startX;\n            this.activeObj.activePoint.height = this.activeObj.activePoint.endY - this.activeObj.activePoint.startY;\n        }\n    };\n    ImageEditor.prototype.setDragWidth = function (width) {\n        var tempWidth = width;\n        if (tempWidth >= 0) {\n            for (var i = 0; i < tempWidth; i++) {\n                width = tempWidth - i;\n                this.activeObj.activePoint.startX += width;\n                this.activeObj.activePoint.endX += width;\n                if (this.activeObj.activePoint.startX >= this.destLeft &&\n                    this.activeObj.activePoint.endX <= this.destLeft + this.destWidth) {\n                    break;\n                }\n                else {\n                    this.activeObj.activePoint.startX -= width;\n                    this.activeObj.activePoint.endX -= width;\n                }\n            }\n        }\n        else {\n            for (var i = 1; i < Math.abs(tempWidth); i++) {\n                width = tempWidth + i;\n                this.activeObj.activePoint.startX += width;\n                this.activeObj.activePoint.endX += width;\n                if (this.activeObj.activePoint.startX >= this.destLeft &&\n                    this.activeObj.activePoint.endX <= this.destLeft + this.destWidth) {\n                    break;\n                }\n                else {\n                    this.activeObj.activePoint.startX -= width;\n                    this.activeObj.activePoint.endX -= width;\n                }\n            }\n        }\n    };\n    ImageEditor.prototype.setDragHeight = function (height) {\n        var tempHeight = height;\n        if (tempHeight >= 0) {\n            for (var i = 1; i < tempHeight; i++) {\n                height = tempHeight - i;\n                this.activeObj.activePoint.startY += height;\n                this.activeObj.activePoint.endY += height;\n                if (this.activeObj.activePoint.startY >= this.destTop &&\n                    this.activeObj.activePoint.endY <= this.destTop + this.destHeight) {\n                    break;\n                }\n                else {\n                    this.activeObj.activePoint.startY -= height;\n                    this.activeObj.activePoint.endY -= height;\n                }\n            }\n        }\n        else {\n            for (var i = 0; i < Math.abs(tempHeight); i++) {\n                height = tempHeight + i;\n                this.activeObj.activePoint.startY += height;\n                this.activeObj.activePoint.endY += height;\n                if (this.activeObj.activePoint.startY >= this.destTop &&\n                    this.activeObj.activePoint.endY <= this.destTop + this.destHeight) {\n                    break;\n                }\n                else {\n                    this.activeObj.activePoint.startY -= height;\n                    this.activeObj.activePoint.endY -= height;\n                }\n            }\n        }\n    };\n    ImageEditor.prototype.triggerShapeChange = function (shapeResizingArgs, shapeMovingArgs, type) {\n        this.activeObj.activePoint.width = this.activeObj.activePoint.endX - this.activeObj.activePoint.startX;\n        this.activeObj.activePoint.height = this.activeObj.activePoint.endY - this.activeObj.activePoint.startY;\n        var currentShapeSettings = this.updatePreviousShapeSettings();\n        shapeResizingArgs.currentShapeSettings = currentShapeSettings;\n        shapeMovingArgs.currentShapeSettings = currentShapeSettings;\n        if (type === 'resize') {\n            this.trigger('shapeChanging', shapeResizingArgs);\n            this.updateShapeChangeEventArgs(shapeResizingArgs.currentShapeSettings);\n        }\n        else {\n            this.trigger('shapeChanging', shapeMovingArgs);\n            this.updateShapeChangeEventArgs(shapeMovingArgs.currentShapeSettings);\n        }\n    };\n    ImageEditor.prototype.updateActivePoint = function (x, y, isCropSelection) {\n        var maxDimension = this.calcMaxDimension(this.activeObj.activePoint.width, this.activeObj.activePoint.height);\n        var previousShapeSettings = this.updatePreviousShapeSettings();\n        var shapeResizingArgs = { action: 'resize', previousShapeSettings: previousShapeSettings };\n        var shapeMovingArgs = { action: 'move', previousShapeSettings: previousShapeSettings };\n        if (this.activeObj.shape === 'text' && this.dragElement !== '') {\n            this.updateFontRatio(this.activeObj);\n        }\n        switch (this.dragElement.toLowerCase()) {\n            case 'nw-resize':\n                this.updateNWPoints(x, y, maxDimension);\n                this.triggerShapeChange(shapeResizingArgs, shapeMovingArgs, 'resize');\n                break;\n            case 'n-resize':\n                this.updateNPoints(x, y);\n                this.triggerShapeChange(shapeResizingArgs, shapeMovingArgs, 'resize');\n                break;\n            case 'ne-resize':\n                this.updateNEPoints(x, y, maxDimension);\n                this.triggerShapeChange(shapeResizingArgs, shapeMovingArgs, 'resize');\n                break;\n            case 'w-resize':\n                this.updateWPoints(x, y);\n                this.triggerShapeChange(shapeResizingArgs, shapeMovingArgs, 'resize');\n                break;\n            case 'e-resize':\n                this.updateEPoints(x, y);\n                this.triggerShapeChange(shapeResizingArgs, shapeMovingArgs, 'resize');\n                break;\n            case 'sw-resize':\n                this.updateSWPoints(x, y, maxDimension);\n                this.triggerShapeChange(shapeResizingArgs, shapeMovingArgs, 'resize');\n                break;\n            case 's-resize':\n                this.updateSPoints(x, y);\n                this.triggerShapeChange(shapeResizingArgs, shapeMovingArgs, 'resize');\n                break;\n            case 'se-resize':\n                this.updateSEPoints(x, y, maxDimension);\n                this.triggerShapeChange(shapeResizingArgs, shapeMovingArgs, 'resize');\n                break;\n            default:\n                if (!isCropSelection && !this.currObjType.isCustomCrop) {\n                    if (this.dragPoint.startX) {\n                        var width = (this.dragPoint.endX - this.previousPoint.x);\n                        var height = (this.dragPoint.endY - this.previousPoint.y);\n                        this.activeObj.activePoint.startX += width;\n                        this.activeObj.activePoint.endX += width;\n                        this.activeObj.activePoint.startY += height;\n                        this.activeObj.activePoint.endY += height;\n                        if (!this.isPreventDragging && (this.activeObj.activePoint.startX < this.destLeft ||\n                            this.activeObj.activePoint.startY < this.destTop || this.activeObj.activePoint.endX >\n                            this.destLeft + this.destWidth || this.activeObj.activePoint.endY > this.destTop + this.destHeight)) {\n                            this.activeObj.activePoint.startX -= width;\n                            this.activeObj.activePoint.endX -= width;\n                            this.activeObj.activePoint.startY -= height;\n                            this.activeObj.activePoint.endY -= height;\n                            this.setDragWidth(width);\n                            this.setDragHeight(height);\n                        }\n                    }\n                    else {\n                        this.activeObj.activePoint.startX = x < this.mouseDownPoint.x ? x : this.mouseDownPoint.x;\n                        this.activeObj.activePoint.startY = y < this.mouseDownPoint.y ? y : this.mouseDownPoint.y;\n                        x = x < this.mouseDownPoint.x ? this.mouseDownPoint.x : x;\n                        y = y < this.mouseDownPoint.y ? this.mouseDownPoint.y : y;\n                        this.activeObj.activePoint.endX = x;\n                        this.activeObj.activePoint.endY = y;\n                    }\n                    this.triggerShapeChange(shapeResizingArgs, shapeMovingArgs, 'move');\n                }\n                break;\n        }\n    };\n    ImageEditor.prototype.preventDraggingInvertly = function () {\n        if (!this.isPreventDragging) {\n            if (this.activeObj.activePoint.startX < this.destLeft) {\n                this.activeObj.activePoint.startX = this.destLeft;\n            }\n            if (this.activeObj.activePoint.startY < this.destTop) {\n                this.activeObj.activePoint.startY = this.destTop;\n            }\n            if (this.activeObj.activePoint.endX > this.destLeft + this.destWidth) {\n                this.activeObj.activePoint.endX = this.destLeft + this.destWidth;\n            }\n            if (this.activeObj.activePoint.endY > this.destTop + this.destHeight) {\n                this.activeObj.activePoint.endY = this.destTop + this.destHeight;\n            }\n        }\n    };\n    ImageEditor.prototype.updateNWPoints = function (x, y, maxDimension) {\n        var diff;\n        var width;\n        var height;\n        var scale;\n        var percentage;\n        var prevDiffX = this.diffPoint.x;\n        var prevDiffY = this.diffPoint.y;\n        var tempActiveObj = extend({}, this.activeObj, null, true);\n        if (this.activeObj.shape === 'text') {\n            if (this.oldPoint.x === undefined && this.oldPoint.y === undefined) {\n                this.diffPoint.x = this.activeObj.activePoint.startX - x;\n                this.diffPoint.y = this.activeObj.activePoint.startY - y;\n            }\n            else {\n                this.diffPoint.x = this.oldPoint.x - x;\n                this.diffPoint.y = this.oldPoint.y - y;\n            }\n            this.oldPoint.x = x;\n            this.oldPoint.y = y;\n            if (this.diffPoint.x <= prevDiffX && this.diffPoint.y >= prevDiffY) {\n                diff = Math.min(this.diffPoint.x, this.diffPoint.y);\n            }\n            else {\n                diff = Math.max(this.diffPoint.x, this.diffPoint.y);\n            }\n            percentage = (diff / 10);\n            this.activeObj.activePoint.startX -= (maxDimension.width / 100) * percentage;\n            this.activeObj.activePoint.startY -= (maxDimension.height / 100) * percentage;\n            this.activeObj.activePoint.width = this.activeObj.activePoint.endX - this.activeObj.activePoint.startX;\n            this.activeObj.activePoint.height = this.activeObj.activePoint.endY - this.activeObj.activePoint.startY;\n            this.updateFontSize(this.activeObj);\n        }\n        else {\n            var splitWords = void 0;\n            if (this.activeObj.shape !== undefined) {\n                splitWords = this.activeObj.shape.split('-');\n            }\n            if (this.activeObj.shape === 'crop-custom' || (this.activeObj.shape !== undefined && splitWords[0] !== 'crop')) {\n                this.activeObj.activePoint.startX = x;\n                this.activeObj.activePoint.startY = y;\n                if (this.activeObj.activePoint.startX > this.activeObj.activePoint.endX) {\n                    var temp = this.activeObj.activePoint.startX;\n                    this.activeObj.activePoint.startX = this.activeObj.activePoint.endX;\n                    this.activeObj.activePoint.endX = temp;\n                    this.dragElement = 'ne-resize';\n                }\n                if (this.activeObj.activePoint.startY > this.activeObj.activePoint.endY) {\n                    var temp = this.activeObj.activePoint.startY;\n                    this.activeObj.activePoint.startY = this.activeObj.activePoint.endY;\n                    this.activeObj.activePoint.endY = temp;\n                    this.dragElement = 'sw-resize';\n                }\n                this.preventDraggingInvertly();\n            }\n            else {\n                if (this.activeObj.activePoint.startX < x && this.activeObj.activePoint.startY < y) {\n                    width = x - this.activeObj.activePoint.startX;\n                    height = y - this.activeObj.activePoint.startY;\n                    scale = Math.min(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    this.activeObj.activePoint.startX += newScale.x;\n                    this.activeObj.activePoint.startY += newScale.y;\n                    var left = this.destLeft > 0 ? this.destLeft : 0;\n                    var top_2 = this.destTop > 0 ? this.destTop : 0;\n                    if (this.activeObj.activePoint.startX < left || this.activeObj.activePoint.startY < top_2) {\n                        this.activeObj.activePoint.startX -= newScale.x;\n                        this.activeObj.activePoint.startY -= newScale.y;\n                    }\n                }\n                else {\n                    width = this.activeObj.activePoint.startX - x;\n                    height = y - this.activeObj.activePoint.endY;\n                    scale = Math.max(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    this.activeObj.activePoint.startX -= newScale.x;\n                    this.activeObj.activePoint.startY -= newScale.y;\n                    var left = this.destLeft > 0 ? this.destLeft : 0;\n                    var top_3 = this.destTop > 0 ? this.destTop : 0;\n                    if (this.activeObj.activePoint.startX < left || this.activeObj.activePoint.startY < top_3) {\n                        this.activeObj.activePoint.startX += newScale.x;\n                        this.activeObj.activePoint.startY += newScale.y;\n                    }\n                }\n            }\n            this.activeObj.activePoint.width = this.activeObj.activePoint.endX - this.activeObj.activePoint.startX;\n            this.activeObj.activePoint.height = this.activeObj.activePoint.endY - this.activeObj.activePoint.startY;\n            this.preventInverseResize(tempActiveObj);\n        }\n    };\n    ImageEditor.prototype.updateNPoints = function (x, y) {\n        var width;\n        var height;\n        var scale;\n        if (this.activeObj.shape !== 'text') {\n            var splitWords = void 0;\n            if (this.activeObj.shape !== undefined) {\n                splitWords = this.activeObj.shape.split('-');\n            }\n            if (this.activeObj.shape === 'crop-custom' || (this.activeObj.shape !== undefined && splitWords[0] !== 'crop')) {\n                this.activeObj.activePoint.startY = y;\n                this.activeObj.activePoint.height = this.activeObj.activePoint.endY - this.activeObj.activePoint.startY;\n                if (this.activeObj.activePoint.startY > this.activeObj.activePoint.endY) {\n                    var temp = this.activeObj.activePoint.startY;\n                    this.activeObj.activePoint.startY = this.activeObj.activePoint.endY;\n                    this.activeObj.activePoint.endY = temp;\n                    this.dragElement = 's-resize';\n                }\n                this.preventDraggingInvertly();\n            }\n            else {\n                if (this.activeObj.activePoint.endX > x && this.activeObj.activePoint.startY < y) {\n                    width = this.activeObj.activePoint.endX - x;\n                    height = y - this.activeObj.activePoint.startY;\n                    scale = Math.min(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    this.activeObj.activePoint.endX -= newScale.x;\n                    this.activeObj.activePoint.startY += newScale.y;\n                    if (this.activeObj.activePoint.endX > (this.destLeft + this.destWidth) ||\n                        this.activeObj.activePoint.startY < this.destTop) {\n                        this.activeObj.activePoint.endX += newScale.x;\n                        this.activeObj.activePoint.startY -= newScale.y;\n                    }\n                }\n                else {\n                    width = x - this.activeObj.activePoint.endX;\n                    height = this.activeObj.activePoint.startY - y;\n                    scale = Math.max(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    this.activeObj.activePoint.endX += newScale.x;\n                    this.activeObj.activePoint.startY -= newScale.y;\n                    if (this.activeObj.activePoint.endX > (this.destLeft + this.destWidth) ||\n                        this.activeObj.activePoint.startY < this.destTop) {\n                        this.activeObj.activePoint.endX -= newScale.x;\n                        this.activeObj.activePoint.startY += newScale.y;\n                    }\n                }\n                this.activeObj.activePoint.width = this.activeObj.activePoint.endX - this.activeObj.activePoint.startX;\n                this.activeObj.activePoint.height = this.activeObj.activePoint.endY - this.activeObj.activePoint.startY;\n            }\n        }\n    };\n    ImageEditor.prototype.updateNEPoints = function (x, y, maxDimension) {\n        var diff;\n        var width;\n        var height;\n        var scale;\n        var percentage;\n        var prevDiffX = this.diffPoint.x;\n        var prevDiffY = this.diffPoint.y;\n        var tempActiveObj = extend({}, this.activeObj, null, true);\n        if (this.activeObj.shape === 'text') {\n            if (this.oldPoint.x === undefined && this.oldPoint.y === undefined) {\n                this.diffPoint.x = x - this.activeObj.activePoint.endX;\n                this.diffPoint.y = this.activeObj.activePoint.startY - y;\n            }\n            else {\n                this.diffPoint.x = x - this.oldPoint.x;\n                this.diffPoint.y = this.oldPoint.y - y;\n            }\n            this.oldPoint.x = x;\n            this.oldPoint.y = y;\n            if (this.diffPoint.x <= prevDiffX && this.diffPoint.y >= prevDiffY) {\n                diff = Math.min(this.diffPoint.x, this.diffPoint.y);\n            }\n            else {\n                diff = Math.max(this.diffPoint.x, this.diffPoint.y);\n            }\n            percentage = (diff / 10);\n            this.activeObj.activePoint.endX += (maxDimension.width / 100) * percentage;\n            this.activeObj.activePoint.startY -= (maxDimension.height / 100) * percentage;\n            this.activeObj.activePoint.width = this.activeObj.activePoint.endX - this.activeObj.activePoint.startX;\n            this.activeObj.activePoint.height = this.activeObj.activePoint.endY - this.activeObj.activePoint.startY;\n            this.updateFontSize(this.activeObj);\n        }\n        else {\n            var splitWords = void 0;\n            if (this.activeObj.shape !== undefined) {\n                splitWords = this.activeObj.shape.split('-');\n            }\n            if (this.currObjType.isCustomCrop || (this.activeObj.shape !== undefined && splitWords[0] !== 'crop')) {\n                this.activeObj.activePoint.endX = x;\n                this.activeObj.activePoint.startY = y;\n                if (this.activeObj.activePoint.endX < this.activeObj.activePoint.startX) {\n                    var temp = this.activeObj.activePoint.endX;\n                    this.activeObj.activePoint.endX = this.activeObj.activePoint.startX;\n                    this.activeObj.activePoint.startX = temp;\n                    this.dragElement = 'nw-resize';\n                }\n                if (this.activeObj.activePoint.startY > this.activeObj.activePoint.endY) {\n                    var temp = this.activeObj.activePoint.startY;\n                    this.activeObj.activePoint.startY = this.activeObj.activePoint.endY;\n                    this.activeObj.activePoint.endY = temp;\n                    this.dragElement = 'se-resize';\n                }\n                this.preventDraggingInvertly();\n            }\n            else {\n                if (this.activeObj.activePoint.endX > x && this.activeObj.activePoint.startY < y) {\n                    width = this.activeObj.activePoint.endX - x;\n                    height = y - this.activeObj.activePoint.startY;\n                    scale = Math.min(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    this.activeObj.activePoint.endX -= newScale.x;\n                    this.activeObj.activePoint.startY += newScale.y;\n                    var endX = this.destLeft + this.destWidth < this.lowerCanvas.width ?\n                        this.destLeft + this.destWidth : this.lowerCanvas.width;\n                    var endY = this.destTop > 0 ? this.destTop : 0;\n                    if (this.activeObj.activePoint.endX > endX || this.activeObj.activePoint.startY < endY) {\n                        this.activeObj.activePoint.endX += newScale.x;\n                        this.activeObj.activePoint.startY -= newScale.y;\n                    }\n                }\n                else {\n                    width = x - this.activeObj.activePoint.endX;\n                    height = this.activeObj.activePoint.startY - y;\n                    scale = Math.max(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    this.activeObj.activePoint.endX += newScale.x;\n                    this.activeObj.activePoint.startY -= newScale.y;\n                    var endX = this.destLeft + this.destWidth < this.lowerCanvas.width ?\n                        this.destLeft + this.destWidth : this.lowerCanvas.width;\n                    var endY = this.destTop > 0 ? this.destTop : 0;\n                    if (this.activeObj.activePoint.endX > endX || this.activeObj.activePoint.startY < endY) {\n                        this.activeObj.activePoint.endX -= newScale.x;\n                        this.activeObj.activePoint.startY += newScale.y;\n                    }\n                }\n            }\n            this.activeObj.activePoint.width = this.activeObj.activePoint.endX - this.activeObj.activePoint.startX;\n            this.activeObj.activePoint.height = this.activeObj.activePoint.endY - this.activeObj.activePoint.startY;\n            this.preventInverseResize(tempActiveObj);\n        }\n    };\n    ImageEditor.prototype.updateWPoints = function (x, y) {\n        var width;\n        var height;\n        var scale;\n        if (this.activeObj.shape !== 'text') {\n            var splitWords = void 0;\n            if (this.activeObj.shape !== undefined) {\n                splitWords = this.activeObj.shape.split('-');\n            }\n            if (this.activeObj.shape === 'crop-custom' || (this.activeObj.shape !== undefined && splitWords[0] !== 'crop')) {\n                this.activeObj.activePoint.startX = x;\n                this.activeObj.activePoint.width = this.activeObj.activePoint.endX - this.activeObj.activePoint.startX;\n                if (this.activeObj.activePoint.startX > this.activeObj.activePoint.endX) {\n                    var temp = this.activeObj.activePoint.startX;\n                    this.activeObj.activePoint.startX = this.activeObj.activePoint.endX;\n                    this.activeObj.activePoint.endX = temp;\n                    this.dragElement = 'e-resize';\n                }\n                this.preventDraggingInvertly();\n            }\n            else {\n                if (this.activeObj.activePoint.startX < x && this.activeObj.activePoint.endY > y) {\n                    width = x - this.activeObj.activePoint.startX;\n                    height = this.activeObj.activePoint.endY - y;\n                    scale = Math.min(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    this.activeObj.activePoint.startX += newScale.x;\n                    this.activeObj.activePoint.endY -= newScale.y;\n                    if (this.activeObj.activePoint.startX < this.destLeft || this.activeObj.activePoint.endY >\n                        (this.destTop + this.destHeight)) {\n                        this.activeObj.activePoint.startX -= newScale.x;\n                        this.activeObj.activePoint.endY += newScale.y;\n                    }\n                }\n                else {\n                    width = this.activeObj.activePoint.startX - x;\n                    height = y - this.activeObj.activePoint.endY;\n                    scale = Math.max(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    this.activeObj.activePoint.startX -= newScale.x;\n                    this.activeObj.activePoint.endY += newScale.y;\n                    if (this.activeObj.activePoint.startX < this.destLeft || this.activeObj.activePoint.endY >\n                        (this.destTop + this.destHeight)) {\n                        this.activeObj.activePoint.startX += newScale.x;\n                        this.activeObj.activePoint.endY -= newScale.y;\n                    }\n                }\n                this.activeObj.activePoint.width = this.activeObj.activePoint.endX - this.activeObj.activePoint.startX;\n                this.activeObj.activePoint.height = this.activeObj.activePoint.endY - this.activeObj.activePoint.startY;\n            }\n        }\n    };\n    ImageEditor.prototype.updateEPoints = function (x, y) {\n        var width;\n        var height;\n        var scale;\n        if (this.activeObj.shape !== 'text') {\n            var splitWords = void 0;\n            if (this.activeObj.shape !== undefined) {\n                splitWords = this.activeObj.shape.split('-');\n            }\n            if (this.activeObj.shape === 'crop-custom' || (this.activeObj.shape !== undefined && splitWords[0] !== 'crop')) {\n                this.activeObj.activePoint.endX = x;\n                this.activeObj.activePoint.width = this.activeObj.activePoint.endX - this.activeObj.activePoint.startX;\n                if (this.activeObj.activePoint.endX < this.activeObj.activePoint.startX) {\n                    var temp = this.activeObj.activePoint.endX;\n                    this.activeObj.activePoint.endX = this.activeObj.activePoint.startX;\n                    this.activeObj.activePoint.startX = temp;\n                    this.dragElement = 'w-resize';\n                }\n                this.preventDraggingInvertly();\n            }\n            else {\n                if (this.activeObj.activePoint.endX > x && this.activeObj.activePoint.endY > y) {\n                    width = this.activeObj.activePoint.endX - x;\n                    height = this.activeObj.activePoint.endY - y;\n                    scale = Math.min(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    this.activeObj.activePoint.endX -= newScale.x;\n                    this.activeObj.activePoint.endY -= newScale.y;\n                    if (this.activeObj.activePoint.endX > (this.destLeft + this.destWidth) ||\n                        this.activeObj.activePoint.endY > (this.destTop + this.destHeight)) {\n                        this.activeObj.activePoint.endX += newScale.x;\n                        this.activeObj.activePoint.endY += newScale.y;\n                    }\n                }\n                else {\n                    width = x - this.activeObj.activePoint.endX;\n                    height = y - this.activeObj.activePoint.endY;\n                    scale = Math.max(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    this.activeObj.activePoint.endX += newScale.x;\n                    this.activeObj.activePoint.endY += newScale.y;\n                    if (this.activeObj.activePoint.endX > (this.destLeft + this.destWidth) || this.activeObj.activePoint.endY >\n                        (this.destTop + this.destHeight)) {\n                        this.activeObj.activePoint.endX -= newScale.x;\n                        this.activeObj.activePoint.endY -= newScale.y;\n                    }\n                }\n                this.activeObj.activePoint.width = this.activeObj.activePoint.endX - this.activeObj.activePoint.startX;\n                this.activeObj.activePoint.height = this.activeObj.activePoint.endY - this.activeObj.activePoint.startY;\n            }\n        }\n    };\n    ImageEditor.prototype.updateSWPoints = function (x, y, maxDimension) {\n        var diff;\n        var width;\n        var height;\n        var scale;\n        var percentage;\n        var prevDiffX = this.diffPoint.x;\n        var prevDiffY = this.diffPoint.y;\n        var tempActiveObj = extend({}, this.activeObj, null, true);\n        if (this.activeObj.shape === 'text') {\n            if (this.oldPoint.x === undefined && this.oldPoint.y === undefined) {\n                this.diffPoint.x = this.activeObj.activePoint.startX - x;\n                this.diffPoint.y = y - this.activeObj.activePoint.endY;\n            }\n            else {\n                this.diffPoint.x = this.oldPoint.x - x;\n                this.diffPoint.y = y - this.oldPoint.y;\n            }\n            this.oldPoint.x = x;\n            this.oldPoint.y = y;\n            if (this.diffPoint.x <= prevDiffX && this.diffPoint.y >= prevDiffY) {\n                diff = Math.min(this.diffPoint.x, this.diffPoint.y);\n            }\n            else {\n                diff = Math.max(this.diffPoint.x, this.diffPoint.y);\n            }\n            percentage = (diff / 10);\n            this.activeObj.activePoint.startX -= (maxDimension.width / 100) * percentage;\n            this.activeObj.activePoint.endY += (maxDimension.height / 100) * percentage;\n            this.activeObj.activePoint.width = this.activeObj.activePoint.endX - this.activeObj.activePoint.startX;\n            this.activeObj.activePoint.height = this.activeObj.activePoint.endY - this.activeObj.activePoint.startY;\n            this.updateFontSize(this.activeObj);\n        }\n        else {\n            var splitWords = void 0;\n            if (this.activeObj.shape !== undefined) {\n                splitWords = this.activeObj.shape.split('-');\n            }\n            if (this.activeObj.shape === 'crop-custom' || (this.activeObj.shape !== undefined && splitWords[0] !== 'crop')) {\n                this.activeObj.activePoint.startX = x;\n                this.activeObj.activePoint.endY = y;\n                if (this.activeObj.activePoint.startX > this.activeObj.activePoint.endX) {\n                    var temp = this.activeObj.activePoint.startX;\n                    this.activeObj.activePoint.startX = this.activeObj.activePoint.endX;\n                    this.activeObj.activePoint.endX = temp;\n                    this.dragElement = 'se-resize';\n                }\n                if (this.activeObj.activePoint.endY < this.activeObj.activePoint.startY) {\n                    var temp = this.activeObj.activePoint.endY;\n                    this.activeObj.activePoint.endY = this.activeObj.activePoint.startY;\n                    this.activeObj.activePoint.startY = temp;\n                    this.dragElement = 'nw-resize';\n                }\n                this.preventDraggingInvertly();\n            }\n            else {\n                if (this.activeObj.activePoint.startX < x && this.activeObj.activePoint.endY > y) {\n                    width = x - this.activeObj.activePoint.startX;\n                    height = this.activeObj.activePoint.endY - y;\n                    scale = Math.min(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    this.activeObj.activePoint.startX += newScale.x;\n                    this.activeObj.activePoint.endY -= newScale.y;\n                    var endX = this.destLeft > 0 ? this.destLeft : 0;\n                    var endY = this.destTop + this.destHeight < this.lowerCanvas.height ? this.destTop +\n                        this.destHeight : this.lowerCanvas.height;\n                    if (this.activeObj.activePoint.startX < endX || this.activeObj.activePoint.endY > endY) {\n                        this.activeObj.activePoint.startX -= newScale.x;\n                        this.activeObj.activePoint.endY += newScale.y;\n                    }\n                }\n                else {\n                    width = this.activeObj.activePoint.startX - x;\n                    height = y - this.activeObj.activePoint.endY;\n                    scale = Math.max(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    this.activeObj.activePoint.startX -= newScale.x;\n                    this.activeObj.activePoint.endY += newScale.y;\n                    var endX = this.destLeft > 0 ? this.destLeft : 0;\n                    var endY = this.destTop + this.destHeight < this.lowerCanvas.height ? this.destTop +\n                        this.destHeight : this.lowerCanvas.height;\n                    if (this.activeObj.activePoint.startX < endX || this.activeObj.activePoint.endY > endY) {\n                        this.activeObj.activePoint.startX += newScale.x;\n                        this.activeObj.activePoint.endY -= newScale.y;\n                    }\n                }\n            }\n            this.activeObj.activePoint.width = this.activeObj.activePoint.endX - this.activeObj.activePoint.startX;\n            this.activeObj.activePoint.height = this.activeObj.activePoint.endY - this.activeObj.activePoint.startY;\n            this.preventInverseResize(tempActiveObj);\n        }\n    };\n    ImageEditor.prototype.updateSPoints = function (x, y) {\n        var width;\n        var height;\n        var scale;\n        if (this.activeObj.shape !== 'text') {\n            var splitWords = void 0;\n            if (this.activeObj.shape !== undefined) {\n                splitWords = this.activeObj.shape.split('-');\n            }\n            if (this.activeObj.shape === 'crop-custom' || (this.activeObj.shape !== undefined && splitWords[0] !== 'crop')) {\n                this.activeObj.activePoint.endY = y;\n                this.activeObj.activePoint.height = this.activeObj.activePoint.endY - this.activeObj.activePoint.startY;\n                if (this.activeObj.activePoint.endY < this.activeObj.activePoint.startY) {\n                    var temp = this.activeObj.activePoint.endY;\n                    this.activeObj.activePoint.endY = this.activeObj.activePoint.startY;\n                    this.activeObj.activePoint.startY = temp;\n                    this.dragElement = 'n-resize';\n                }\n                this.preventDraggingInvertly();\n            }\n            else {\n                if (this.activeObj.activePoint.endX > x && this.activeObj.activePoint.endY > y) {\n                    width = this.activeObj.activePoint.endX - x;\n                    height = this.activeObj.activePoint.endY - y;\n                    scale = Math.min(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    this.activeObj.activePoint.endX -= newScale.x;\n                    this.activeObj.activePoint.endY -= newScale.y;\n                    if (this.activeObj.activePoint.endX > (this.destLeft + this.destWidth) ||\n                        this.activeObj.activePoint.endY > (this.destTop + this.destHeight)) {\n                        this.activeObj.activePoint.endX += newScale.x;\n                        this.activeObj.activePoint.endY += newScale.y;\n                    }\n                }\n                else {\n                    width = x - this.activeObj.activePoint.endX;\n                    height = y - this.activeObj.activePoint.endY;\n                    scale = Math.max(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    this.activeObj.activePoint.endX += newScale.x;\n                    this.activeObj.activePoint.endY += newScale.x;\n                    if (this.activeObj.activePoint.endX > (this.destLeft + this.destWidth) ||\n                        this.activeObj.activePoint.endY > (this.destTop + this.destHeight)) {\n                        this.activeObj.activePoint.endX -= newScale.x;\n                        this.activeObj.activePoint.endY -= newScale.y;\n                    }\n                }\n                this.activeObj.activePoint.width = this.activeObj.activePoint.endX - this.activeObj.activePoint.startX;\n                this.activeObj.activePoint.height = this.activeObj.activePoint.endY - this.activeObj.activePoint.startY;\n            }\n        }\n    };\n    ImageEditor.prototype.updateSEPoints = function (x, y, maxDimension) {\n        var diff;\n        var width;\n        var height;\n        var scale;\n        var percentage;\n        var prevDiffX = this.diffPoint.x;\n        var prevDiffY = this.diffPoint.y;\n        var tempActiveObj = extend({}, this.activeObj, null, true);\n        if (this.activeObj.shape === 'text') {\n            if (this.oldPoint.x === undefined && this.oldPoint.y === undefined) {\n                this.diffPoint.x = x - this.activeObj.activePoint.endX;\n                this.diffPoint.y = y - this.activeObj.activePoint.endY;\n            }\n            else {\n                this.diffPoint.x = x - this.oldPoint.x;\n                this.diffPoint.y = y - this.oldPoint.y;\n            }\n            this.oldPoint.x = x;\n            this.oldPoint.y = y;\n            if (this.diffPoint.x >= prevDiffX && this.diffPoint.y >= prevDiffY) {\n                diff = Math.max(this.diffPoint.x, this.diffPoint.y);\n            }\n            else {\n                diff = Math.min(this.diffPoint.x, this.diffPoint.y);\n            }\n            percentage = (diff / 10);\n            this.activeObj.activePoint.endX += (maxDimension.width / 50) * percentage;\n            this.activeObj.activePoint.endY += (maxDimension.height / 50) * percentage;\n            this.activeObj.activePoint.width = this.activeObj.activePoint.endX - this.activeObj.activePoint.startX;\n            this.activeObj.activePoint.height = this.activeObj.activePoint.endY - this.activeObj.activePoint.startY;\n            this.updateFontSize(this.activeObj);\n        }\n        else {\n            var splitWords = void 0;\n            if (this.activeObj.shape !== undefined) {\n                splitWords = this.activeObj.shape.split('-');\n            }\n            if (this.activeObj.shape === 'crop-custom' || (this.activeObj.shape !== undefined && splitWords[0] !== 'crop')) {\n                this.activeObj.activePoint.endX = x;\n                this.activeObj.activePoint.endY = y;\n                if (this.activeObj.activePoint.endX < this.activeObj.activePoint.startX) {\n                    var temp = this.activeObj.activePoint.endX;\n                    this.activeObj.activePoint.endX = this.activeObj.activePoint.startX;\n                    this.activeObj.activePoint.startX = temp;\n                    this.dragElement = 'sw-resize';\n                }\n                if (this.activeObj.activePoint.endY < this.activeObj.activePoint.startY) {\n                    var temp = this.activeObj.activePoint.endY;\n                    this.activeObj.activePoint.endY = this.activeObj.activePoint.startY;\n                    this.activeObj.activePoint.startY = temp;\n                    this.dragElement = 'ne-resize';\n                }\n                this.preventDraggingInvertly();\n            }\n            else {\n                if (this.activeObj.activePoint.endX > x && this.activeObj.activePoint.endY > y) {\n                    width = this.activeObj.activePoint.endX - x;\n                    height = this.activeObj.activePoint.endY - y;\n                    scale = Math.min(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    this.activeObj.activePoint.endX -= newScale.x;\n                    this.activeObj.activePoint.endY -= newScale.y;\n                    var endX = this.destLeft + this.destWidth < this.lowerCanvas.width ?\n                        this.destLeft + this.destWidth : this.lowerCanvas.width;\n                    var endY = this.destTop + this.destHeight < this.lowerCanvas.height ?\n                        this.destTop + this.destHeight : this.lowerCanvas.height;\n                    if (this.activeObj.activePoint.endX > endX || this.activeObj.activePoint.endY > endY) {\n                        this.activeObj.activePoint.endX += newScale.x;\n                        this.activeObj.activePoint.endY += newScale.y;\n                    }\n                }\n                else {\n                    width = x - this.activeObj.activePoint.endX;\n                    height = y - this.activeObj.activePoint.endY;\n                    scale = Math.max(width, height);\n                    var newScale = this.getScaleRatio(scale);\n                    this.activeObj.activePoint.endX += newScale.x;\n                    this.activeObj.activePoint.endY += newScale.y;\n                    var endX = this.destLeft + this.destWidth < this.lowerCanvas.width ? this.destLeft +\n                        this.destWidth : this.lowerCanvas.width;\n                    var endY = this.destTop + this.destHeight < this.lowerCanvas.height ? this.destTop +\n                        this.destHeight : this.lowerCanvas.height;\n                    if (this.activeObj.activePoint.endX > endX || this.activeObj.activePoint.endY > endY) {\n                        this.activeObj.activePoint.endX -= newScale.x;\n                        this.activeObj.activePoint.endY -= newScale.y;\n                    }\n                }\n            }\n            this.activeObj.activePoint.width = this.activeObj.activePoint.endX - this.activeObj.activePoint.startX;\n            this.activeObj.activePoint.height = this.activeObj.activePoint.endY - this.activeObj.activePoint.startY;\n            this.preventInverseResize(tempActiveObj);\n        }\n    };\n    ImageEditor.prototype.updateFontRatio = function (obj, isTextArea) {\n        var degree;\n        if (obj.shapeDegree === 0) {\n            degree = this.degree;\n        }\n        else {\n            degree = this.degree - obj.shapeDegree;\n        }\n        if (isNullOrUndefined(isTextArea)) {\n            if (degree === 0 || degree === 180) {\n                obj.textSettings.fontRatio = obj.activePoint.width / obj.textSettings.fontSize;\n            }\n            else {\n                obj.textSettings.fontRatio = obj.activePoint.height / obj.textSettings.fontSize;\n            }\n        }\n        else if (isTextArea) {\n            if (degree === 0 || degree === 180) {\n                obj.textSettings.fontRatio = this.textArea.clientWidth / parseFloat(this.textArea.style.fontSize);\n            }\n            else {\n                obj.textSettings.fontRatio = this.textArea.clientHeight / parseFloat(this.textArea.style.fontSize);\n            }\n        }\n    };\n    ImageEditor.prototype.updateFontSize = function (obj) {\n        var degree;\n        if (obj.shapeDegree === 0) {\n            degree = this.degree;\n        }\n        else {\n            degree = this.degree - obj.shapeDegree;\n        }\n        if (degree === 0 || degree === 180) {\n            obj.textSettings.fontSize = (obj.activePoint.width / obj.textSettings.fontRatio);\n        }\n        else {\n            obj.textSettings.fontSize = (obj.activePoint.height / obj.textSettings.fontRatio);\n        }\n    };\n    ImageEditor.prototype.preventInverseResize = function (tempActiveObj) {\n        if (this.activeObj.activePoint.width < 0) {\n            this.activeObj.activePoint.width = 0;\n            this.activeObj.activePoint.startX = tempActiveObj.activePoint.startX;\n            this.activeObj.activePoint.endX = tempActiveObj.activePoint.endX;\n        }\n        if (this.activeObj.activePoint.height < 0) {\n            this.activeObj.activePoint.height = 0;\n            this.activeObj.activePoint.startY = tempActiveObj.activePoint.startY;\n            this.activeObj.activePoint.endY = tempActiveObj.activePoint.endY;\n        }\n    };\n    ImageEditor.prototype.getScaleRatio = function (scale) {\n        var point = { x: scale, y: scale };\n        if (this.activeObj.shape !== 'crop-custom' && this.activeObj.shape !== 'crop-circle' && this.activeObj.shape !== 'crop-square') {\n            var ratio = this.activeObj.shape.split('-');\n            ratio = ratio[1].split(':');\n            var newScale = scale / (parseInt(ratio[1], 10));\n            point.x = newScale * (parseInt(ratio[0], 10));\n            point.y = newScale * (parseInt(ratio[1], 10));\n        }\n        return point;\n    };\n    ImageEditor.prototype.getMaxText = function (isTextBox, text) {\n        if (isNullOrUndefined(text)) {\n            text = isTextBox ? this.textArea.value : this.activeObj.keyHistory;\n        }\n        var maxi;\n        var rows = text.split('\\n');\n        var maxStr = rows[0].length;\n        var maxText = rows[0];\n        for (var i = 1; i < rows.length; i++) {\n            maxi = rows[i].length;\n            if (maxi > maxStr) {\n                maxText = rows[i];\n                maxStr = maxi;\n            }\n        }\n        return maxText;\n    };\n    ImageEditor.prototype.setDragLimit = function () {\n        if (this.activeObj.activePoint) {\n            if (this.activeObj.activePoint.startX < this.destLeft) {\n                this.activeObj.activePoint.startX = this.destLeft;\n                this.activeObj.activePoint.endX = this.activeObj.activePoint.startX + this.activeObj.activePoint.width;\n            }\n            else if (this.activeObj.activePoint.endX > this.destLeft + this.destWidth) {\n                this.activeObj.activePoint.endX = this.destLeft + this.destWidth;\n                this.activeObj.activePoint.startX = this.activeObj.activePoint.endX - this.activeObj.activePoint.width;\n            }\n            if (this.activeObj.activePoint.startY < this.destTop) {\n                this.activeObj.activePoint.startY = this.destTop;\n            }\n            else if (this.activeObj.activePoint.endY > this.destTop + this.destHeight) {\n                this.activeObj.activePoint.endY = this.destTop + this.destHeight;\n                this.activeObj.activePoint.startY = this.activeObj.activePoint.endY - this.activeObj.activePoint.height;\n            }\n            this.activeObj.activePoint.width = this.activeObj.activePoint.endX - this.activeObj.activePoint.startX;\n            this.activeObj.activePoint.height = this.activeObj.activePoint.endY - this.activeObj.activePoint.startY;\n        }\n    };\n    ImageEditor.prototype.lineDraw = function () {\n        if (this.activeObj.activePoint.height < 10) {\n            this.activeObj.activePoint.startY -= 10;\n            this.activeObj.activePoint.endY += 10;\n            this.activeObj.lineDraw = 'horizontal';\n        }\n        else if (this.activeObj.activePoint.width < 10) {\n            this.activeObj.activePoint.startX -= 10;\n            this.activeObj.activePoint.endX += 10;\n            this.activeObj.lineDraw = 'vertical';\n        }\n        else if (this.currObjType.isInitialLine) {\n            this.activeObj.lineDraw = 'normal';\n            this.currObjType.isInitialLine = false;\n        }\n        this.activeObj.activePoint.width = this.activeObj.activePoint.endX - this.activeObj.activePoint.startX;\n        this.activeObj.activePoint.height = this.activeObj.activePoint.endY - this.activeObj.activePoint.startY;\n    };\n    ImageEditor.prototype.shapeCircle = function (canvasDraw, selectionWidth, selectionHeight) {\n        canvasDraw.strokeStyle = this.themeColl[this.theme]['primaryColor'];\n        canvasDraw.clearRect(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n        canvasDraw.fillStyle = 'rgb(0, 0, 0, 0.5)';\n        canvasDraw.fillRect(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n        var tempWidth = canvasDraw.lineWidth;\n        canvasDraw.lineWidth = (2);\n        canvasDraw.beginPath();\n        canvasDraw.ellipse(this.activeObj.horTopLine.startX + (selectionWidth / 2), this.activeObj.horTopLine.startY\n            + (selectionHeight / 2), selectionWidth / 2, selectionHeight / 2, 0, 0, 2 * Math.PI, false);\n        canvasDraw.stroke();\n        canvasDraw.closePath();\n        canvasDraw.save();\n        canvasDraw.beginPath();\n        canvasDraw.arc(((this.activeObj.activePoint.endX - this.activeObj.activePoint.startX) / 2) + this.activeObj.activePoint.startX, ((this.activeObj.activePoint.endY - this.activeObj.activePoint.startY) / 2) + this.activeObj.activePoint.startY, (this.activeObj.activePoint.width / 2), 0, Math.PI * 2);\n        canvasDraw.closePath();\n        canvasDraw.clip();\n        canvasDraw.clearRect(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n        canvasDraw.restore();\n        canvasDraw.lineWidth = tempWidth;\n        this.drawOuterSelection(canvasDraw, true);\n        this.currObjType.shape = '';\n    };\n    ImageEditor.prototype.drawOuterSelection = function (canvasDraw, isCropCircle) {\n        var splitWords;\n        canvasDraw.lineWidth = (0.5);\n        if (this.activeObj.shape !== undefined) {\n            splitWords = this.activeObj.shape.split('-');\n        }\n        var tempObj = extend({}, this.activeObj, {}, true);\n        if (this.activeObj.shape !== undefined) {\n            splitWords = this.activeObj.shape.split('-');\n        }\n        if (((splitWords !== undefined && splitWords[0] === 'crop') || this.activeObj.shape === undefined) && !isCropCircle) {\n            this.upperContext.fillStyle = 'rgb(0, 0, 0, 0.5)';\n            this.upperContext.fillRect(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n            this.upperContext.clearRect(this.activeObj.activePoint.startX, this.activeObj.activePoint.startY, this.activeObj.activePoint.width, this.activeObj.activePoint.height);\n        }\n        canvasDraw.strokeStyle = this.themeColl[this.theme]['primaryColor'];\n        canvasDraw.fillStyle = this.themeColl[this.theme]['secondaryColor'];\n        if (this.activeObj.shape !== 'rectangle') {\n            canvasDraw.beginPath();\n            canvasDraw.rect(tempObj.activePoint.startX, tempObj.activePoint.startY, tempObj.activePoint.width, tempObj.activePoint.height);\n            canvasDraw.stroke();\n            canvasDraw.closePath();\n        }\n        canvasDraw.lineWidth *= 2;\n        canvasDraw.beginPath();\n        canvasDraw.moveTo(tempObj.topLeftCircle.startX, tempObj.topLeftCircle.startY);\n        canvasDraw.arc(tempObj.topLeftCircle.startX, tempObj.topLeftCircle.startY, tempObj.topLeftCircle.radius, 0, 2 * Math.PI);\n        canvasDraw.moveTo(tempObj.topRightCircle.startX, tempObj.topRightCircle.startY);\n        canvasDraw.arc(tempObj.topRightCircle.startX, tempObj.topRightCircle.startY, tempObj.topRightCircle.radius, 0, 2 * Math.PI);\n        canvasDraw.moveTo(tempObj.bottomLeftCircle.startX, tempObj.bottomLeftCircle.startY);\n        canvasDraw.arc(tempObj.bottomLeftCircle.startX, tempObj.bottomLeftCircle.startY, tempObj.bottomLeftCircle.radius, 0, 2 * Math.PI);\n        canvasDraw.moveTo(tempObj.bottomRightCircle.startX, tempObj.bottomRightCircle.startY);\n        canvasDraw.arc(tempObj.bottomRightCircle.startX, tempObj.bottomRightCircle.startY, tempObj.bottomRightCircle.radius, 0, 2 * Math.PI);\n        canvasDraw.stroke();\n        canvasDraw.fill();\n        canvasDraw.closePath();\n        canvasDraw.lineWidth /= 2;\n        if ((splitWords === undefined || splitWords[0] !== 'crop') && this.activeObj.shape !== 'text') {\n            this.drawCenterCircles(canvasDraw);\n        }\n        this.activeObj = extend({}, tempObj, {}, true);\n    };\n    ImageEditor.prototype.drawObject = function (canvas, obj, isCropRatio, points, isPreventDrag, saveContext) {\n        this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n        var canvasDraw;\n        if (canvas.toLowerCase() === 'original') {\n            canvasDraw = this.lowerContext;\n        }\n        else if (canvas.toLowerCase() === 'duplicate') {\n            canvasDraw = this.upperContext;\n        }\n        else if (!isNullOrUndefined(saveContext)) {\n            canvasDraw = saveContext;\n        }\n        if (!isPreventDrag && !isNullOrUndefined(this.activeObj.shape)) {\n            this.setDragLimit();\n        }\n        if (this.currObjType.isLine && canvas !== 'original' && !obj) {\n            this.lineDraw();\n        }\n        var splitWords = this.currObjType.shape.split('-');\n        if (splitWords[0].toLowerCase() === 'crop' && isCropRatio) {\n            this.drawCropRatio();\n        }\n        if (points) {\n            this.activeObj.activePoint.startX = points.startX;\n            this.activeObj.activePoint.startY = points.startY;\n            this.activeObj.activePoint.endX = points.endX;\n            this.activeObj.activePoint.endY = points.endY;\n            this.activeObj.activePoint.width = points.width;\n            this.activeObj.activePoint.height = points.height;\n        }\n        if (isNullOrUndefined(this.activeObj.strokeSettings)) {\n            this.activeObj.strokeSettings = this.strokeSettings;\n        }\n        if (isNullOrUndefined(this.activeObj.strokeSettings.strokeWidth)) {\n            this.activeObj.strokeSettings.strokeWidth = 4;\n        }\n        if (obj) {\n            this.activeObj = extend({}, obj, {}, true);\n        }\n        this.updateActiveObject();\n        if (this.currObjType.isText) {\n            this.activeObj.keyHistory = this.keyHistory;\n        }\n        if (canvas.toLowerCase() !== 'original') {\n            var splitWords_2;\n            var isCrop = false;\n            if (this.activeObj.shape) {\n                splitWords_2 = this.activeObj.shape.split('-');\n                if (splitWords_2[0] === 'crop') {\n                    isCrop = true;\n                }\n            }\n            if (isCrop) {\n                this.upperContext.fillStyle = 'rgb(0, 0, 0, 0.5)';\n                this.upperContext.fillRect(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n                this.upperContext.clearRect(this.activeObj.activePoint.startX, this.activeObj.activePoint.startY, this.activeObj.activePoint.width, this.activeObj.activePoint.height);\n            }\n            if (canvasDraw === this.lowerContext || canvasDraw === this.upperContext) {\n                this.drawOuterSelection(canvasDraw);\n            }\n        }\n        this.currObjType.isActiveObj = true;\n        if (obj) {\n            this.drawShapeObj(canvas, obj.shape, saveContext);\n        }\n        else if (this.keyHistory !== '' && this.currObjType.isText) {\n            this.drawShapeObj(canvas, 'text', saveContext);\n        }\n        else if (this.activeObj.shape) {\n            this.drawShapeObj(canvas, this.activeObj.shape, saveContext);\n        }\n        else {\n            this.drawShapeObj(canvas, undefined, saveContext);\n        }\n        if (this.isAllowCropPan) {\n            this.isAllowCropPan = false;\n            this.tempPanMove = extend({}, this.panMove, {}, true);\n            this.currentPannedPoint = this.updatePanPoints(this.getCurrentPanRegion());\n            this.rotatePan();\n        }\n    };\n    ImageEditor.prototype.rotateShape = function (canvasDraw) {\n        canvasDraw.beginPath();\n        canvasDraw.moveTo(this.activeObj.horTopLine.startX, this.activeObj.horTopLine.startY);\n        canvasDraw.lineTo(this.activeObj.horTopLine.endX, this.activeObj.horTopLine.endY);\n        canvasDraw.moveTo(this.activeObj.horBottomLine.startX, this.activeObj.horBottomLine.startY);\n        canvasDraw.lineTo(this.activeObj.horBottomLine.endX, this.activeObj.horBottomLine.endY);\n        canvasDraw.moveTo(this.activeObj.verLeftLine.startX, this.activeObj.verLeftLine.startY);\n        canvasDraw.lineTo(this.activeObj.verLeftLine.endX, this.activeObj.verLeftLine.endY);\n        canvasDraw.moveTo(this.activeObj.verRightLine.startX, this.activeObj.verRightLine.startY);\n        canvasDraw.lineTo(this.activeObj.verRightLine.endX, this.activeObj.verRightLine.endY);\n        canvasDraw.stroke();\n    };\n    ImageEditor.prototype.updateActiveObject = function (actPoint, obj, isMouseMove, x, y) {\n        actPoint = actPoint ? actPoint : extend({}, this.activeObj.activePoint, {}, true);\n        obj = obj ? obj : extend({}, this.activeObj, {}, true);\n        actPoint.width = actPoint.endX - actPoint.startX;\n        actPoint.height = actPoint.endY - actPoint.startY;\n        x = x ? x : 0;\n        y = y ? y : 0;\n        var horCircleWidth = actPoint.width / 2;\n        var verCircleHeight = actPoint.height / 2;\n        var radius = 7.5;\n        obj.horTopLine = { startX: actPoint.startX + x, startY: actPoint.startY - y,\n            endX: actPoint.endX + x, endY: actPoint.endY + y };\n        obj.horBottomLine = { startX: actPoint.startX - x, startY: actPoint.endY - y,\n            endX: actPoint.endX - x, endY: actPoint.endY + y };\n        obj.verLeftLine = { startX: actPoint.startX + x, startY: actPoint.startY - y,\n            endX: actPoint.startX - y, endY: actPoint.endY - y };\n        obj.verRightLine = { startX: actPoint.endX + x, startY: actPoint.startY + y,\n            endX: actPoint.endX - x, endY: actPoint.endY + y };\n        obj.topLeftCircle = { startX: actPoint.startX, startY: actPoint.startY,\n            radius: obj.horTopLine.endX ? (radius) : 0 };\n        obj.topCenterCircle = { startX: actPoint.startX + horCircleWidth, startY: actPoint.startY,\n            radius: obj.horTopLine.endX ? (radius) : 0 };\n        obj.topRightCircle = { startX: actPoint.endX, startY: actPoint.startY,\n            radius: obj.horTopLine.endX ? (radius) : 0 };\n        obj.centerLeftCircle = { startX: actPoint.startX, startY: actPoint.startY + verCircleHeight,\n            radius: obj.horTopLine.endX ? (radius) : 0 };\n        obj.centerRightCircle = { startX: actPoint.endX, startY: actPoint.startY + verCircleHeight,\n            radius: obj.horTopLine.endX ? (radius) : 0 };\n        obj.bottomLeftCircle = { startX: actPoint.startX, startY: actPoint.endY,\n            radius: obj.horTopLine.endX ? (radius) : 0 };\n        obj.bottomCenterCircle = { startX: actPoint.startX + horCircleWidth, startY: actPoint.endY,\n            radius: obj.horTopLine.endX ? (radius) : 0 };\n        obj.bottomRightCircle = { startX: actPoint.endX, startY: actPoint.endY,\n            radius: obj.horTopLine.endX ? (radius) : 0 };\n        obj.activePoint = actPoint;\n        if (isNullOrUndefined(isMouseMove)) {\n            this.activeObj = extend({}, obj, {}, true);\n        }\n    };\n    ImageEditor.prototype.drawShapeObj = function (canvas, shape, saveContext) {\n        var currentShape = shape !== undefined ? shape : this.currObjType.shape;\n        this.currObjType.shape = currentShape;\n        var canvasDraw;\n        if (canvas.toLowerCase() === 'original') {\n            canvasDraw = this.lowerContext;\n        }\n        else if (canvas.toLowerCase() === 'duplicate') {\n            canvasDraw = this.upperContext;\n        }\n        else if (!isNullOrUndefined(saveContext)) {\n            canvasDraw = saveContext;\n        }\n        if (this.currObjType.shape.toLowerCase() === 'rectangle' || this.currObjType.shape.toLowerCase() === 'ellipse'\n            || this.currObjType.shape.toLowerCase() === 'line') {\n            this.activeObj.shape = this.currObjType.shape;\n        }\n        canvasDraw.strokeStyle = this.activeObj.strokeSettings.strokeColor;\n        if (shape === 'text' || shape === 'freehanddraw') {\n            canvasDraw.fillStyle = this.activeObj.strokeSettings.strokeColor;\n        }\n        else {\n            canvasDraw.fillStyle = this.activeObj.strokeSettings.fillColor;\n        }\n        var horLineWidth = this.activeObj.activePoint.width / 3;\n        var verLineHeight = this.activeObj.activePoint.height / 3;\n        var selectionWidth = this.activeObj.activePoint.endX - this.activeObj.activePoint.startX;\n        var selectionHeight = this.activeObj.activePoint.endY - this.activeObj.activePoint.startY;\n        switch (this.currObjType.shape.toLowerCase()) {\n            case 'rectangle':\n                this.drawSquareLines(canvasDraw);\n                if (canvasDraw === this.upperContext) {\n                    this.drawOuterSelection(canvasDraw);\n                }\n                break;\n            case 'ellipse':\n                selectionWidth = Math.abs(selectionWidth);\n                selectionHeight = Math.abs(selectionHeight);\n                canvasDraw.beginPath();\n                canvasDraw.ellipse(this.activeObj.activePoint.startX + (selectionWidth / 2), this.activeObj.activePoint.startY + (selectionHeight / 2), selectionWidth / 2, selectionHeight / 2, 0, 0, 2 * Math.PI, false);\n                if (this.activeObj.strokeSettings.fillColor !== '') {\n                    canvasDraw.fillStyle = this.activeObj.strokeSettings.fillColor;\n                    canvasDraw.fill();\n                }\n                canvasDraw.ellipse(this.activeObj.activePoint.startX + (selectionWidth / 2), this.activeObj.activePoint.startY + (selectionHeight / 2), Math.abs((selectionWidth / 2) - (this.activeObj.strokeSettings.strokeWidth)), Math.abs((selectionHeight / 2) - (this.activeObj.strokeSettings.strokeWidth)), 0, 0, 2 * Math.PI, false);\n                canvasDraw.fillStyle = this.activeObj.strokeSettings.strokeColor;\n                canvasDraw.fill('evenodd');\n                canvasDraw.closePath();\n                if (canvasDraw === this.upperContext) {\n                    this.drawOuterSelection(canvasDraw);\n                }\n                break;\n            case 'crop-circle':\n                if (canvasDraw === this.lowerContext) {\n                    canvasDraw = this.upperContext;\n                }\n                this.shapeCircle(canvasDraw, selectionWidth, selectionHeight);\n                break;\n            case 'line':\n                this.shapeLine(canvasDraw, selectionWidth, selectionHeight);\n                if (canvasDraw === this.upperContext) {\n                    this.drawOuterSelection(canvasDraw);\n                }\n                break;\n            case 'text':\n                this.shapeText(canvasDraw);\n                break;\n            case 'crop-square':\n            case 'crop-3:4':\n            case 'crop-4:3':\n            case 'crop-6:9':\n            case 'crop-9:6':\n            case 'crop-9:16':\n            case 'crop-16:9':\n                if (canvasDraw === this.lowerContext) {\n                    canvasDraw = this.upperContext;\n                }\n                this.drawSelection(horLineWidth, verLineHeight);\n                this.currObjType.shape = '';\n                break;\n            default:\n                this.drawSelection(horLineWidth, verLineHeight);\n                break;\n        }\n    };\n    ImageEditor.prototype.shapeLine = function (canvasDraw, selectionWidth, selectionHeight) {\n        var startX;\n        var startY;\n        var endX;\n        var endY;\n        var degree;\n        if (this.activeObj.shapeDegree === 0) {\n            degree = this.degree;\n        }\n        else {\n            degree = this.degree - this.activeObj.shapeDegree;\n        }\n        if (degree === 0 || degree % 180 === 0) {\n            startX = this.activeObj.activePoint.startX;\n            startY = this.activeObj.activePoint.startY + (selectionHeight / 2);\n            endX = this.activeObj.activePoint.endX;\n            endY = this.activeObj.activePoint.startY + (selectionHeight / 2);\n        }\n        else {\n            startX = this.activeObj.activePoint.startX + (selectionWidth / 2);\n            startY = this.activeObj.activePoint.startY;\n            endX = this.activeObj.activePoint.startX + (selectionWidth / 2);\n            endY = this.activeObj.activePoint.endY;\n        }\n        var tempLineWidth = canvasDraw.lineWidth;\n        canvasDraw.lineWidth = (this.activeObj.strokeSettings.strokeWidth);\n        canvasDraw.beginPath();\n        switch (this.activeObj.lineDraw.toLowerCase()) {\n            case 'horizontal':\n            case 'vertical':\n                canvasDraw.moveTo(startX, startY);\n                canvasDraw.lineTo(endX, endY);\n                break;\n            case 'normal':\n                canvasDraw.moveTo(this.activeObj.horTopLine.startX, this.activeObj.horTopLine.startY);\n                canvasDraw.lineTo(this.activeObj.horBottomLine.endX, this.activeObj.horBottomLine.endY);\n                break;\n        }\n        canvasDraw.stroke();\n        canvasDraw.lineWidth = tempLineWidth;\n    };\n    ImageEditor.prototype.shapeText = function (canvasDraw) {\n        var rows = this.activeObj.keyHistory.split('\\n');\n        var height = this.activeObj.textSettings.fontSize + this.activeObj.textSettings.fontSize * 0.25;\n        var lineHeight = ((height * rows.length) - (this.activeObj.textSettings.fontSize * rows.length)) / rows.length;\n        for (var i = 0; i < rows.length; i++) {\n            var text = rows[i];\n            var yPoint = ((i + 1) * this.activeObj.textSettings.fontSize * 0.85) + (i * lineHeight);\n            if (this.degree === -360) {\n                this.degree = 0;\n            }\n            if (this.degree === 0 || this.degree === 180) {\n                if (this.activeObj.textSettings.fontSize > this.activeObj.activePoint.height) {\n                    this.activeObj.textSettings.fontSize = this.activeObj.activePoint.height -\n                        (this.activeObj.activePoint.height * 0.1);\n                }\n            }\n            else {\n                if (this.activeObj.textSettings.fontSize > this.activeObj.activePoint.width) {\n                    this.activeObj.textSettings.fontSize = this.activeObj.activePoint.width -\n                        (this.activeObj.activePoint.width * 0.1);\n                }\n            }\n            canvasDraw.strokeStyle = this.activeObj.strokeSettings.strokeColor;\n            canvasDraw.fillStyle = this.activeObj.strokeSettings.strokeColor;\n            var textStyle = '';\n            if (this.activeObj.textSettings.bold) {\n                textStyle = 'bold ';\n            }\n            if (this.activeObj.textSettings.italic) {\n                textStyle = 'italic ';\n            }\n            if (this.activeObj.textSettings.bold && this.activeObj.textSettings.italic) {\n                textStyle = 'italic bold ';\n            }\n            canvasDraw.font = textStyle + this.activeObj.textSettings.fontSize + 'px' + ' ' + this.activeObj.textSettings.fontFamily;\n            if (this.activeObj.flipObjColl.length === 4) {\n                this.activeObj.flipObjColl = [];\n            }\n            for (var j = 0; j < this.activeObj.flipObjColl.length; j++) {\n                if (this.activeObj.flipObjColl[j].toLowerCase() === 'horizontal') {\n                    canvasDraw.translate(canvasDraw.canvas.width, 0);\n                    canvasDraw.scale(-1, 1);\n                    this.updateActPoint('horizontal', canvasDraw);\n                }\n                else if (this.activeObj.flipObjColl[j].toLowerCase() === 'vertical') {\n                    canvasDraw.translate(0, canvasDraw.canvas.height);\n                    canvasDraw.scale(1, -1);\n                    this.updateActPoint('vertical', canvasDraw);\n                }\n            }\n            if (this.activeObj.shapeDegree !== this.degree) {\n                this.rotateText(canvasDraw);\n            }\n            else {\n                canvasDraw.fillText(text, this.activeObj.activePoint.startX + this.activeObj.textSettings.fontSize * 0.1, this.activeObj.activePoint.startY + yPoint);\n            }\n            for (var k = 0; k < this.activeObj.flipObjColl.length; k++) {\n                if (this.activeObj.flipObjColl[k].toLowerCase() === 'horizontal') {\n                    canvasDraw.translate(canvasDraw.canvas.width, 0);\n                    canvasDraw.scale(-1, 1);\n                    this.updateActPoint('horizontal', canvasDraw);\n                }\n                else if (this.activeObj.flipObjColl[k].toLowerCase() === 'vertical') {\n                    canvasDraw.translate(0, canvasDraw.canvas.height);\n                    canvasDraw.scale(1, -1);\n                    this.updateActPoint('vertical', canvasDraw);\n                }\n            }\n        }\n        this.currObjType.isText = false;\n    };\n    ImageEditor.prototype.updateActPoint = function (degree, canvasDraw) {\n        if (degree.toLowerCase() === 'horizontal') {\n            if (this.activeObj.activePoint.startX <= canvasDraw.canvas.width / 2) {\n                this.activeObj.activePoint.startX = canvasDraw.canvas.width / 2 + ((canvasDraw.canvas.width / 2) -\n                    this.activeObj.activePoint.endX);\n                this.activeObj.activePoint.endX = this.activeObj.activePoint.startX + this.activeObj.activePoint.width;\n                this.updateActiveObject(this.activeObj.activePoint, this.activeObj);\n            }\n            else if (this.activeObj.activePoint.startX >= canvasDraw.canvas.width / 2) {\n                this.activeObj.activePoint.startX = canvasDraw.canvas.width - this.activeObj.activePoint.endX;\n                this.activeObj.activePoint.endX = this.activeObj.activePoint.startX + this.activeObj.activePoint.width;\n                this.updateActiveObject(this.activeObj.activePoint, this.activeObj);\n            }\n        }\n        else if (degree.toLowerCase() === 'vertical') {\n            if (this.activeObj.activePoint.startY <= canvasDraw.canvas.height / 2) {\n                this.activeObj.activePoint.startY = canvasDraw.canvas.height / 2 + ((canvasDraw.canvas.height / 2) -\n                    this.activeObj.activePoint.endY);\n                this.activeObj.activePoint.endY = this.activeObj.activePoint.startY + this.activeObj.activePoint.height;\n                this.updateActiveObject(this.activeObj.activePoint, this.activeObj);\n            }\n            else if (this.activeObj.activePoint.startY >= canvasDraw.canvas.height / 2) {\n                this.activeObj.activePoint.startY = canvasDraw.canvas.height - this.activeObj.activePoint.endY;\n                this.activeObj.activePoint.endY = this.activeObj.activePoint.startY + this.activeObj.activePoint.height;\n                this.updateActiveObject(this.activeObj.activePoint, this.activeObj);\n            }\n        }\n    };\n    ImageEditor.prototype.drawSquareLines = function (canvasDraw) {\n        var splitWords;\n        if (this.activeObj.shape !== undefined) {\n            splitWords = this.activeObj.shape.split('-');\n        }\n        if (splitWords[0] === 'crop') {\n            canvasDraw.strokeStyle = '#fff';\n        }\n        else {\n            canvasDraw.strokeStyle = this.activeObj.strokeSettings.strokeColor;\n        }\n        canvasDraw.beginPath();\n        canvasDraw.rect(this.activeObj.activePoint.startX, this.activeObj.activePoint.startY, this.activeObj.activePoint.width, this.activeObj.activePoint.height);\n        if (this.activeObj.strokeSettings.fillColor !== '') {\n            canvasDraw.fillStyle = this.activeObj.strokeSettings.fillColor;\n            canvasDraw.fill();\n        }\n        canvasDraw.rect(this.activeObj.activePoint.startX + this.activeObj.strokeSettings.strokeWidth, this.activeObj.activePoint.startY + this.activeObj.strokeSettings.strokeWidth, this.activeObj.activePoint.width - (2 * this.activeObj.strokeSettings.strokeWidth), this.activeObj.activePoint.height - (2 * this.activeObj.strokeSettings.strokeWidth));\n        canvasDraw.fillStyle = this.activeObj.strokeSettings.strokeColor;\n        canvasDraw.fill('evenodd');\n        canvasDraw.closePath();\n    };\n    ImageEditor.prototype.drawSelection = function (horLineWidth, verLineHeight) {\n        this.upperContext.strokeStyle = this.themeColl[this.theme]['primaryColor'];\n        this.upperContext.beginPath();\n        this.activeObj.horTopInnerLine = { startX: this.activeObj.activePoint.startX, startY: this.activeObj.activePoint.startY +\n                verLineHeight, endX: this.activeObj.activePoint.endX, endY: this.activeObj.activePoint.endY + verLineHeight };\n        this.activeObj.horBottomInnerLine = { startX: this.activeObj.activePoint.startX, startY: this.activeObj.activePoint.startY +\n                (2 * verLineHeight), endX: this.activeObj.activePoint.endX, endY: this.activeObj.activePoint.endY + (2 * verLineHeight) };\n        this.activeObj.verLeftInnerLine = { startX: this.activeObj.activePoint.startX + horLineWidth,\n            startY: this.activeObj.activePoint.startY, endX: this.activeObj.activePoint.startX + horLineWidth,\n            endY: this.activeObj.activePoint.endY };\n        this.activeObj.verRightInnerLine = { startX: this.activeObj.activePoint.startX + (2 * horLineWidth),\n            startY: this.activeObj.activePoint.startY, endX: this.activeObj.activePoint.startX + (2 * horLineWidth),\n            endY: this.activeObj.activePoint.endY };\n        this.upperContext.moveTo(this.activeObj.horTopInnerLine.startX, this.activeObj.horTopInnerLine.startY);\n        this.upperContext.lineTo(this.activeObj.horTopInnerLine.endX, this.activeObj.horTopInnerLine.startY);\n        this.upperContext.moveTo(this.activeObj.horBottomInnerLine.startX, this.activeObj.horBottomInnerLine.startY);\n        this.upperContext.lineTo(this.activeObj.horBottomInnerLine.endX, this.activeObj.horBottomInnerLine.startY);\n        this.upperContext.moveTo(this.activeObj.verLeftInnerLine.startX, this.activeObj.verLeftInnerLine.startY);\n        this.upperContext.lineTo(this.activeObj.verLeftInnerLine.endX, this.activeObj.verLeftInnerLine.endY);\n        this.upperContext.moveTo(this.activeObj.verRightInnerLine.startX, this.activeObj.verRightInnerLine.startY);\n        this.upperContext.lineTo(this.activeObj.verRightInnerLine.endX, this.activeObj.verRightInnerLine.endY);\n        this.upperContext.stroke();\n        this.upperContext.closePath();\n    };\n    ImageEditor.prototype.drawCenterCircles = function (canvasDraw) {\n        canvasDraw.lineWidth *= 2;\n        canvasDraw.beginPath();\n        canvasDraw.moveTo(this.activeObj.topCenterCircle.startX, this.activeObj.topCenterCircle.startY);\n        canvasDraw.arc(this.activeObj.topCenterCircle.startX, this.activeObj.topCenterCircle.startY, this.activeObj.topCenterCircle.radius, 0, 2 * Math.PI);\n        canvasDraw.moveTo(this.activeObj.centerLeftCircle.startX, this.activeObj.centerLeftCircle.startY);\n        canvasDraw.arc(this.activeObj.centerLeftCircle.startX, this.activeObj.centerLeftCircle.startY, this.activeObj.centerLeftCircle.radius, 0, 2 * Math.PI);\n        canvasDraw.moveTo(this.activeObj.centerRightCircle.startX, this.activeObj.centerRightCircle.startY);\n        canvasDraw.arc(this.activeObj.centerRightCircle.startX, this.activeObj.centerRightCircle.startY, this.activeObj.centerRightCircle.radius, 0, 2 * Math.PI);\n        canvasDraw.moveTo(this.activeObj.bottomCenterCircle.startX, this.activeObj.bottomCenterCircle.startY);\n        canvasDraw.arc(this.activeObj.bottomCenterCircle.startX, this.activeObj.bottomCenterCircle.startY, this.activeObj.bottomCenterCircle.radius, 0, 2 * Math.PI);\n        canvasDraw.stroke();\n        canvasDraw.fill();\n        canvasDraw.closePath();\n        canvasDraw.lineWidth /= 2;\n    };\n    ImageEditor.prototype.findTarget = function (x, y, type) {\n        if (type.toLowerCase() === 'mousedown' || type.toLowerCase() === 'touchstart') {\n            var splitWords = void 0;\n            var isCrop = false;\n            if (this.activeObj.shape) {\n                splitWords = this.activeObj.shape.split('-');\n                if (splitWords[0] === 'crop') {\n                    isCrop = true;\n                }\n            }\n            this.findTargetObj(x, y, isCrop);\n            this.updateCursorStyles(x, y, type);\n        }\n        else {\n            switch (this.dragElement.toLowerCase()) {\n                case 'nw-resize':\n                    this.activeObj.topLeftCircle.startX = x;\n                    this.activeObj.topLeftCircle.startY = y;\n                    break;\n                case 'n-resize':\n                    this.activeObj.topCenterCircle.startX = x;\n                    this.activeObj.topCenterCircle.startY = y;\n                    break;\n                case 'ne-resize':\n                    this.activeObj.topRightCircle.startX = x;\n                    this.activeObj.topRightCircle.startY = y;\n                    break;\n                case 'w-resize':\n                    this.activeObj.centerLeftCircle.startX = x;\n                    this.activeObj.centerLeftCircle.startY = y;\n                    break;\n                case 'e-resize':\n                    this.activeObj.centerRightCircle.startX = x;\n                    this.activeObj.centerRightCircle.startY = y;\n                    break;\n                case 'sw-resize':\n                    this.activeObj.bottomLeftCircle.startX = x;\n                    this.activeObj.bottomLeftCircle.startY = y;\n                    break;\n                case 's-resize':\n                    this.activeObj.bottomCenterCircle.startX = x;\n                    this.activeObj.bottomCenterCircle.startY = y;\n                    break;\n                case 'se-resize':\n                    this.activeObj.bottomRightCircle.startX = x;\n                    this.activeObj.bottomRightCircle.startY = y;\n                    break;\n                default:\n                    if (this.dragPoint.startX && this.dragPoint.startY) {\n                        this.previousPoint.x = this.dragPoint.endX;\n                        this.previousPoint.y = this.dragPoint.endY;\n                        this.dragPoint.endX = x;\n                        this.dragPoint.endY = y;\n                    }\n                    break;\n            }\n        }\n    };\n    ImageEditor.prototype.findTargetObj = function (x, y, isCrop) {\n        var isShape;\n        if (this.objColl.length !== 0 && !this.currObjType.isCustomCrop && !isCrop) {\n            var diffX = 0;\n            var i = void 0;\n            for (var index = 0; index < this.objColl.length; index++) {\n                var actObj = extend({}, this.objColl[index], {}, true);\n                if (x >= (actObj.activePoint.startX - (actObj.topLeftCircle.radius * 2)) &&\n                    x <= (actObj.activePoint.endX + (actObj.topLeftCircle.radius * 2)) &&\n                    y >= (actObj.activePoint.startY - (actObj.topLeftCircle.radius * 2)) &&\n                    y <= (actObj.activePoint.endY + (actObj.topLeftCircle.radius * 2))) {\n                    if (this.isTouch || this.upperCanvas.style.cursor === 'move' || this.upperCanvas.style.cursor === 'grab' || this.isShapeInserted) {\n                        if (diffX === 0 || diffX > x - actObj.activePoint.startX) {\n                            diffX = x - this.objColl[index].activePoint.startX;\n                            i = index;\n                        }\n                    }\n                    else if (this.objColl[index].currIndex === this.tempActiveObj.currIndex) {\n                        i = index;\n                    }\n                }\n            }\n            if (isNullOrUndefined(i)) {\n                this.refreshActiveObj();\n                isShape = false;\n            }\n            else {\n                this.tempObjColl = extend([], this.objColl, [], true);\n                this.currObjType.isCustomCrop = false;\n                this.activeObj = extend({}, this.objColl[i], {}, true);\n                var temp = extend({}, this.objColl[i], {}, true);\n                this.objColl.splice(i, 1);\n                if (this.degree === 0) {\n                    this.lowerContext.clearRect(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n                    this.updateBrightnessFilter();\n                    this.lowerContext.drawImage(this.baseImg, this.srcLeft, this.srcTop, this.srcWidth, this.srcHeight, this.destLeft, this.destTop, this.destWidth, this.destHeight);\n                    var temp_2 = this.lowerContext.filter;\n                    this.lowerContext.filter = 'none';\n                    this.iterateObjColl();\n                    this.activeObj = extend({}, temp_2, {}, true);\n                    this.freehandRedraw(this.lowerContext);\n                    this.lowerContext.filter = temp_2;\n                    this.getCurrentFlipState();\n                }\n                else {\n                    this.callUpdateCurrentTransformedState();\n                    this.freehandRedraw(this.lowerContext);\n                }\n                this.clearOuterCanvas(this.lowerContext);\n                if ((!isNullOrUndefined(this.currSelectionPoint) && this.currSelectionPoint.shape === 'crop-circle') || this.isCircleCrop) {\n                    this.cropCircle(this.lowerContext);\n                }\n                this.setActivePoint();\n                this.activeObj = extend({}, temp, {}, true);\n                this.tempStrokeSettings = extend({}, this.activeObj.strokeSettings, {}, true);\n                this.tempTextSettings = extend({}, this.activeObj.textSettings, {}, true);\n                var shapeSettings = this.updatePreviousShapeSettings();\n                var shapeChangingArgs = { action: 'select', previousShapeSettings: shapeSettings,\n                    currentShapeSettings: shapeSettings };\n                this.trigger('shapeChanging', shapeChangingArgs);\n                this.updateShapeChangeEventArgs(shapeChangingArgs.currentShapeSettings);\n                if (this.activeObj.activePoint) {\n                    this.drawObject('duplicate', this.activeObj, null, null, true);\n                    if (this.activeObj.activePoint.startX < this.destLeft) {\n                        this.isPreventDragging = true;\n                    }\n                    else if (this.activeObj.activePoint.endX > this.destLeft + this.destWidth) {\n                        this.isPreventDragging = true;\n                    }\n                    else if (this.activeObj.activePoint.startY < this.destTop) {\n                        this.isPreventDragging = true;\n                    }\n                    else if (this.activeObj.activePoint.endY > this.destTop + this.destHeight) {\n                        this.isPreventDragging = true;\n                    }\n                }\n                isShape = true;\n            }\n        }\n        return isShape;\n    };\n    ImageEditor.prototype.getCurrentFlipState = function () {\n        if (this.rotateFlipColl.length !== 0) {\n            var totalPannedInternalPoint = extend({}, this.totalPannedInternalPoint, {}, true);\n            this.callUpdateCurrentTransformedState();\n            this.totalPannedInternalPoint = totalPannedInternalPoint;\n        }\n        else {\n            this.callUpdateCurrentTransformedState();\n        }\n    };\n    ImageEditor.prototype.rotateDegree = function (degree) {\n        this.lowerContext.save();\n        this.lowerContext.clearRect(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n        this.lowerContext.translate(this.lowerCanvas.width / 2, this.lowerCanvas.height / 2);\n        this.lowerContext.rotate(Math.PI / 180 * degree);\n        this.lowerContext.translate(-this.lowerCanvas.width / 2, -this.lowerCanvas.height / 2);\n        var temp = this.lowerContext.filter;\n        this.updateBrightnessFilter();\n        this.lowerContext.drawImage(this.baseImg, this.srcLeft, this.srcTop, this.srcWidth, this.srcHeight, this.destLeft, this.destTop, this.destWidth, this.destHeight);\n        this.lowerContext.filter = temp;\n        this.lowerContext.translate(this.lowerCanvas.width / 2, this.lowerCanvas.height / 2);\n        this.lowerContext.rotate(Math.PI / 180 * -degree);\n        this.lowerContext.translate(-this.lowerCanvas.width / 2, -this.lowerCanvas.height / 2);\n        this.lowerContext.restore();\n    };\n    ImageEditor.prototype.updateCursorStyles = function (x, y, type) {\n        var isResize = false;\n        if (this.activeObj.keyHistory !== '' && this.activeObj.shape === undefined && !this.currObjType.isCustomCrop &&\n            !this.currObjType.isLine && this.currObjType.isText) {\n            this.activeObj.shape = 'text';\n        }\n        var actObj = extend({}, this.activeObj, {}, true);\n        if (isNullOrUndefined(actObj.topLeftCircle)) {\n            return;\n        }\n        if (x >= (actObj.topLeftCircle.startX - (actObj.topLeftCircle.radius * 2)) &&\n            x <= (actObj.topLeftCircle.startX + (actObj.topLeftCircle.radius * 2)) &&\n            y >= (actObj.topLeftCircle.startY - (actObj.topLeftCircle.radius * 2)) &&\n            y <= (actObj.topLeftCircle.startY + (actObj.topLeftCircle.radius * 2)) && this.dragElement !== 'nw-resize') {\n            actObj.topLeftCircle.startX = actObj.topLeftCircle.startY = 0;\n            this.upperCanvas.style.cursor = 'nw-resize';\n            isResize = true;\n            this.dragElement = this.upperCanvas.style.cursor;\n        }\n        else if (x >= (actObj.topCenterCircle.startX - (actObj.topLeftCircle.radius * 2)) &&\n            x <= (actObj.topCenterCircle.startX + (actObj.topLeftCircle.radius * 2)) &&\n            y >= (actObj.topCenterCircle.startY - (actObj.topLeftCircle.radius * 2)) &&\n            y <= (actObj.topCenterCircle.startY + (actObj.topLeftCircle.radius * 2)) && this.dragElement !== 'n-resize') {\n            actObj.topCenterCircle.startX = actObj.topCenterCircle.startY = 0;\n            this.upperCanvas.style.cursor = 'n-resize';\n            isResize = true;\n            this.dragElement = this.upperCanvas.style.cursor;\n        }\n        else if (x >= (actObj.topRightCircle.startX - (actObj.topLeftCircle.radius * 2)) &&\n            x <= (actObj.topRightCircle.startX + (actObj.topLeftCircle.radius * 2)) &&\n            y >= (actObj.topRightCircle.startY - (actObj.topLeftCircle.radius * 2)) &&\n            y <= (actObj.topRightCircle.startY + (actObj.topLeftCircle.radius * 2)) && this.dragElement !== 'ne-resize') {\n            actObj.topRightCircle.startX = actObj.topRightCircle.startY = 0;\n            this.upperCanvas.style.cursor = 'ne-resize';\n            isResize = true;\n            this.dragElement = this.upperCanvas.style.cursor;\n        }\n        else if (x >= (actObj.centerLeftCircle.startX - (actObj.topLeftCircle.radius * 2)) &&\n            x <= (actObj.centerLeftCircle.startX + (actObj.topLeftCircle.radius * 2)) &&\n            y >= (actObj.centerLeftCircle.startY - (actObj.topLeftCircle.radius * 2)) &&\n            y <= (actObj.centerLeftCircle.startY + (actObj.topLeftCircle.radius * 2)) && this.dragElement !== 'w-resize') {\n            actObj.centerLeftCircle.startX = actObj.centerLeftCircle.startY = 0;\n            this.upperCanvas.style.cursor = 'w-resize';\n            isResize = true;\n            this.dragElement = this.upperCanvas.style.cursor;\n        }\n        else if (x >= (actObj.centerRightCircle.startX - (actObj.topLeftCircle.radius * 2)) &&\n            x <= (actObj.centerRightCircle.startX + (actObj.topLeftCircle.radius * 2)) &&\n            y >= (actObj.centerRightCircle.startY - (actObj.topLeftCircle.radius * 2)) &&\n            y <= (actObj.centerRightCircle.startY + (actObj.topLeftCircle.radius * 2)) && this.dragElement !== 'e-resize') {\n            actObj.centerRightCircle.startX = actObj.centerRightCircle.startY = 0;\n            this.upperCanvas.style.cursor = 'e-resize';\n            isResize = true;\n            this.dragElement = this.upperCanvas.style.cursor;\n        }\n        else if (x >= (actObj.bottomLeftCircle.startX - (actObj.topLeftCircle.radius * 2)) &&\n            x <= (actObj.bottomLeftCircle.startX + (actObj.topLeftCircle.radius * 2)) &&\n            y >= (actObj.bottomLeftCircle.startY - (actObj.topLeftCircle.radius * 2)) &&\n            y <= (actObj.bottomLeftCircle.startY + (actObj.topLeftCircle.radius * 2)) && this.dragElement !== 'sw-resize') {\n            actObj.bottomLeftCircle.startX = actObj.bottomLeftCircle.startY = 0;\n            this.upperCanvas.style.cursor = 'sw-resize';\n            isResize = true;\n            this.dragElement = this.upperCanvas.style.cursor;\n        }\n        else if (x >= (actObj.bottomCenterCircle.startX - (actObj.topLeftCircle.radius * 2)) &&\n            x <= (actObj.bottomCenterCircle.startX + (actObj.topLeftCircle.radius * 2)) &&\n            y >= (actObj.bottomCenterCircle.startY - (actObj.topLeftCircle.radius * 2)) &&\n            y <= (actObj.bottomCenterCircle.startY + (actObj.topLeftCircle.radius * 2)) && this.dragElement !== 's-resize') {\n            actObj.bottomCenterCircle.startX = actObj.bottomCenterCircle.startY = 0;\n            this.upperCanvas.style.cursor = 's-resize';\n            isResize = true;\n            this.dragElement = this.upperCanvas.style.cursor;\n        }\n        else if (x >= (actObj.bottomRightCircle.startX - (actObj.topLeftCircle.radius * 2)) &&\n            x <= (actObj.bottomRightCircle.startX + (actObj.topLeftCircle.radius * 2)) &&\n            y >= (actObj.bottomRightCircle.startY - (actObj.topLeftCircle.radius * 2)) &&\n            y <= (actObj.bottomRightCircle.startY + (actObj.topLeftCircle.radius * 2)) && this.dragElement !== 'se-resize') {\n            actObj.bottomRightCircle.startX = actObj.bottomRightCircle.startY = 0;\n            this.upperCanvas.style.cursor = 'se-resize';\n            isResize = true;\n            this.dragElement = this.upperCanvas.style.cursor;\n        }\n        else {\n            this.dragPoint.startX = this.previousPoint.x = this.dragPoint.endX = x;\n            this.dragPoint.startY = this.previousPoint.y = this.dragPoint.endY = y;\n        }\n        this.previousPoint.x = this.previousPoint.y = this.diffPoint.x = this.diffPoint.y = 0;\n        if (type === 'touchstart') {\n            if (isResize || (x >= actObj.activePoint.startX && x <= actObj.activePoint.endX\n                && y >= actObj.activePoint.startY && y <= actObj.activePoint.endY)) {\n                this.currObjType.isDragging = true;\n            }\n        }\n        else {\n            this.currObjType.isDragging = true;\n        }\n    };\n    ImageEditor.prototype.drawCropRatio = function () {\n        var x;\n        var y;\n        var width;\n        var height;\n        if (this.zoomFactor > 0 && !isNullOrUndefined(this.currentSelectionPoint)) {\n            //width = this.currentSelectionPoint.activePoint.width; height = this.currentSelectionPoint.activePoint.height;\n            if (this.destLeft + this.destLeft + this.destWidth <= this.lowerCanvas.clientWidth) {\n                width = this.destWidth;\n                if (this.destLeft < 0) {\n                    width += (2 * this.destLeft);\n                }\n            }\n            else {\n                width = this.lowerCanvas.clientWidth;\n            }\n            if (this.destTop + this.destTop + this.destHeight <= this.lowerCanvas.clientHeight) {\n                height = this.destHeight;\n                if (this.destTop < 0) {\n                    height += (2 * this.destTop);\n                }\n            }\n            else {\n                height = this.lowerCanvas.clientHeight;\n            }\n            if (this.degree !== 0) {\n                this.isAllowCropPan = true;\n            }\n        }\n        else {\n            width = this.destWidth;\n            height = this.destHeight;\n            if (this.destLeft < 0) {\n                width += this.destLeft;\n            }\n            if (this.destTop < 0) {\n                height += this.destTop;\n            }\n            if (this.currObjType.shape.toLowerCase() !== 'crop-square' && this.currObjType.shape.toLowerCase() !== 'crop-circle') {\n                if (this.destLeft + this.destWidth > this.lowerCanvas.width) {\n                    width -= (this.destLeft + this.destWidth - this.lowerCanvas.width);\n                }\n                if (this.destTop + this.destHeight > this.lowerCanvas.height) {\n                    height -= (this.destTop + this.destHeight - this.lowerCanvas.height);\n                }\n            }\n        }\n        switch (this.currObjType.shape.toLowerCase()) {\n            case 'crop-square':\n            case 'crop-circle':\n                this.setDragDirection(width, height);\n                if (width === this.destWidth && height === this.destHeight) {\n                    this.activeObj.activePoint.startX += this.destLeft;\n                    this.activeObj.activePoint.startY += this.destTop;\n                    this.activeObj.activePoint.endX += this.destLeft;\n                    this.activeObj.activePoint.endY += this.destTop;\n                }\n                if (this.lowerCanvas.width > this.lowerCanvas.height) {\n                    this.activeObj.activePoint.height = this.activeObj.activePoint.endY - this.activeObj.activePoint.startY;\n                    this.activeObj.activePoint.width = this.activeObj.activePoint.height;\n                    this.activeObj.activePoint.endX = this.activeObj.activePoint.startX + this.activeObj.activePoint.width;\n                }\n                else {\n                    this.activeObj.activePoint.width = this.activeObj.activePoint.endX - this.activeObj.activePoint.startX;\n                    this.activeObj.activePoint.height = this.activeObj.activePoint.width;\n                    this.activeObj.activePoint.endY = this.activeObj.activePoint.startY + this.activeObj.activePoint.height;\n                }\n                break;\n            case 'crop-3:2':\n                x = 3;\n                y = 2;\n                break;\n            case 'crop-4:3':\n                x = 4;\n                y = 3;\n                break;\n            case 'crop-5:4':\n                x = 5;\n                y = 4;\n                break;\n            case 'crop-7:5':\n                x = 7;\n                y = 5;\n                break;\n            case 'crop-16:9':\n                x = 16;\n                y = 9;\n                break;\n        }\n        if (x !== undefined && y !== undefined) {\n            this.calcShapeRatio(x, y, width, height);\n            if (width === this.destWidth && height === this.destHeight) {\n                this.updatePoints();\n            }\n        }\n        // Set Selection inside image\n        if (!isNullOrUndefined(this.currentSelectionPoint)) {\n            if (this.activeObj.activePoint.startX < this.currentSelectionPoint.activePoint.startX) {\n                var diff = this.currentSelectionPoint.activePoint.startX - this.activeObj.activePoint.startX;\n                this.activeObj.activePoint.startX += diff;\n                this.activeObj.activePoint.endX += diff;\n            }\n            if (this.activeObj.activePoint.startY < this.currentSelectionPoint.activePoint.startY) {\n                var diff = this.currentSelectionPoint.activePoint.startY - this.activeObj.activePoint.startY;\n                this.activeObj.activePoint.startY += diff;\n                this.activeObj.activePoint.endY += diff;\n            }\n            if (this.activeObj.activePoint.endX > this.currentSelectionPoint.activePoint.endX) {\n                var diff = this.activeObj.activePoint.endX - this.currentSelectionPoint.activePoint.endX;\n                this.activeObj.activePoint.startX -= diff;\n                this.activeObj.activePoint.endX -= diff;\n            }\n            if (this.activeObj.activePoint.endY > this.currentSelectionPoint.activePoint.endY) {\n                var diff = this.activeObj.activePoint.endY - this.currentSelectionPoint.activePoint.endY;\n                this.activeObj.activePoint.startY -= diff;\n                this.activeObj.activePoint.endY -= diff;\n            }\n            this.activeObj.activePoint.startX = (this.lowerCanvas.clientWidth - this.activeObj.activePoint.width) / 2;\n            this.activeObj.activePoint.startY = (this.lowerCanvas.clientHeight - this.activeObj.activePoint.height) / 2;\n            this.activeObj.activePoint.endX = this.activeObj.activePoint.startX + this.activeObj.activePoint.width;\n            this.activeObj.activePoint.endY = this.activeObj.activePoint.startY + this.activeObj.activePoint.height;\n        }\n        if (this.zoomFactor === 0) {\n            if (this.activeObj.activePoint.startX < this.destLeft) {\n                var diff = (this.destLeft - this.activeObj.activePoint.startX) + 7.5;\n                this.activeObj.activePoint.startX += diff;\n                this.activeObj.activePoint.endX += diff;\n            }\n            if (this.activeObj.activePoint.startY < this.destTop) {\n                var diff = (this.destTop - this.activeObj.activePoint.startY) + 7.5;\n                this.activeObj.activePoint.startY += diff;\n                this.activeObj.activePoint.endY += diff;\n            }\n            this.activeObj.activePoint.width = this.activeObj.activePoint.endX - this.activeObj.activePoint.startX;\n            this.activeObj.activePoint.height = this.activeObj.activePoint.endY - this.activeObj.activePoint.startY;\n        }\n    };\n    ImageEditor.prototype.setDragDirection = function (width, height) {\n        var arcRadius = (7.5);\n        if (this.destWidth > this.destHeight) {\n            this.activeObj.activePoint.startX = this.dragPoint.startX = ((width / 2) - (height / 2))\n                + arcRadius;\n            this.activeObj.activePoint.startY = this.dragPoint.startY = ((height / 2) - (height / 2))\n                + arcRadius;\n            this.activeObj.activePoint.endX = ((width / 2) + (height / 2)) - arcRadius;\n            this.activeObj.activePoint.endY = ((height / 2) + (height / 2)) - arcRadius;\n        }\n        else {\n            this.activeObj.activePoint.startY = this.dragPoint.startX = ((height / 2) - (width) / 2)\n                + arcRadius;\n            this.activeObj.activePoint.endY = ((height / 2) + (width) / 2) - arcRadius;\n            this.activeObj.activePoint.startX = this.dragPoint.startX = arcRadius;\n            this.activeObj.activePoint.endX = width - arcRadius;\n        }\n    };\n    ImageEditor.prototype.updatePoints = function () {\n        this.activeObj.activePoint.startX += this.destLeft;\n        this.activeObj.activePoint.startY += this.destTop;\n        this.activeObj.activePoint.endX += this.destLeft;\n        this.activeObj.activePoint.endY += this.destTop;\n        this.activeObj.activePoint.width = this.activeObj.activePoint.endX - this.activeObj.activePoint.startX;\n        this.activeObj.activePoint.height = this.activeObj.activePoint.endY - this.activeObj.activePoint.startY;\n    };\n    ImageEditor.prototype.calcShapeRatio = function (x, y, imgWidth, imgHeight) {\n        var arcRadius = (7.5);\n        var originalWidth = imgWidth;\n        var originalHeight = imgHeight;\n        var presetRatio = x / y;\n        var standardSize = originalWidth >= originalHeight ? originalWidth : originalHeight;\n        var width = standardSize * presetRatio;\n        var height = standardSize;\n        var scaleWidth = this.getScale(width, originalWidth);\n        var snippetArray = [];\n        for (var i = 0; i < 2; i++) {\n            if (i === 0) {\n                snippetArray.push(width * scaleWidth);\n            }\n            else {\n                snippetArray.push(height * scaleWidth);\n            }\n        }\n        width = snippetArray[0];\n        height = snippetArray[1];\n        var scaleHeight = this.getScale(height, originalHeight);\n        var snippetArray1 = [];\n        for (var i = 0; i < 2; i++) {\n            if (i === 0) {\n                snippetArray1.push(width * scaleHeight);\n            }\n            else {\n                snippetArray1.push(height * scaleHeight);\n            }\n        }\n        width = snippetArray1[0];\n        height = snippetArray1[1];\n        this.activeObj.activePoint.width = width;\n        this.activeObj.activePoint.height = height;\n        this.activeObj.activePoint.startX = (this.dragPoint.startX = (originalWidth - width) / 2) + arcRadius;\n        this.activeObj.activePoint.startY = (this.dragPoint.startY = (originalHeight - height) / 2) + arcRadius;\n        this.activeObj.activePoint.endX = ((originalWidth - width) / 2 + width) - arcRadius;\n        this.activeObj.activePoint.endY = ((originalHeight - height) / 2 + height) - arcRadius;\n        if (this.activeObj.activePoint.startX < this.destLeft && this.destLeft + this.destWidth > this.lowerCanvas.clientWidth) {\n            this.activeObj.activePoint.startX = this.destLeft;\n            this.activeObj.activePoint.endX = this.activeObj.activePoint.startX + width;\n        }\n        if (this.activeObj.activePoint.startY < this.destTop && this.destTop + this.destHeight > this.lowerCanvas.clientHeight) {\n            this.activeObj.activePoint.startY = this.destTop;\n            this.activeObj.activePoint.endY = this.activeObj.activePoint.startY + height;\n        }\n        this.activeObj.activePoint.width = this.activeObj.activePoint.endX - this.activeObj.activePoint.startX;\n        this.activeObj.activePoint.height = this.activeObj.activePoint.endY - this.activeObj.activePoint.startY;\n    };\n    ImageEditor.prototype.getScale = function (value, originalValue) {\n        return value > originalValue ? originalValue / value : 1;\n    };\n    ImageEditor.prototype.calcMaxDimension = function (width, height) {\n        var canvasMaxWidth = this.element.clientWidth;\n        var canvasMaxHeight = this.element.clientHeight - this.toolbarHeight;\n        canvasMaxHeight = Browser.isDevice ? canvasMaxHeight - this.toolbarHeight : canvasMaxHeight;\n        canvasMaxWidth -= 30;\n        canvasMaxHeight -= 30;\n        var widthScale = canvasMaxWidth / width;\n        var heightScale = canvasMaxHeight / height;\n        var cssMaxWidth = Math.min(width, canvasMaxWidth);\n        var cssMaxHeight = Math.min(height, canvasMaxHeight);\n        if (widthScale < 1 && widthScale < heightScale) {\n            cssMaxWidth = width * widthScale;\n            cssMaxHeight = height * widthScale;\n        }\n        else if (heightScale < 1 && heightScale < widthScale) {\n            cssMaxWidth = width * heightScale;\n            cssMaxHeight = height * heightScale;\n        }\n        return { width: cssMaxWidth, height: cssMaxHeight };\n    };\n    ImageEditor.prototype.setMaximumDimension = function (degree, tempCanvas) {\n        var newWidth;\n        var newHeight;\n        if (degree % 90 === 0 && degree % 180 !== 0) {\n            newWidth = this.baseImg.height;\n            newHeight = this.baseImg.width;\n        }\n        else if (degree % 180 === 0 || degree === 0) {\n            newWidth = this.baseImg.width;\n            newHeight = this.baseImg.height;\n        }\n        tempCanvas.width = newWidth;\n        tempCanvas.height = newHeight;\n        var maxDimension = this.calcMaxDimension(newWidth, newHeight);\n        tempCanvas.style.maxWidth = maxDimension.width + 'px';\n        tempCanvas.style.maxHeight = maxDimension.height + 'px';\n    };\n    ImageEditor.prototype.setCursor = function (x, y) {\n        var isCropSelection = false;\n        var splitWords;\n        if (this.activeObj.horTopLine !== undefined) {\n            if (this.activeObj.shape !== undefined) {\n                splitWords = this.activeObj.shape.split('-');\n            }\n            if (splitWords === undefined && this.currObjType.isCustomCrop) {\n                isCropSelection = true;\n            }\n            else if (splitWords !== undefined && splitWords[0] === 'crop') {\n                isCropSelection = true;\n            }\n            if (!isCropSelection && this.togglePan) {\n                this.lowerCanvas.style.cursor = this.upperCanvas.style.cursor = 'grab';\n            }\n            var cursor = this.upperCanvas.style.cursor;\n            var actObj = extend({}, this.activeObj, {}, true);\n            if (x >= (actObj.topLeftCircle.startX - ((actObj.topLeftCircle.radius * 2))) &&\n                x <= (actObj.topLeftCircle.startX + ((actObj.topLeftCircle.radius * 2))) &&\n                y >= (actObj.topLeftCircle.startY - ((actObj.topLeftCircle.radius * 2))) &&\n                y <= (actObj.topLeftCircle.startY + ((actObj.topLeftCircle.radius * 2)))) {\n                this.upperCanvas.style.cursor = 'nw-resize';\n            }\n            else if (x >= (actObj.topCenterCircle.startX - ((actObj.topLeftCircle.radius * 2))) &&\n                x <= (actObj.topCenterCircle.startX + ((actObj.topLeftCircle.radius * 2))) &&\n                y >= (actObj.topCenterCircle.startY - ((actObj.topLeftCircle.radius * 2))) &&\n                y <= (actObj.topCenterCircle.startY + ((actObj.topLeftCircle.radius * 2)))) {\n                this.upperCanvas.style.cursor = 'n-resize';\n            }\n            else if (x >= (actObj.topRightCircle.startX - ((actObj.topLeftCircle.radius * 2))) &&\n                x <= (actObj.topRightCircle.startX + ((actObj.topLeftCircle.radius * 2))) &&\n                y >= (actObj.topRightCircle.startY - ((actObj.topLeftCircle.radius * 2))) &&\n                y <= (actObj.topRightCircle.startY + ((actObj.topLeftCircle.radius * 2)))) {\n                this.upperCanvas.style.cursor = 'ne-resize';\n            }\n            else if (x >= (actObj.centerLeftCircle.startX - ((actObj.topLeftCircle.radius * 2))) &&\n                x <= (actObj.centerLeftCircle.startX + ((actObj.topLeftCircle.radius * 2))) &&\n                y >= (actObj.centerLeftCircle.startY - ((actObj.topLeftCircle.radius * 2))) &&\n                y <= (actObj.centerLeftCircle.startY + ((actObj.topLeftCircle.radius * 2)))) {\n                this.upperCanvas.style.cursor = 'w-resize';\n            }\n            else if (x >= (actObj.centerRightCircle.startX - ((actObj.topLeftCircle.radius * 2))) &&\n                x <= (actObj.centerRightCircle.startX + ((actObj.topLeftCircle.radius * 2))) &&\n                y >= (actObj.centerRightCircle.startY - ((actObj.topLeftCircle.radius * 2))) &&\n                y <= (actObj.centerRightCircle.startY + ((actObj.topLeftCircle.radius * 2)))) {\n                this.upperCanvas.style.cursor = 'e-resize';\n            }\n            else if (x >= (actObj.bottomLeftCircle.startX - ((actObj.topLeftCircle.radius * 2))) &&\n                x <= (actObj.bottomLeftCircle.startX + ((actObj.topLeftCircle.radius * 2))) &&\n                y >= (actObj.bottomLeftCircle.startY - ((actObj.topLeftCircle.radius * 2))) &&\n                y <= (actObj.bottomLeftCircle.startY + ((actObj.topLeftCircle.radius * 2)))) {\n                this.upperCanvas.style.cursor = 'sw-resize';\n            }\n            else if (x >= (actObj.bottomCenterCircle.startX - ((actObj.topLeftCircle.radius * 2))) &&\n                x <= (actObj.bottomCenterCircle.startX + ((actObj.topLeftCircle.radius * 2))) &&\n                y >= (actObj.bottomCenterCircle.startY - ((actObj.topLeftCircle.radius * 2))) &&\n                y <= (actObj.bottomCenterCircle.startY + ((actObj.topLeftCircle.radius * 2)))) {\n                this.upperCanvas.style.cursor = 's-resize';\n            }\n            else if (x >= (actObj.bottomRightCircle.startX - ((actObj.topLeftCircle.radius * 2))) &&\n                x <= (actObj.bottomRightCircle.startX + ((actObj.topLeftCircle.radius * 2))) &&\n                y >= (actObj.bottomRightCircle.startY - ((actObj.topLeftCircle.radius * 2))) &&\n                y <= (actObj.bottomRightCircle.startY + ((actObj.topLeftCircle.radius * 2)))) {\n                this.upperCanvas.style.cursor = 'se-resize';\n            }\n            else if ((x >= actObj.activePoint.startX &&\n                x <= actObj.activePoint.endX) && (y >= actObj.activePoint.startY &&\n                y <= actObj.activePoint.endY)) {\n                if (isCropSelection) {\n                    this.upperCanvas.style.cursor = 'grab';\n                }\n                else {\n                    this.upperCanvas.style.cursor = 'move';\n                }\n            }\n            else {\n                if (this.currObjType.isCustomCrop) {\n                    this.upperCanvas.style.cursor = 'crosshair';\n                }\n                this.upperCanvas.style.cursor = 'default';\n            }\n            if (cursor === 'default' && this.upperCanvas.style.cursor === 'default' && isCropSelection) {\n                this.upperCanvas.style.cursor = 'grab';\n            }\n            if (cursor === 'grab' && this.upperCanvas.style.cursor === 'default') {\n                this.upperCanvas.style.cursor = 'grab';\n            }\n        }\n        else if (this.togglePan && !this.togglePen) {\n            this.lowerCanvas.style.cursor = this.upperCanvas.style.cursor = 'grab';\n        }\n        else {\n            if (this.currObjType.isCustomCrop || this.togglePen) {\n                this.upperCanvas.style.cursor = 'crosshair';\n            }\n            else {\n                this.upperCanvas.style.cursor = 'default';\n            }\n        }\n        if (this.upperCanvas.style.cursor === 'default' || this.upperCanvas.style.cursor === 'grab') {\n            var cursor = this.upperCanvas.style.cursor;\n            if (this.objColl.length > 0 && (this.upperCanvas.style.cursor !== 'grab' || !isCropSelection)) {\n                this.setCursorFromObj(x, y, this.objColl);\n            }\n            if (cursor === 'grab' && this.upperCanvas.style.cursor === 'default') {\n                this.upperCanvas.style.cursor = 'grab';\n            }\n        }\n        if ((this.upperCanvas.style.cursor === 'default' || this.upperCanvas.style.cursor === 'grab')\n            && !isNullOrUndefined(this.pointColl[0]) && (this.upperCanvas.style.cursor !== 'grab' || !isCropSelection)) {\n            this.setCursorForFreehandDrawing(x, y);\n        }\n    };\n    ImageEditor.prototype.setCursorForFreehandDrawing = function (x, y) {\n        var isEntered = false;\n        this.freehandDrawHoveredIndex = -1;\n        for (var n = 0; n < this.freehandCounter; n++) {\n            this.points = extend([], this.pointColl[n].points, []);\n            this.pointCounter = 0;\n            var len = this.points.length;\n            for (var l = 0; l < len; l++) {\n                if (l !== 0) {\n                    var isInside = false;\n                    if (!isNullOrUndefined(this.points[l - 1]) && !isNullOrUndefined(this.points[l])) {\n                        isInside = this.isInside(x, y, this.points[l - 1].x, this.points[l - 1].y, this.points[l].x, this.points[l].y);\n                    }\n                    if (isInside) {\n                        this.isFreehandDrawingPoint = true;\n                        this.freehandDrawHoveredIndex = n;\n                        this.hoverFreehandraw();\n                        this.upperCanvas.style.cursor = 'pointer';\n                        isEntered = true;\n                        break;\n                    }\n                    else if (!this.isFreehandDrawEditing || this.pointColl[n].isSelected) {\n                        this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n                        if (!isNullOrUndefined(this.activeObj.shape) && this.textArea.style.display === 'none') {\n                            this.drawObject('duplicate', this.activeObj);\n                        }\n                        if (this.isFreehandDrawEditing) {\n                            var strokeColor = this.pointColl[n].strokeColor = this.selectedFreehandColor;\n                            this.hoverFreehandraw(strokeColor, this.pointColl[n].strokeWidth);\n                        }\n                        else {\n                            this.freehandDrawHoveredIndex = null;\n                        }\n                        this.isFreehandDrawingPoint = false;\n                    }\n                }\n                else {\n                    if (x > this.points[l].x - this.pointColl[n].strokeWidth &&\n                        x < this.points[l].x + this.pointColl[n].strokeWidth &&\n                        y > this.points[l].y - this.pointColl[n].strokeWidth &&\n                        y < this.points[l].y + this.pointColl[n].strokeWidth) {\n                        this.isFreehandDrawingPoint = true;\n                        this.freehandDrawHoveredIndex = n;\n                        this.hoverFreehandraw();\n                        this.upperCanvas.style.cursor = 'pointer';\n                        isEntered = true;\n                        break;\n                    }\n                    else if (!this.isFreehandDrawEditing || this.pointColl[n].isSelected) {\n                        this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n                        if (!isNullOrUndefined(this.activeObj.shape) && this.textArea.style.display === 'none') {\n                            this.drawObject('duplicate', this.activeObj);\n                        }\n                        if (this.isFreehandDrawEditing) {\n                            var strokeColor = this.pointColl[n].strokeColor === '#fff' ? '#42a5f5' : this.pointColl[n].strokeColor;\n                            this.hoverFreehandraw(strokeColor, this.pointColl[n].strokeWidth);\n                        }\n                        this.isFreehandDrawingPoint = false;\n                    }\n                }\n            }\n            if (isEntered) {\n                break;\n            }\n        }\n    };\n    ImageEditor.prototype.setCursorFromObj = function (x, y, obj) {\n        for (var i = 0; i < obj.length; i++) {\n            var actObj = extend({}, obj[i], {}, true);\n            if (x >= (actObj.topLeftCircle.startX - ((actObj.topLeftCircle.radius * 2))) &&\n                x <= (actObj.topLeftCircle.startX + ((actObj.topLeftCircle.radius * 2))) &&\n                y >= (actObj.topLeftCircle.startY - ((actObj.topLeftCircle.radius * 2))) &&\n                y <= (actObj.topLeftCircle.startY + ((actObj.topLeftCircle.radius * 2)))) {\n                this.upperCanvas.style.cursor = 'nw-resize';\n                break;\n            }\n            else if (x >= (actObj.topCenterCircle.startX - ((actObj.topLeftCircle.radius * 2))) &&\n                x <= (actObj.topCenterCircle.startX + ((actObj.topLeftCircle.radius * 2))) &&\n                y >= (actObj.topCenterCircle.startY - ((actObj.topLeftCircle.radius * 2))) &&\n                y <= (actObj.topCenterCircle.startY + ((actObj.topLeftCircle.radius * 2)))) {\n                this.upperCanvas.style.cursor = 'n-resize';\n                break;\n            }\n            else if (x >= (actObj.topRightCircle.startX - ((actObj.topLeftCircle.radius * 2))) &&\n                x <= (actObj.topRightCircle.startX + ((actObj.topLeftCircle.radius * 2))) &&\n                y >= (actObj.topRightCircle.startY - ((actObj.topLeftCircle.radius * 2))) &&\n                y <= (actObj.topRightCircle.startY + ((actObj.topLeftCircle.radius * 2)))) {\n                this.upperCanvas.style.cursor = 'ne-resize';\n                break;\n            }\n            else if (x >= (actObj.centerLeftCircle.startX - ((actObj.topLeftCircle.radius * 2))) &&\n                x <= (actObj.centerLeftCircle.startX + ((actObj.topLeftCircle.radius * 2))) &&\n                y >= (actObj.centerLeftCircle.startY - ((actObj.topLeftCircle.radius * 2))) &&\n                y <= (actObj.centerLeftCircle.startY + ((actObj.topLeftCircle.radius * 2)))) {\n                this.upperCanvas.style.cursor = 'w-resize';\n                break;\n            }\n            else if (x >= (actObj.centerRightCircle.startX - ((actObj.topLeftCircle.radius * 2))) &&\n                x <= (actObj.centerRightCircle.startX + ((actObj.topLeftCircle.radius * 2))) &&\n                y >= (actObj.centerRightCircle.startY - ((actObj.topLeftCircle.radius * 2))) &&\n                y <= (actObj.centerRightCircle.startY + ((actObj.topLeftCircle.radius * 2)))) {\n                this.upperCanvas.style.cursor = 'e-resize';\n                break;\n            }\n            else if (x >= (actObj.bottomLeftCircle.startX - ((actObj.topLeftCircle.radius * 2))) &&\n                x <= (actObj.bottomLeftCircle.startX + ((actObj.topLeftCircle.radius * 2))) &&\n                y >= (actObj.bottomLeftCircle.startY - ((actObj.topLeftCircle.radius * 2))) &&\n                y <= (actObj.bottomLeftCircle.startY + ((actObj.topLeftCircle.radius * 2)))) {\n                this.upperCanvas.style.cursor = 'sw-resize';\n                break;\n            }\n            else if (x >= (actObj.bottomCenterCircle.startX - ((actObj.topLeftCircle.radius * 2))) &&\n                x <= (actObj.bottomCenterCircle.startX + ((actObj.topLeftCircle.radius * 2))) &&\n                y >= (actObj.bottomCenterCircle.startY - ((actObj.topLeftCircle.radius * 2))) &&\n                y <= (actObj.bottomCenterCircle.startY + ((actObj.topLeftCircle.radius * 2)))) {\n                this.upperCanvas.style.cursor = 's-resize';\n                break;\n            }\n            else if (x >= (actObj.bottomRightCircle.startX - ((actObj.topLeftCircle.radius * 2))) &&\n                x <= (actObj.bottomRightCircle.startX + ((actObj.topLeftCircle.radius * 2))) &&\n                y >= (actObj.bottomRightCircle.startY - ((actObj.topLeftCircle.radius * 2))) &&\n                y <= (actObj.bottomRightCircle.startY + ((actObj.topLeftCircle.radius * 2)))) {\n                this.upperCanvas.style.cursor = 'se-resize';\n                break;\n            }\n            else if ((x >= actObj.activePoint.startX &&\n                x <= actObj.activePoint.endX) && (y >= actObj.activePoint.startY &&\n                y <= actObj.activePoint.endY)) {\n                this.upperCanvas.style.cursor = 'move';\n                break;\n            }\n            else {\n                if (this.currObjType.isCustomCrop) {\n                    this.upperCanvas.style.cursor = 'crosshair';\n                }\n                this.upperCanvas.style.cursor = 'default';\n            }\n        }\n    };\n    ImageEditor.prototype.isInside = function (x, y, z1, z2, z3, z4) {\n        var x1 = Math.min(z1, z3);\n        var x2 = Math.max(z1, z3);\n        var y1 = Math.min(z2, z4);\n        var y2 = Math.max(z2, z4);\n        if ((x1 <= x && x <= x2) && (y1 <= y && y <= y2)) {\n            return true;\n        }\n        else {\n            return false;\n        }\n    };\n    ImageEditor.prototype.refreshDropDownBtn = function (isDisabled) {\n        if (isNullOrUndefined(isDisabled)) {\n            return;\n        }\n        var annotation = document.querySelector('#' + this.element.id + '_annotationBtn');\n        if (!isNullOrUndefined(annotation)) {\n            if (isDisabled) {\n                annotation.classList.add('e-disabled');\n                annotation.parentElement.classList.add('e-overlay');\n            }\n            else {\n                annotation.classList.remove('e-disabled');\n                annotation.parentElement.classList.remove('e-overlay');\n            }\n            getComponent(annotation, 'dropdown-btn').disabled = isDisabled;\n        }\n        var transform = document.querySelector('#' + this.element.id + '_transformBtn');\n        if (!isNullOrUndefined(transform)) {\n            if (isDisabled) {\n                transform.classList.add('e-disabled');\n                transform.parentElement.classList.add('e-overlay');\n            }\n            else {\n                transform.classList.remove('e-disabled');\n                transform.parentElement.classList.remove('e-overlay');\n            }\n            getComponent(transform, 'dropdown-btn').disabled = isDisabled;\n        }\n        var adjustment = document.querySelector('#' + this.element.id + '_adjustment');\n        if (!isNullOrUndefined(adjustment)) {\n            if (isDisabled) {\n                adjustment.classList.add('e-disabled');\n                adjustment.parentElement.classList.add('e-overlay');\n            }\n            else {\n                adjustment.classList.remove('e-disabled');\n                adjustment.parentElement.classList.remove('e-overlay');\n            }\n            getComponent(adjustment, 'btn').disabled = isDisabled;\n        }\n        var filter = document.querySelector('#' + this.element.id + '_filter');\n        if (!isNullOrUndefined(filter)) {\n            if (isDisabled) {\n                filter.classList.add('e-disabled');\n                filter.parentElement.classList.add('e-overlay');\n            }\n            else {\n                filter.classList.remove('e-disabled');\n                filter.parentElement.classList.remove('e-overlay');\n            }\n            getComponent(filter, 'btn').disabled = isDisabled;\n        }\n    };\n    ImageEditor.prototype.downloadImg = function (blob, fileName) {\n        var a = document.createElement('a');\n        a.href = blob;\n        a.target = '_parent';\n        a.download = fileName;\n        (document.body || document.documentElement).appendChild(a);\n        a.click();\n        a.parentNode.removeChild(a);\n    };\n    ImageEditor.prototype.toSVGImg = function (fileName) {\n        showSpinner(this.element);\n        this.element.style.opacity = '0.5';\n        var tempCanvas = this.exportChangesToCanvas();\n        var dataUrl = tempCanvas.toDataURL();\n        hideSpinner(this.element);\n        this.element.style.opacity = '1';\n        var svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');\n        svg.setAttribute('width', tempCanvas.style.maxWidth);\n        svg.setAttribute('height', tempCanvas.style.maxHeight);\n        var XLinkNS = 'http://www.w3.org/1999/xlink';\n        var img = document.createElementNS('http://www.w3.org/2000/svg', 'image');\n        img.setAttributeNS(null, 'height', tempCanvas.height.toString());\n        img.setAttributeNS(null, 'width', tempCanvas.width.toString());\n        img.setAttributeNS(XLinkNS, 'xlink:href', dataUrl);\n        svg.appendChild(img);\n        var prefix = 'data:image/svg+xml;base64,';\n        var header = '<svg' + ' xmlns=\"http://www.w3.org/2000/svg\"' + ' xmlns:xlink=\"http://www.w3.org/1999/xlink\"'\n            + (\" width=\\\"\" + tempCanvas.width + \"\\\"\") + (\" height=\\\"\" + tempCanvas.height + \"\\\"\") + '>';\n        var footer = '</svg>';\n        var body = svg.innerHTML;\n        var data = header + body + footer;\n        var svgDataUrl = prefix + btoa(data);\n        if (fileName === null) {\n            return svgDataUrl;\n        }\n        else {\n            this.downloadImg(svgDataUrl, fileName + '.' + 'svg');\n            return null;\n        }\n    };\n    ImageEditor.prototype.toBlobFn = function (fileName, type) {\n        // eslint-disable-next-line @typescript-eslint/no-this-alias\n        var proxy = this;\n        showSpinner(this.element);\n        this.element.style.opacity = '0.5';\n        var tempCanvas = this.exportChangesToCanvas();\n        // eslint-disable-next-line @typescript-eslint/tslint/config\n        tempCanvas.toBlob(function (blob) {\n            var blobUrl = URL.createObjectURL(blob);\n            proxy.downloadImg(blobUrl, fileName + '.' + type);\n            hideSpinner(proxy.element);\n            proxy.element.style.opacity = '1';\n        }, 'image/png');\n    };\n    ImageEditor.prototype.exportChangesToCanvas = function () {\n        var ratio = this.calcRatio();\n        var tempContextFilter = this.lowerContext.filter;\n        // Manipulating blur value\n        if (this.lowerContext.filter !== 'none') {\n            var splitWords = this.lowerContext.filter.split(' ');\n            var value = parseFloat(splitWords[5].split('(')[1]);\n            value *= ((ratio.width + ratio.height) / 2);\n            splitWords[5] = 'blur(' + value + 'px)';\n            this.lowerContext.filter = splitWords.join(' ');\n        }\n        var maxDimension;\n        var tempCanvas = this.createElement('canvas', {\n            id: this.element.id + '_tempCanvas', attrs: { name: 'canvasImage' }\n        });\n        var tempContext = tempCanvas.getContext('2d');\n        tempContext.filter = this.lowerContext.filter;\n        if (isNullOrUndefined(this.currSelectionPoint)) {\n            tempCanvas.width = this.baseImg.width;\n            tempCanvas.height = this.baseImg.height;\n            maxDimension = this.calcMaxDimension(this.baseImg.width, this.baseImg.height);\n            tempCanvas.style.maxWidth = maxDimension.width + 'px';\n            tempCanvas.style.maxHeight = maxDimension.height + 'px';\n            tempContext.filter = this.lowerContext.filter;\n            var temp = this.lowerContext.filter;\n            this.updateBrightnessFilter();\n            tempContext.drawImage(this.baseImg, this.srcLeft, this.srcTop, this.srcWidth, this.srcHeight, 0, 0, this.baseImg.width, this.baseImg.height);\n            this.lowerContext.filter = temp;\n        }\n        else {\n            tempCanvas.width = this.destWidth;\n            tempCanvas.height = this.destHeight;\n            tempContext.filter = this.lowerContext.filter;\n            var temp = this.lowerContext.filter;\n            this.updateBrightnessFilter();\n            tempContext.drawImage(this.baseImg, this.srcLeft, this.srcTop, this.srcWidth, this.srcHeight, 0, 0, this.destWidth, this.destHeight);\n            this.lowerContext.filter = temp;\n        }\n        if (this.degree !== 0 || this.currFlipState !== '') {\n            this.updateSaveContext(tempContext);\n            this.exportTransformedImage(tempContext);\n        }\n        if (this.objColl.length > 0) {\n            var temp = tempContext.filter;\n            tempContext.filter = 'none';\n            var tempObjColl = extend([], this.objColl, [], true);\n            for (var i = 0; i < this.objColl.length; i++) {\n                // Subtracting destination left and top points\n                this.objColl[i].activePoint.startX -= this.destLeft;\n                this.objColl[i].activePoint.startY -= this.destTop;\n                this.objColl[i].activePoint.endX -= this.destLeft;\n                this.objColl[i].activePoint.endY -= this.destTop;\n                this.objColl[i].activePoint.width = this.objColl[i].activePoint.endX -\n                    this.objColl[i].activePoint.startX;\n                this.objColl[i].activePoint.height = this.objColl[i].activePoint.endY -\n                    this.objColl[i].activePoint.startY;\n                // Manipulating points\n                if (isNullOrUndefined(this.currSelectionPoint)) {\n                    this.objColl[i].activePoint.startX *= ratio.width;\n                    this.objColl[i].activePoint.startY *= ratio.height;\n                    this.objColl[i].activePoint.endX *= ratio.width;\n                    this.objColl[i].activePoint.endY *= ratio.height;\n                    this.objColl[i].activePoint.width = this.objColl[i].activePoint.endX -\n                        this.objColl[i].activePoint.startX;\n                    this.objColl[i].activePoint.height = this.objColl[i].activePoint.endY -\n                        this.objColl[i].activePoint.startY;\n                    this.objColl[i].strokeSettings.strokeWidth *= ((ratio.width + ratio.height) / 2);\n                    if (this.objColl[i].shape === 'text') {\n                        this.objColl[i].textSettings.fontSize *= ((ratio.width + ratio.height) / 2);\n                    }\n                }\n                this.drawObject('saveContext', this.objColl[i], null, null, true, tempContext);\n            }\n            tempContext.filter = temp;\n            this.refreshActiveObj();\n            this.objColl = tempObjColl;\n        }\n        if (this.freehandCounter > 0) {\n            // eslint-disable-next-line\n            var tempPointColl = extend({}, this.pointColl, {}, true);\n            for (var n = 0; n < this.freehandCounter; n++) {\n                this.points = extend([], this.pointColl[n].points, []);\n                this.pointCounter = 0;\n                var len = this.points.length;\n                if (isNullOrUndefined(this.currSelectionPoint)) {\n                    this.pointColl[n].strokeWidth *= ((ratio.width + ratio.height) / 2);\n                    for (var l = 0; l < len; l++) {\n                        this.points[l].x = (this.points[l].x - this.destLeft) * ratio.width;\n                        this.points[l].y = (this.points[l].y - this.destTop) * ratio.height;\n                    }\n                }\n                else {\n                    for (var l = 0; l < len; l++) {\n                        this.points[l].x -= this.destLeft;\n                        this.points[l].y -= this.destTop;\n                    }\n                }\n            }\n            this.freehandRedraw(tempContext);\n            this.pointColl = tempPointColl;\n        }\n        if (this.isCircleCrop) {\n            this.cropCircle(tempContext, true);\n        }\n        this.lowerContext.filter = tempContextFilter;\n        return tempCanvas;\n    };\n    ImageEditor.prototype.exportTransformedImage = function (tempContext) {\n        var degree = this.degree;\n        for (var i = 0; i < this.rotateFlipColl.length; i++) {\n            if (typeof (this.rotateFlipColl[i]) === 'number') {\n                this.exportRotate(tempContext, this.rotateFlipColl[i]);\n            }\n            else if (this.rotateFlipColl[i] === 'horizontal') {\n                this.exportHorizontalFlip(tempContext);\n            }\n            else if (this.rotateFlipColl[i] === 'vertical') {\n                this.exportVerticalFlip(tempContext);\n            }\n        }\n        this.degree = degree;\n    };\n    ImageEditor.prototype.exportRotate = function (tempContext, degree) {\n        if (isNullOrUndefined(this.currSelectionPoint)) {\n            this.setMaximumDimension(this.degree, tempContext.canvas);\n            tempContext.translate(tempContext.canvas.width / 2, tempContext.canvas.height / 2);\n            tempContext.rotate(Math.PI / 180 * degree);\n            tempContext.drawImage(this.inMemoryCanvas, this.srcLeft, this.srcTop, this.srcWidth, this.srcHeight, -tempContext.canvas.height / 2, -tempContext.canvas.width / 2, tempContext.canvas.height, tempContext.canvas.width);\n        }\n        else {\n            tempContext.translate(tempContext.canvas.width / 2, tempContext.canvas.height / 2);\n            tempContext.rotate(Math.PI / 180 * degree);\n            tempContext.drawImage(this.inMemoryCanvas, -tempContext.canvas.height / 2, -tempContext.canvas.width / 2, tempContext.canvas.height, tempContext.canvas.width);\n        }\n        this.updateSaveContext(tempContext);\n    };\n    ImageEditor.prototype.exportHorizontalFlip = function (tempContext) {\n        tempContext.translate(tempContext.canvas.width, 0);\n        tempContext.scale(-1, 1);\n        tempContext.drawImage(this.inMemoryCanvas, 0, 0);\n        this.updateSaveContext(tempContext);\n    };\n    ImageEditor.prototype.exportVerticalFlip = function (tempContext) {\n        tempContext.translate(0, tempContext.canvas.height);\n        tempContext.scale(1, -1);\n        tempContext.drawImage(this.inMemoryCanvas, 0, 0);\n        this.updateSaveContext(tempContext);\n    };\n    ImageEditor.prototype.updateSaveContext = function (tempContext) {\n        tempContext.setTransform(1, 0, 0, 1, 0, 0);\n        var imageData = tempContext.getImageData(0, 0, tempContext.canvas.width, tempContext.canvas.height);\n        this.inMemoryCanvas.width = imageData.width;\n        this.inMemoryCanvas.height = imageData.height;\n        this.inMemoryContext.putImageData(imageData, 0, 0);\n    };\n    ImageEditor.prototype.addLetter = function (letter) {\n        if (this.textArea.style.display === 'none' && (this.currObjType.isText || this.activeObj.shape === 'text')) {\n            if (letter === 'Backspace') {\n                this.keyHistory = this.keyHistory.slice(0, -1);\n            }\n            else {\n                this.keyHistory += letter;\n            }\n            this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n            this.updateFontStyles();\n            var width = this.upperContext.measureText(this.keyHistory + this.tempKeyHistory).width\n                + this.activeObj.textSettings.fontSize * 0.5;\n            var height = this.activeObj.textSettings.fontSize + this.activeObj.textSettings.fontSize * 0.25;\n            this.upperContext.fillText(this.keyHistory + this.tempKeyHistory, this.activeObj.activePoint.startX, this.activeObj.activePoint.startY +\n                this.activeObj.textSettings.fontSize);\n            this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n            this.currObjType.isText = true;\n            this.setActivePoint(width, height);\n        }\n    };\n    ImageEditor.prototype.updateFontStyles = function (isTextBox) {\n        this.upperContext.strokeStyle = this.activeObj.strokeSettings.strokeColor;\n        this.upperContext.fillStyle = this.activeObj.strokeSettings.strokeColor;\n        var textStyle = '';\n        if (this.activeObj.textSettings.bold) {\n            textStyle = 'bold ';\n        }\n        if (this.activeObj.textSettings.italic) {\n            textStyle = 'italic ';\n        }\n        if (this.activeObj.textSettings.bold && this.activeObj.textSettings.italic) {\n            textStyle = 'italic bold ';\n        }\n        var fontSize = isTextBox ? parseFloat(this.textArea.style.fontSize) : this.activeObj.textSettings.fontSize;\n        var fontFamily = this.textArea.style.display === 'block' ? this.textArea.style.fontFamily : this.activeObj.textSettings.fontFamily;\n        this.upperContext.font = textStyle + fontSize + 'px' + ' ' + fontFamily;\n    };\n    ImageEditor.prototype.textFlipDegree = function (canvasDraw, startX, startY) {\n        var rows = this.activeObj.keyHistory.split('\\n');\n        var height = this.activeObj.textSettings.fontSize;\n        var lineHeight = ((height * rows.length) - (this.activeObj.textSettings.fontSize * rows.length)) / rows.length;\n        var yPoint = (this.activeObj.textSettings.fontSize * 0.85) + lineHeight;\n        for (var i = 0; i < rows.length; i++) {\n            var text = rows[i];\n            if (i > 0) {\n                if (i === 1) {\n                    yPoint -= (this.activeObj.textSettings.fontSize * 0.85);\n                }\n                yPoint += this.activeObj.textSettings.fontSize + this.activeObj.textSettings.fontSize * 0.15;\n            }\n            canvasDraw.fillText(text, startX + this.activeObj.textSettings.fontSize * 0.15, startY +\n                yPoint + (i > 0 ? this.activeObj.textSettings.fontSize * 0.25 : -this.activeObj.textSettings.fontSize * 0.35));\n        }\n    };\n    ImageEditor.prototype.rotateText = function (canvasDraw) {\n        var startX = this.activeObj.activePoint.startX;\n        var startY = this.activeObj.activePoint.startY;\n        var degree;\n        if (this.activeObj.shapeDegree === 0) {\n            degree = this.degree;\n        }\n        else {\n            degree = this.degree - this.activeObj.shapeDegree;\n        }\n        if (degree < 0) {\n            degree = 360 + degree;\n        }\n        if (degree % 360 === 0 && (this.degree !== -360 || this.currFlipState === '')) {\n            startX = this.activeObj.activePoint.startX + this.activeObj.textSettings.fontSize * 0.15;\n            startY = this.activeObj.activePoint.startY + (this.activeObj.activePoint.endY - this.activeObj.activePoint.startY);\n            var rows = this.activeObj.keyHistory.split('\\n');\n            for (var i = 0; i < rows.length; i++) {\n                startY = this.activeObj.activePoint.startY + (i * this.activeObj.textSettings.fontSize +\n                    this.activeObj.textSettings.fontSize * 0.25);\n                canvasDraw.fillText(rows[i], startX, startY);\n            }\n        }\n        else if (degree % 90 === 0 && degree % 180 !== 0) {\n            canvasDraw.translate(this.lowerCanvas.width / 2, this.lowerCanvas.height / 2);\n            canvasDraw.rotate(Math.PI / 180 * degree);\n            canvasDraw.translate(-this.lowerCanvas.height / 2, -this.lowerCanvas.width / 2);\n            if (degree % 90 === 0 && degree % 270 !== 0) {\n                startY = (this.lowerCanvas.width - this.activeObj.activePoint.endX) + this.activeObj.textSettings.fontSize * 0.4;\n                startX = this.activeObj.activePoint.startY;\n            }\n            else if (degree % 270 === 0) {\n                startX = this.lowerCanvas.height - this.activeObj.activePoint.endY;\n                startY = this.activeObj.activePoint.startX + this.activeObj.textSettings.fontSize * 0.4;\n            }\n            this.textFlipDegree(canvasDraw, startX, startY);\n            canvasDraw.translate(this.lowerCanvas.height / 2, this.lowerCanvas.width / 2);\n            canvasDraw.rotate(Math.PI / 180 * -degree);\n            canvasDraw.translate(-this.lowerCanvas.width / 2, -this.lowerCanvas.height / 2);\n        }\n        else {\n            canvasDraw.translate(this.lowerCanvas.width / 2, this.lowerCanvas.height / 2);\n            canvasDraw.rotate(Math.PI / 180 * degree);\n            startX = this.lowerCanvas.width - this.activeObj.activePoint.endX;\n            startY = (this.lowerCanvas.height - this.activeObj.activePoint.endY) + this.activeObj.textSettings.fontSize * 0.4;\n            canvasDraw.translate(-this.lowerCanvas.width / 2, -this.lowerCanvas.height / 2);\n            this.textFlipDegree(canvasDraw, startX, startY);\n            canvasDraw.translate(this.lowerCanvas.width / 2, this.lowerCanvas.height / 2);\n            canvasDraw.rotate(Math.PI / 180 * -degree);\n            canvasDraw.translate(-this.lowerCanvas.width / 2, -this.lowerCanvas.height / 2);\n        }\n        if (this.degree === 360 || this.degree === -360) {\n            this.degree = 0;\n        }\n    };\n    ImageEditor.prototype.redrawObj = function (degree) {\n        if (this.objColl.length > 0) {\n            if (degree === 'horizontal' || degree === 'vertical' || degree === 'Horizontal' || degree === 'Vertical' ||\n                degree === 'horizontalVertical' || degree === 'verticalHorizontal') {\n                this.updateCurrentActiveObjPoint(degree.toLowerCase());\n            }\n            else if (typeof (degree) === 'number') {\n                this.updateCurrentActiveObjPoint(degree);\n                var tempFilter = this.lowerContext.filter;\n                this.lowerContext.filter = this.getDefaultFilter();\n                for (var i = 0; i < this.objColl.length; i++) {\n                    var splitWords = this.objColl[i].shape.split('-');\n                    if (splitWords[0] !== 'crop') {\n                        this.apply(this.objColl[i].shape, this.objColl[i]);\n                    }\n                }\n                this.lowerContext.filter = tempFilter;\n            }\n        }\n    };\n    ImageEditor.prototype.updateCurrentActiveObjPoint = function (degree) {\n        var currActObjIndex;\n        for (var index = 0; index < this.objColl.length; index++) {\n            if (this.activeObj.shape === this.objColl[index].shape &&\n                this.activeObj.activePoint.startX === this.objColl[index].activePoint.startX &&\n                this.activeObj.activePoint.startY === this.objColl[index].activePoint.startY &&\n                this.activeObj.activePoint.endX === this.objColl[index].activePoint.endX &&\n                this.activeObj.activePoint.endY === this.objColl[index].activePoint.endY &&\n                this.activeObj.currIndex === this.objColl[index].currIndex) {\n                currActObjIndex = index;\n                break;\n            }\n        }\n        if (degree === 'horizontal' || degree === 'vertical' || degree === 'Horizontal' || degree === 'Vertical' ||\n            degree === 'horizontalvertical' || degree === 'verticalhorizontal') {\n            if (degree === 'horizontal' || degree === 'Horizontal') {\n                for (var i = 0; i < this.objColl.length; i++) {\n                    if (this.objColl[i].shapeFlip !== this.currFlipState) {\n                        if (this.objColl[i].activePoint.startX <= this.destLeft + (this.destWidth / 2)) {\n                            this.objColl[i].activePoint.endX = (this.destLeft + this.destWidth) -\n                                (this.objColl[i].activePoint.startX - this.destLeft);\n                            this.objColl[i].activePoint.startX = this.objColl[i].activePoint.endX -\n                                this.objColl[i].activePoint.width;\n                            this.updateActiveObject(this.objColl[i].activePoint, this.objColl[i]);\n                        }\n                        else if (this.objColl[i].activePoint.startX >= this.destLeft + (this.destWidth / 2)) {\n                            this.objColl[i].activePoint.startX = this.destLeft + (this.destLeft + this.destWidth -\n                                this.objColl[i].activePoint.endX);\n                            this.objColl[i].activePoint.endX = this.objColl[i].activePoint.startX +\n                                this.objColl[i].activePoint.width;\n                            this.updateActiveObject(this.objColl[i].activePoint, this.objColl[i]);\n                        }\n                        this.objColl[i].imageRatio = { startX: ((this.objColl[i].activePoint.startX -\n                                this.destLeft) / this.destWidth),\n                            startY: ((this.objColl[i].activePoint.startY - this.destTop) / this.destHeight),\n                            endX: ((this.objColl[i].activePoint.endX - this.destLeft) / this.destWidth),\n                            endY: ((this.objColl[i].activePoint.endY - this.destTop) / this.destHeight),\n                            width: this.destWidth / this.objColl[i].activePoint.width,\n                            height: this.destHeight / this.objColl[i].activePoint.height };\n                        this.objColl[i].shapeFlip = this.currFlipState;\n                    }\n                }\n            }\n            else if (degree === 'vertical' || degree === 'Vertical') {\n                for (var i = 0; i < this.objColl.length; i++) {\n                    if (this.objColl[i].shapeFlip !== this.currFlipState) {\n                        if (this.objColl[i].activePoint.startY <= this.destTop + (this.destHeight / 2)) {\n                            this.objColl[i].activePoint.endY = (this.destTop + this.destHeight) -\n                                (this.objColl[i].activePoint.startY - this.destTop);\n                            this.objColl[i].activePoint.startY = this.objColl[i].activePoint.endY -\n                                this.objColl[i].activePoint.height;\n                            this.updateActiveObject(this.objColl[i].activePoint, this.objColl[i]);\n                        }\n                        else if (this.objColl[i].activePoint.startY >= this.lowerCanvas.height / 2) {\n                            this.objColl[i].activePoint.startY = this.destTop + (this.destTop + this.destHeight -\n                                this.objColl[i].activePoint.endY);\n                            this.objColl[i].activePoint.endY = this.objColl[i].activePoint.startY +\n                                this.objColl[i].activePoint.height;\n                            this.updateActiveObject(this.objColl[i].activePoint, this.objColl[i]);\n                        }\n                        this.objColl[i].imageRatio = { startX: ((this.objColl[i].activePoint.startX -\n                                this.destLeft) / this.destWidth),\n                            startY: ((this.objColl[i].activePoint.startY - this.destTop) / this.destHeight),\n                            endX: ((this.objColl[i].activePoint.endX - this.destLeft) / this.destWidth),\n                            endY: ((this.objColl[i].activePoint.endY - this.destTop) / this.destHeight),\n                            width: this.destWidth / this.objColl[i].activePoint.width,\n                            height: this.destHeight / this.objColl[i].activePoint.height };\n                        this.objColl[i].shapeFlip = this.currFlipState;\n                    }\n                }\n            }\n            else if (degree === 'verticalhorizontal' || degree === 'horizontalvertical') {\n                for (var i = 0; i < this.objColl.length; i++) {\n                    if (this.objColl[i].shapeFlip !== this.currFlipState) {\n                        if (this.objColl[i].activePoint.startX <= this.destLeft + (this.destWidth / 2)) {\n                            this.objColl[i].activePoint.endX = (this.destLeft + this.destWidth) -\n                                (this.objColl[i].activePoint.startX - this.destLeft);\n                            this.objColl[i].activePoint.startX = this.objColl[i].activePoint.endX -\n                                this.objColl[i].activePoint.width;\n                            this.updateActiveObject(this.objColl[i].activePoint, this.objColl[i]);\n                        }\n                        else if (this.objColl[i].activePoint.startX >= this.destLeft + (this.destWidth / 2)) {\n                            this.objColl[i].activePoint.startX = this.destLeft + (this.destLeft + this.destWidth -\n                                this.objColl[i].activePoint.endX);\n                            this.objColl[i].activePoint.endX = this.objColl[i].activePoint.startX +\n                                this.objColl[i].activePoint.width;\n                            this.updateActiveObject(this.objColl[i].activePoint, this.objColl[i]);\n                        }\n                        if (this.objColl[i].activePoint.startY <= this.destTop + (this.destHeight / 2)) {\n                            this.objColl[i].activePoint.endY = (this.destTop + this.destHeight) -\n                                (this.objColl[i].activePoint.startY - this.destTop);\n                            this.objColl[i].activePoint.startY = this.objColl[i].activePoint.endY -\n                                this.objColl[i].activePoint.height;\n                            this.updateActiveObject(this.objColl[i].activePoint, this.objColl[i]);\n                        }\n                        else if (this.objColl[i].activePoint.startY >= this.lowerCanvas.height / 2) {\n                            this.objColl[i].activePoint.startY = this.destTop + (this.destTop + this.destHeight -\n                                this.objColl[i].activePoint.endY);\n                            this.objColl[i].activePoint.endY = this.objColl[i].activePoint.startY +\n                                this.objColl[i].activePoint.height;\n                            this.updateActiveObject(this.objColl[i].activePoint, this.objColl[i]);\n                        }\n                        this.objColl[i].imageRatio = { startX: ((this.objColl[i].activePoint.startX -\n                                this.destLeft) / this.destWidth),\n                            startY: ((this.objColl[i].activePoint.startY - this.destTop) / this.destHeight),\n                            endX: ((this.objColl[i].activePoint.endX - this.destLeft) / this.destWidth),\n                            endY: ((this.objColl[i].activePoint.endY - this.destTop) / this.destHeight),\n                            width: this.destWidth / this.objColl[i].activePoint.width,\n                            height: this.destHeight / this.objColl[i].activePoint.height };\n                        this.objColl[i].shapeFlip = this.currFlipState;\n                    }\n                }\n            }\n            if (currActObjIndex !== undefined) {\n                this.activeObj = extend({}, this.objColl[currActObjIndex], {}, true);\n            }\n        }\n        else if (degree === 90) {\n            this.rotateObjColl();\n        }\n        else if (degree === -90) {\n            for (var i = 0; i < 3; i++) {\n                this.rotateObjColl();\n            }\n        }\n        else if (typeof (degree) === 'number') {\n            if (degree > 0) {\n                this.rotateObjColl();\n            }\n            else {\n                for (var i = 0; i < 3; i++) {\n                    this.rotateObjColl();\n                }\n            }\n        }\n    };\n    ImageEditor.prototype.rotateObjColl = function () {\n        for (var i = 0; i < this.objColl.length; i++) {\n            this.objColl[i].activePoint.startY = this.destTop + (this.destHeight * this.objColl[i].imageRatio.startX);\n            this.objColl[i].activePoint.endY = this.destTop + (this.destHeight * this.objColl[i].imageRatio.endX);\n            this.objColl[i].activePoint.startX = (this.destLeft + this.destWidth) -\n                (this.destWidth * this.objColl[i].imageRatio.endY);\n            this.objColl[i].activePoint.endX = (this.destLeft + this.destWidth) -\n                (this.destWidth * this.objColl[i].imageRatio.startY);\n            this.objColl[i].activePoint.width = this.objColl[i].activePoint.endX -\n                this.objColl[i].activePoint.startX;\n            this.objColl[i].activePoint.height = this.objColl[i].activePoint.endY -\n                this.objColl[i].activePoint.startY;\n            this.updateFontSize(this.objColl[i]);\n        }\n        for (var i = 0; i < this.objColl.length; i++) {\n            this.updateActiveObject(this.objColl[i].activePoint, this.objColl[i]);\n        }\n        // Update current image ratio for all objects\n        for (var i = 0; i < this.objColl.length; i++) {\n            this.objColl[i].imageRatio = { startX: ((this.objColl[i].activePoint.startX -\n                    this.destLeft) / this.destWidth),\n                startY: ((this.objColl[i].activePoint.startY - this.destTop) / this.destHeight),\n                endX: ((this.objColl[i].activePoint.endX - this.destLeft) / this.destWidth),\n                endY: ((this.objColl[i].activePoint.endY - this.destTop) / this.destHeight),\n                width: this.destWidth / this.objColl[i].activePoint.width,\n                height: this.destHeight / this.objColl[i].activePoint.height };\n        }\n    };\n    ImageEditor.prototype.redrawShape = function (obj) {\n        for (var i = 0; i < this.objColl.length; i++) {\n            if (JSON.stringify(obj) === JSON.stringify(this.objColl[i])) {\n                this.objColl.splice(i, 1);\n                break;\n            }\n        }\n        this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n        if (this.isPreventDragging) {\n            if (this.activeObj.activePoint.startX > this.destLeft) {\n                this.isPreventDragging = false;\n            }\n            this.drawObject('duplicate', null, null, null, true);\n        }\n        else {\n            this.drawObject('duplicate', null, null, null, true);\n        }\n    };\n    ImageEditor.prototype.applyActObj = function () {\n        var isActObj = false;\n        if (this.activeObj.shape !== undefined && this.activeObj.shape === 'text' && this.activeObj.keyHistory === '') {\n            this.refreshActiveObj();\n            this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n        }\n        else {\n            var splitWords = void 0;\n            var isCropSelection = false;\n            if (this.activeObj.shape !== undefined) {\n                splitWords = this.activeObj.shape.split('-');\n            }\n            if (splitWords === undefined && this.currObjType.isCustomCrop) {\n                isCropSelection = true;\n            }\n            else if (splitWords !== undefined && splitWords[0] === 'crop') {\n                isCropSelection = true;\n            }\n            if (!isNullOrUndefined(this.activeObj.shape) && !isCropSelection) {\n                for (var i = 0; i < this.objColl.length; i++) {\n                    if (JSON.stringify(this.activeObj) === JSON.stringify(this.objColl[i])) {\n                        isActObj = true;\n                        break;\n                    }\n                }\n                if (!isActObj) {\n                    if (isNullOrUndefined(this.activeObj.currIndex)) {\n                        this.activeObj.currIndex = 'shape_' + (this.objColl.length + 1);\n                    }\n                    this.updateImageRatioForActObj();\n                    var splitWords_3 = this.activeObj.currIndex.split('_');\n                    var tempObjColl = this.objColl.splice(0, parseInt(splitWords_3[1], 10) - 1);\n                    tempObjColl.push(extend({}, this.activeObj, {}, true));\n                    for (var i = 0; i < this.objColl.length; i++) {\n                        tempObjColl.push(this.objColl[i]);\n                    }\n                    this.objColl = tempObjColl;\n                    tempObjColl = [];\n                    this.refreshActiveObj();\n                    this.lowerContext.clearRect(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n                    this.redrawImgWithObj();\n                    //this.zoomFreehandDrawColl();\n                    this.clearOuterCanvas(this.lowerContext);\n                    this.clearOuterCanvas(this.upperContext);\n                    this.currObjType.shape = '';\n                    this.refreshActiveObj();\n                    if (this.isCircleCrop) {\n                        this.cropCircle(this.lowerContext);\n                    }\n                }\n            }\n        }\n    };\n    ImageEditor.prototype.apply = function (shape, obj, canvas) {\n        if (!this.disabled) {\n            if ((this.togglePen) && !this.currObjType.isCustomCrop) {\n                var destLeft = this.destLeft;\n                var destTop = this.destTop;\n                var destWidth = this.destWidth;\n                var destHeight = this.destHeight;\n                this.callUpdateCurrentTransformedState();\n                var temp = this.lowerContext.filter;\n                this.lowerContext.filter = 'none';\n                this.togglePen = false;\n                this.iterateObjColl();\n                this.freehandRedraw(this.lowerContext);\n                this.togglePen = false;\n                if (this.isCircleCrop || (!isNullOrUndefined(this.currSelectionPoint) && this.currSelectionPoint.shape === 'crop-circle')) {\n                    this.cropCircle(this.lowerContext);\n                }\n                this.destLeft = destLeft;\n                this.destTop = destTop;\n                this.destWidth = destWidth;\n                this.destHeight = destHeight;\n                this.lowerContext.filter = temp;\n            }\n            else {\n                canvas = canvas ? canvas : 'original';\n                this.currObjType.shape = shape !== undefined ? shape : this.currObjType.shape;\n                if (this.currObjType.shape !== '') {\n                    this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n                    this.drawObject(canvas, obj);\n                    this.activeObj.shape = this.currObjType.shape.toLowerCase();\n                    if (!shape && this.currObjType.shape !== '' && !this.currObjType.isCustomCrop) {\n                        this.objColl.push(extend({}, this.activeObj, {}, true));\n                    }\n                    this.keyHistory = '';\n                }\n            }\n        }\n    };\n    ImageEditor.prototype.setCenterPoints = function (text, width, height) {\n        var renderWidth;\n        var renderHeight;\n        if (text && width && height) {\n            renderWidth = width;\n            renderHeight = height;\n        }\n        else {\n            renderWidth = this.activeObj.activePoint.width;\n            renderHeight = this.activeObj.activePoint.height;\n        }\n        this.activeObj.activePoint.startX = (this.lowerCanvas.width / 2) - renderWidth / 2;\n        this.activeObj.activePoint.startY = (this.lowerCanvas.height / 2) - renderHeight / 2;\n        this.activeObj.activePoint.endX = (this.lowerCanvas.width / 2) + renderWidth / 2;\n        this.activeObj.activePoint.endY = (this.lowerCanvas.height / 2) + renderHeight / 2;\n        if (text && width && height) {\n            this.textStartPoints.x = this.activeObj.activePoint.startX;\n            this.textStartPoints.y = this.activeObj.activePoint.startY;\n        }\n    };\n    ImageEditor.prototype.drawShape = function (type, strokeWidth, strokeColor, fillColor, start, width, height) {\n        if (!this.disabled && this.isImageLoaded) {\n            this.redrawActObj();\n            var objColl = extend([], this.objColl, [], true);\n            this.togglePen = false;\n            this.keyHistory = '';\n            this.upperCanvas.style.display = 'block';\n            this.refreshActiveObj();\n            this.currObjType.shape = type;\n            if (this.currObjType.shape.toLowerCase() !== 'freehanddraw' && this.currObjType.shape.toLowerCase() !== '') {\n                this.activeObj.shape = this.currObjType.shape.toLowerCase();\n                this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n                if (isNullOrUndefined(this.activeObj.strokeSettings)) {\n                    this.activeObj.strokeSettings = this.strokeSettings;\n                }\n                this.activeObj.strokeSettings.strokeWidth = strokeWidth ? strokeWidth : this.activeObj.strokeSettings.strokeWidth;\n                this.activeObj.strokeSettings.strokeColor = strokeColor ? strokeColor : this.activeObj.strokeSettings.strokeColor;\n                this.activeObj.strokeSettings.fillColor = fillColor ? fillColor : this.activeObj.strokeSettings.fillColor;\n                var tempWidth = this.destWidth > 100 ? 100 : this.destWidth / 2;\n                var tempHeight = this.destHeight > 100 ? 100 : this.destHeight / 2;\n                this.activeObj.activePoint.width = tempWidth;\n                this.activeObj.activePoint.height = tempHeight;\n                if (this.currObjType.shape.toLowerCase() === 'line') {\n                    this.activeObj.lineDraw = 'horizontal';\n                    this.activeObj.activePoint.height /= 2;\n                }\n                else if (this.currObjType.shape.toLowerCase() === 'rectangle') {\n                    this.activeObj.activePoint.width += this.activeObj.activePoint.width / 2;\n                }\n                if (this.currObjType.shape.toLowerCase() === 'ellipse' && width) {\n                    this.activeObj.activePoint.width = 2 * width;\n                    this.activeObj.activePoint.height = 2 * height;\n                }\n                if (width && height) {\n                    this.activeObj.activePoint.width = width;\n                    this.activeObj.activePoint.height = height;\n                }\n                if (!isNullOrUndefined(start)) {\n                    this.activeObj.activePoint.startX = start.x;\n                    this.activeObj.activePoint.startY = start.y;\n                    this.activeObj.activePoint.endX = this.activeObj.activePoint.startX + this.activeObj.activePoint.width;\n                    this.activeObj.activePoint.endY = this.activeObj.activePoint.startY + this.activeObj.activePoint.height;\n                }\n                else {\n                    this.setCenterPoints();\n                }\n                this.currObjType.isDragging = this.currObjType.isCustomCrop = false;\n                this.activeObj.shapeDegree = this.degree;\n                this.activeObj.shapeFlip = this.currFlipState;\n                this.activeObj.flipObjColl = [];\n                var shapeSettings = this.updatePreviousShapeSettings();\n                var shapeChangingArgs = { action: 'insert', previousShapeSettings: shapeSettings,\n                    currentShapeSettings: shapeSettings };\n                this.trigger('shapeChanging', shapeChangingArgs);\n                this.updateShapeChangeEventArgs(shapeChangingArgs.currentShapeSettings);\n                this.drawObject('duplicate');\n                this.isShapeInserted = true;\n                this.updateUndoRedoObj(objColl);\n                this.refreshToolbar('shapes');\n            }\n        }\n    };\n    ImageEditor.prototype.drawShapeText = function (text, fontFamily, fontSize, bold, italic, strokeColor, x, y) {\n        if (!this.disabled && this.isImageLoaded) {\n            if (this.currObjType.shape === 'freehanddraw') {\n                this.apply();\n                this.upperCanvas.style.cursor = 'default';\n                this.currObjType.shape = '';\n            }\n            this.togglePen = false;\n            this.redrawActObj();\n            var prevObj = this.getCurrentObj();\n            prevObj.objColl = extend([], this.objColl, [], true);\n            prevObj.pointColl = extend([], this.pointColl, [], true);\n            prevObj.afterCropActions = extend([], this.afterCropActions, [], true);\n            this.keyHistory = '';\n            this.refreshActiveObj();\n            this.activeObj.shape = 'text';\n            this.currObjType.isCustomCrop = false;\n            this.currObjType.isText = this.currObjType.isInitialText = true;\n            this.upperCanvas.style.display = 'block';\n            this.currObjType.shape = this.activeObj.shape = 'text';\n            if (isNullOrUndefined(this.activeObj.textSettings)) {\n                this.activeObj.textSettings = this.textSettings;\n            }\n            if (isNullOrUndefined(this.activeObj.strokeSettings)) {\n                this.activeObj.strokeSettings = this.strokeSettings;\n            }\n            this.activeObj.strokeSettings.strokeColor = strokeColor ? strokeColor : this.activeObj.strokeSettings.strokeColor;\n            this.activeObj.textSettings.text = text ? text : this.activeObj.textSettings.text;\n            this.activeObj.textSettings.fontFamily = fontFamily ? fontFamily : this.activeObj.textSettings.fontFamily;\n            this.activeObj.textSettings.text = text ? text : this.activeObj.textSettings.text;\n            this.activeObj.textSettings.fontFamily = fontFamily ? fontFamily : this.activeObj.textSettings.fontFamily;\n            this.activeObj.textSettings.fontSize = fontSize ? fontSize : this.activeObj.textSettings.fontSize;\n            this.activeObj.textSettings.bold = bold ? bold : this.activeObj.textSettings.bold;\n            this.activeObj.textSettings.italic = italic ? italic : this.activeObj.textSettings.italic;\n            if (isNullOrUndefined(this.activeObj.textSettings.fontSize)) {\n                if (this.lowerCanvas.width > this.lowerCanvas.height) {\n                    this.activeObj.textSettings.fontSize = Math.floor((this.lowerCanvas.width / 20));\n                }\n                else {\n                    this.activeObj.textSettings.fontSize = Math.floor((this.lowerCanvas.height / 20));\n                }\n                if (this.activeObj.textSettings.fontSize < 20) {\n                    this.activeObj.textSettings.fontSize = 20;\n                }\n            }\n            if (this.destWidth < 100) {\n                this.activeObj.textSettings.fontSize = Math.floor((this.destWidth / 20));\n            }\n            else if (this.destHeight < 100) {\n                this.activeObj.textSettings.fontSize = Math.floor((this.destHeight / 20));\n            }\n            this.activeObj.shapeDegree = this.degree;\n            this.activeObj.shapeFlip = this.currFlipState;\n            this.activeObj.flipObjColl = [];\n            this.updateFontStyles();\n            var width = this.upperContext.measureText(this.activeObj.textSettings.text).width +\n                this.activeObj.textSettings.fontSize * 0.5;\n            var height = this.activeObj.textSettings.fontSize + this.activeObj.textSettings.fontSize * 0.25;\n            if (!isNullOrUndefined(x) && !isNullOrUndefined(y)) {\n                this.activeObj.activePoint.startX = x;\n                this.activeObj.activePoint.startY = y;\n                this.activeObj.activePoint.endX = this.activeObj.activePoint.startX + width;\n                this.activeObj.activePoint.endY = this.activeObj.activePoint.startY + height;\n            }\n            else {\n                this.setCenterPoints(true, width, height);\n            }\n            var shapeSettings = this.updatePreviousShapeSettings();\n            var shapeChangingArgs = { action: 'insert', previousShapeSettings: shapeSettings,\n                currentShapeSettings: shapeSettings };\n            this.trigger('shapeChanging', shapeChangingArgs);\n            this.updateShapeChangeEventArgs(shapeChangingArgs.currentShapeSettings);\n            this.addLetter(this.activeObj.textSettings.text);\n            this.activeObj.textFlip = this.currFlipState;\n            this.updateFontRatio(this.activeObj);\n            this.objColl.push(this.activeObj);\n            var prevCropObj = extend({}, this.cropObj, {}, true);\n            this.updateUndoRedoColl('shapeTransform', prevObj, prevObj.objColl, prevObj.pointColl, prevCropObj);\n            this.redrawShape(this.objColl[this.objColl.length - 1]);\n            this.isShapeInserted = true;\n            this.refreshToolbar('text');\n        }\n    };\n    ImageEditor.prototype.updateShapeChangeEventArgs = function (shapeSettings) {\n        this.activeObj.currIndex = shapeSettings.id;\n        this.activeObj.activePoint.startX = shapeSettings.startX;\n        this.activeObj.activePoint.startY = shapeSettings.startY;\n        this.activeObj.activePoint.width = shapeSettings.width;\n        this.activeObj.activePoint.height = shapeSettings.height;\n        this.activeObj.strokeSettings.strokeColor = shapeSettings.strokeColor;\n        this.activeObj.strokeSettings.fillColor = shapeSettings.fillColor;\n        this.activeObj.shape === 'ellipse' ? this.activeObj.activePoint.width = shapeSettings.radius / 2 : null;\n        this.activeObj.shape === 'line' ? this.activeObj.activePoint.width = shapeSettings.length : null;\n        this.activeObj.shape === 'text' ? this.activeObj.keyHistory = shapeSettings.text : null;\n        this.activeObj.shape === 'text' ? this.activeObj.textSettings.fontSize = shapeSettings.fontSize : null;\n        this.activeObj.shape === 'text' ? this.activeObj.strokeSettings.strokeColor = shapeSettings.color : null;\n        if (this.activeObj.shape === 'text' && !isNullOrUndefined(this.activeObj.textSettings)) {\n            for (var i = 0; i < shapeSettings.fontStyle.length; i++) {\n                if (shapeSettings.fontStyle[i] === 'bold') {\n                    this.activeObj.textSettings.bold = true;\n                }\n                else if (shapeSettings.fontStyle[i] === 'italic') {\n                    this.activeObj.textSettings.italic = true;\n                }\n                else if (shapeSettings.fontStyle[i] === 'underline') {\n                    this.activeObj.textSettings.underline = true;\n                }\n            }\n        }\n    };\n    ImageEditor.prototype.getObjDetails = function (obj) {\n        var shapeDetails = {};\n        shapeDetails.id = obj.currIndex;\n        shapeDetails.type = this.toPascalCase(obj.shape);\n        shapeDetails.startX = obj.activePoint.startX;\n        shapeDetails.startY = obj.activePoint.startY;\n        if (obj.shape === 'rectangle') {\n            shapeDetails.width = obj.activePoint.width;\n            shapeDetails.height = obj.activePoint.height;\n            shapeDetails.strokeColor = obj.strokeSettings.strokeColor;\n            shapeDetails.fillColor = obj.strokeSettings.fillColor;\n            shapeDetails.strokeWidth = obj.strokeSettings.strokeWidth;\n        }\n        else if (obj.shape === 'ellipse') {\n            shapeDetails.radius = obj.activePoint.width / 2;\n            shapeDetails.strokeColor = obj.strokeSettings.strokeColor;\n            shapeDetails.fillColor = obj.strokeSettings.fillColor;\n            shapeDetails.strokeWidth = obj.strokeSettings.strokeWidth;\n        }\n        else if (obj.shape === 'line') {\n            shapeDetails.length = obj.activePoint.width;\n            shapeDetails.strokeColor = obj.strokeSettings.strokeColor;\n            shapeDetails.strokeWidth = obj.strokeSettings.strokeWidth;\n        }\n        else if (obj.shape === 'text') {\n            shapeDetails.text = obj.keyHistory;\n            shapeDetails.fontSize = obj.textSettings.fontSize;\n            shapeDetails.color = obj.strokeSettings.strokeColor;\n            shapeDetails.fontStyle = [];\n            if (obj.textSettings.bold) {\n                shapeDetails.fontStyle.push('bold');\n            }\n            if (obj.textSettings.italic) {\n                shapeDetails.fontStyle.push('italic');\n            }\n        }\n        return shapeDetails;\n    };\n    ImageEditor.prototype.getFreehandDrawDetails = function (index) {\n        var shapeDetails = {};\n        shapeDetails.id = this.pointColl[index].id;\n        shapeDetails.type = 'FreehandDraw';\n        shapeDetails.points = extend([], this.pointColl[index].points);\n        shapeDetails.strokeColor = this.pointColl[index].strokeColor;\n        shapeDetails.strokeWidth = this.pointColl[index].strokeWidth;\n        return shapeDetails;\n    };\n    ImageEditor.prototype.isPointsInRange = function (x, y) {\n        var inRange = false;\n        if (x >= 0 && y >= 0 && x <= this.lowerCanvas.width && y <= this.lowerCanvas.width) {\n            inRange = true;\n        }\n        return inRange;\n    };\n    ImageEditor.prototype.clearActObj = function () {\n        if (this.textArea.style.display === 'none') {\n            this.refreshActiveObj();\n            this.applyActObj();\n            this.refreshActiveObj();\n            this.currObjType.isCustomCrop = false;\n        }\n    };\n    ImageEditor.prototype.applyPenDraw = function () {\n        if (this.currObjType.shape === 'freehanddraw') {\n            this.apply();\n            this.upperCanvas.style.cursor = 'default';\n            this.currObjType.shape = '';\n        }\n        this.clearActObj();\n    };\n    ImageEditor.prototype.drawRotatedImage = function (degree) {\n        if (degree === 0) {\n            this.degree = 0;\n        }\n        else {\n            this.degree += degree;\n        }\n        if (this.degree === 360 || this.degree === -360) {\n            this.degree = 0;\n        }\n        this.setDestinationPoints();\n        var tempObjColl = extend([], this.objColl, [], true);\n        var tempActiveObj = extend({}, this.activeObj, {}, true);\n        this.objColl = [];\n        this.refreshActiveObj();\n        if (!this.isReverseRotate) {\n            this.updateCurrentTransformedState('initial');\n        }\n        this.rotateDegree(degree);\n        if (!this.isReverseRotate) {\n            this.updateCurrentTransformedState('reverse');\n            this.rotateFlipColl.push(degree);\n        }\n        if (this.rotateFlipColl.length === 1) {\n            this.setClientTransformedDimension();\n        }\n        this.objColl = extend([], tempObjColl, [], true);\n        this.activeObj = extend({}, tempActiveObj, {}, true);\n        if (this.isCircleCrop) {\n            this.cropCircle(this.lowerContext);\n        }\n        this.redrawObj(degree);\n        this.refreshActiveObj();\n        if (degree > 0) {\n            this.rotateFreehandDrawColl();\n        }\n        else {\n            for (var i = 0; i < 3; i++) {\n                this.rotateFreehandDrawColl();\n            }\n        }\n        this.freehandRedraw(this.lowerContext);\n        this.updateCurrSelectionPoint(degree);\n    };\n    ImageEditor.prototype.updateCurrSelectionPoint = function (degree) {\n        if (!isNullOrUndefined(this.currSelectionPoint) && !isNullOrUndefined(this.currDestinationPoint)) {\n            var activeObj = extend({}, this.activeObj, {}, true);\n            var objColl = extend([], this.objColl, [], true);\n            var srcPoints = { startX: this.srcLeft, startY: this.srcTop, width: this.srcWidth, height: this.srcHeight };\n            var destPoints = { startX: this.destLeft, startY: this.destTop, width: this.destWidth, height: this.destHeight };\n            this.objColl = [];\n            this.objColl.push(extend({}, this.currSelectionPoint, {}, true));\n            this.srcLeft = 0;\n            this.srcTop = 0;\n            this.srcWidth = this.baseImg.width;\n            this.srcHeight = this.baseImg.height;\n            this.destLeft = this.currDestinationPoint.startX;\n            this.destTop = this.currDestinationPoint.startY;\n            this.destWidth = this.currDestinationPoint.width;\n            this.destHeight = this.currDestinationPoint.height;\n            if (typeof (degree) === 'number') {\n                this.setDestinationPoints();\n                this.setClientTransformedDimension();\n            }\n            this.objColl[0].shapeFlip = '';\n            this.redrawObj(degree);\n            this.currSelectionPoint = extend({}, this.objColl[0], {}, true);\n            this.currDestinationPoint = { startX: this.destLeft, startY: this.destTop, width: this.destWidth, height: this.destHeight };\n            this.objColl = objColl;\n            this.activeObj = activeObj;\n            this.srcLeft = srcPoints.startX;\n            this.srcTop = srcPoints.startY;\n            this.srcWidth = srcPoints.width;\n            this.srcHeight = srcPoints.height;\n            this.destLeft = destPoints.startX;\n            this.destTop = destPoints.startY;\n            this.destWidth = destPoints.width;\n            this.destHeight = destPoints.height;\n        }\n    };\n    ImageEditor.prototype.setClientTransformedDimension = function (isPreventDimension) {\n        if (this.degree % 90 === 0 && this.degree % 180 !== 0) {\n            this.destLeft = (this.lowerCanvas.width - this.destHeight) / 2;\n            this.destTop = (this.lowerCanvas.height - this.destWidth) / 2;\n            var temp = this.destWidth;\n            this.destWidth = this.destHeight;\n            this.destHeight = temp;\n        }\n        else {\n            if (isNullOrUndefined(isPreventDimension)) {\n                this.destLeft = (this.lowerCanvas.width - this.destWidth) / 2;\n                this.destTop = (this.lowerCanvas.height - this.destHeight) / 2;\n            }\n        }\n    };\n    ImageEditor.prototype.popForDefaultTransformedState = function (collection) {\n        var rotateRight = 0;\n        var rotateleft = 0;\n        var horizontal = 0;\n        var vertical = 0;\n        for (var i = 0; i < collection.length; i++) {\n            if (collection[i] === 90 || collection[i] === 'rotateRight') {\n                rotateRight++;\n                rotateleft = 0;\n                horizontal = 0;\n                vertical = 0;\n                if (rotateRight === 4) {\n                    collection.pop();\n                    collection.pop();\n                    collection.pop();\n                    collection.pop();\n                }\n            }\n            else if (collection[i] === -90 || collection[i] === 'rotateLeft') {\n                rotateleft++;\n                rotateRight = 0;\n                horizontal = 0;\n                vertical = 0;\n                if (rotateleft === 4) {\n                    collection.pop();\n                    collection.pop();\n                    collection.pop();\n                    collection.pop();\n                }\n            }\n            else if (collection[i] === 'horizontal' || collection[i] === 'horizontalflip') {\n                horizontal++;\n                rotateleft = 0;\n                rotateRight = 0;\n                vertical = 0;\n                if (horizontal === 2) {\n                    collection.pop();\n                    collection.pop();\n                }\n            }\n            else if (collection[i] === 'vertical' || collection[i] === 'verticalflip') {\n                vertical++;\n                horizontal = 0;\n                rotateleft = 0;\n                rotateRight = 0;\n                if (vertical === 2) {\n                    collection.pop();\n                    collection.pop();\n                }\n            }\n        }\n        return collection;\n    };\n    ImageEditor.prototype.popForDefaultFlipState = function (collection) {\n        for (var i = 0; i < collection.length; i++) {\n            if (!isNullOrUndefined(collection[i + 3])) {\n                if ((collection[i] === 'horizontal' || collection[i] === 'horizontalFlip')\n                    && (collection[i + 1] === 'vertical' || collection[i] === 'verticalFlip') &&\n                    (collection[i + 2] === 'horizontal' || collection[i] === 'horizontalFlip') &&\n                    (collection[i + 3] === 'vertical' || collection[i] === 'verticalFlip')) {\n                    collection.pop();\n                    collection.pop();\n                    collection.pop();\n                    collection.pop();\n                }\n                else if ((collection[i] === 'vertical' || collection[i] === 'verticalFlip')\n                    && (collection[i + 1] === 'horizontal' || collection[i + 1] === 'horizontalFlip') &&\n                    (collection[i + 2] === 'vertical' || collection[i] === 'verticalFlip') &&\n                    (collection[i + 3] === 'horizontal' || collection[i] === 'horizontalFlip')) {\n                    collection.pop();\n                    collection.pop();\n                    collection.pop();\n                    collection.pop();\n                }\n            }\n        }\n        return collection;\n    };\n    ImageEditor.prototype.popForDefaultRotateState = function (collection) {\n        for (var i = 0; i < collection.length; i++) {\n            if (!isNullOrUndefined(collection[i + 1])) {\n                if ((collection[i] === 90 || collection[i] === 'rotateRight') &&\n                    (collection[i + 1] === -90 || collection[i] === 'rotateLeft')) {\n                    collection.pop();\n                    collection.pop();\n                }\n                else if ((collection[i] === -90 || collection[i] === 'rotateLeft') &&\n                    (collection[i + 1] === 90 || collection[i] === 'rotateRight')) {\n                    collection.pop();\n                    collection.pop();\n                }\n            }\n        }\n        return collection;\n    };\n    ImageEditor.prototype.alignRotateFlipColl = function (collection, isRotateFlipCollection) {\n        collection = this.popForDefaultTransformedState(collection);\n        collection = this.popForDefaultFlipState(collection);\n        collection = this.popForDefaultRotateState(collection);\n        if (collection.length === 0 && isRotateFlipCollection) {\n            this.degree = 0;\n            this.currFlipState = '';\n        }\n        return collection;\n    };\n    ImageEditor.prototype.updateFlipColl = function (direction) {\n        if (this.flipColl.length === 0) {\n            this.flipColl.push(direction);\n        }\n        else {\n            if (this.flipColl[this.flipColl.length - 1] === 'direction') {\n                this.flipColl.pop();\n            }\n            else {\n                this.flipColl.push(direction);\n            }\n        }\n        if (this.flipColl.length >= 4) {\n            if (this.flipColl[this.flipColl.length - 1] === 'horizontal' && this.flipColl[this.flipColl.length - 2] === 'vertical' &&\n                this.flipColl[this.flipColl.length - 3] === 'horizontal' && this.flipColl[this.flipColl.length - 4] === 'vertical') {\n                for (var i = 0; i < 4; i++) {\n                    this.flipColl.pop();\n                }\n            }\n            else if (this.flipColl[this.flipColl.length - 1] === 'vertical' && this.flipColl[this.flipColl.length - 2] === 'horizontal' &&\n                this.flipColl[this.flipColl.length - 3] === 'vertical' && this.flipColl[this.flipColl.length - 4] === 'horizontal') {\n                for (var i = 0; i < 4; i++) {\n                    this.flipColl.pop();\n                }\n            }\n        }\n    };\n    ImageEditor.prototype.horizontalFlip = function () {\n        this.lowerContext.translate(this.lowerContext.canvas.width, 0);\n        this.lowerContext.scale(-1, 1);\n        this.upperContext.translate(this.upperContext.canvas.width, 0);\n        this.upperContext.scale(-1, 1);\n    };\n    ImageEditor.prototype.verticalFlip = function () {\n        this.lowerContext.translate(0, this.lowerContext.canvas.height);\n        this.lowerContext.scale(1, -1);\n        this.upperContext.translate(0, this.upperContext.canvas.height);\n        this.upperContext.scale(1, -1);\n    };\n    ImageEditor.prototype.updateFlipState = function (direction) {\n        if (direction === 'horizontal' && this.degree % 90 === 0 && this.degree % 180 !== 0) {\n            this.verticalFlip();\n        }\n        else if (direction === 'vertical' && this.degree % 90 === 0 && this.degree % 180 !== 0) {\n            this.horizontalFlip();\n        }\n        else if (direction === 'horizontal') {\n            this.horizontalFlip();\n        }\n        else if (direction === 'vertical') {\n            this.verticalFlip();\n        }\n    };\n    ImageEditor.prototype.setDestinationPoints = function () {\n        var maxDimension;\n        if (this.degree % 90 === 0 && this.degree % 180 !== 0) {\n            maxDimension = this.calcMaxDimension(this.srcHeight, this.srcWidth);\n            if (this.isRotateZoom) {\n                maxDimension.width += (maxDimension.width * this.zoomFactor);\n                maxDimension.height += (maxDimension.height * this.zoomFactor);\n                this.destWidth = maxDimension.height;\n                this.destHeight = maxDimension.width;\n            }\n            this.destLeft = (this.lowerCanvas.clientWidth - maxDimension.height) / 2;\n            this.destTop = (this.lowerCanvas.clientHeight - maxDimension.width) / 2;\n            this.destWidth = maxDimension.height;\n            this.destHeight = maxDimension.width;\n        }\n        else {\n            maxDimension = this.calcMaxDimension(this.srcWidth, this.srcHeight);\n            if (this.isRotateZoom) {\n                maxDimension.width += (maxDimension.width * this.zoomFactor);\n                maxDimension.height += (maxDimension.height * this.zoomFactor);\n                this.destWidth = maxDimension.width;\n                this.destHeight = maxDimension.height;\n            }\n            this.destLeft = (this.lowerCanvas.clientWidth - maxDimension.width) / 2;\n            this.destTop = (this.lowerCanvas.clientHeight - maxDimension.height) / 2;\n            this.destWidth = maxDimension.width;\n            this.destHeight = maxDimension.height;\n        }\n    };\n    ImageEditor.prototype.rotatedFlip = function () {\n        this.isReverseFlip = true;\n        var tempCurrFlipState = this.currFlipState;\n        var tempFlipColl = this.flipColl;\n        var tempObjColl = extend([], this.objColl, [], true);\n        var tempActiveObj = extend({}, this.activeObj, {}, true);\n        this.flipColl = [];\n        this.objColl = [];\n        this.refreshActiveObj();\n        this.currentTransformedState('initial');\n        var temp = this.lowerContext.filter;\n        this.updateBrightnessFilter();\n        this.lowerContext.drawImage(this.baseImg, this.srcLeft, this.srcTop, this.srcWidth, this.srcHeight, this.destLeft, this.destTop, this.destWidth, this.destHeight);\n        this.lowerContext.filter = temp;\n        this.currentTransformedState('reverse', true);\n        if (tempCurrFlipState === '' && this.currFlipState !== '') {\n            tempCurrFlipState = this.currFlipState;\n        }\n        this.currFlipState = tempCurrFlipState;\n        this.flipColl = tempFlipColl;\n        this.objColl = extend([], tempObjColl, [], true);\n        this.lowerContext.filter = 'none';\n        this.iterateObjColl();\n        this.lowerContext.filter = temp;\n        if (tempActiveObj.activePoint.width !== 0) {\n            this.activeObj = extend({}, tempActiveObj, {}, true);\n        }\n        this.isReverseFlip = false;\n    };\n    ImageEditor.prototype.getFilterValue = function (value) {\n        var filterValue;\n        if (value === 0) {\n            filterValue = 1;\n        }\n        else {\n            filterValue = 1 + ((value * 0.5) / 100);\n        }\n        return filterValue;\n    };\n    ImageEditor.prototype.setFilterValue = function (value) {\n        var filterValue;\n        if (value === 1) {\n            filterValue = 0;\n        }\n        else {\n            filterValue = ((value - 1) * 100) / 0.5;\n        }\n        return Math.round(filterValue);\n    };\n    ImageEditor.prototype.getSaturationFilterValue = function (value) {\n        var filterValue;\n        if (value === 0) {\n            filterValue = 1;\n        }\n        else {\n            filterValue = 1 + (value / 100);\n        }\n        return filterValue;\n    };\n    ImageEditor.prototype.setSaturationFilterValue = function (value) {\n        var filterValue;\n        if (value === 1) {\n            filterValue = 0;\n        }\n        else {\n            filterValue = (value - 1) * 100;\n        }\n        return Math.round(filterValue);\n    };\n    ImageEditor.prototype.getBlackAndWhiteData = function (imageData) {\n        for (var i = 0; i < imageData.data.length; i += 4) {\n            var count = imageData.data[i] + imageData.data[i + 1] + imageData.data[i + 2];\n            var colour = 0;\n            if (count > 383) {\n                colour = 255;\n            }\n            imageData.data[i] = colour;\n            imageData.data[i + 1] = colour;\n            imageData.data[i + 2] = colour;\n            imageData.data[i + 3] = 255;\n        }\n        return imageData;\n    };\n    ImageEditor.prototype.setBrightness = function (value) {\n        this.applyPenDraw();\n        this.adjustmentLevel.brightness = value;\n        value = this.getFilterValue(value);\n        var prevCropObj = extend({}, this.cropObj, {}, true);\n        var prevObj = this.getCurrentObj();\n        prevObj.objColl = extend([], this.objColl, [], true);\n        prevObj.pointColl = extend([], this.pointColl, [], true);\n        prevObj.afterCropActions = extend([], this.afterCropActions, [], true);\n        this.updateAdjustment('brightness', value);\n        this.updateUndoRedoColl('brightness', prevObj, prevObj.objColl, prevObj.pointColl, prevCropObj);\n    };\n    ImageEditor.prototype.setContrast = function (value) {\n        this.applyPenDraw();\n        this.adjustmentLevel.contrast = value;\n        value = this.getFilterValue(value);\n        value *= 100;\n        var prevCropObj = extend({}, this.cropObj, {}, true);\n        var prevObj = this.getCurrentObj();\n        prevObj.objColl = extend([], this.objColl, [], true);\n        prevObj.pointColl = extend([], this.pointColl, [], true);\n        prevObj.afterCropActions = extend([], this.afterCropActions, [], true);\n        this.updateAdjustment('contrast', value);\n        this.updateUndoRedoColl('contrast', prevObj, prevObj.objColl, prevObj.pointColl, prevCropObj);\n    };\n    ImageEditor.prototype.setHue = function (value) {\n        this.applyPenDraw();\n        this.adjustmentLevel.hue = value;\n        value *= 3;\n        var prevCropObj = extend({}, this.cropObj, {}, true);\n        var prevObj = this.getCurrentObj();\n        prevObj.objColl = extend([], this.objColl, [], true);\n        prevObj.pointColl = extend([], this.pointColl, [], true);\n        prevObj.afterCropActions = extend([], this.afterCropActions, [], true);\n        this.updateAdjustment('hue', value);\n        this.updateUndoRedoColl('hue', prevObj, prevObj.objColl, prevObj.pointColl, prevCropObj);\n    };\n    ImageEditor.prototype.setSaturation = function (value) {\n        this.applyPenDraw();\n        this.adjustmentLevel.saturation = value;\n        value = this.getSaturationFilterValue(value);\n        value *= 100;\n        var prevCropObj = extend({}, this.cropObj, {}, true);\n        var prevObj = this.getCurrentObj();\n        prevObj.objColl = extend([], this.objColl, [], true);\n        prevObj.pointColl = extend([], this.pointColl, [], true);\n        prevObj.afterCropActions = extend([], this.afterCropActions, [], true);\n        this.updateAdjustment('saturation', value);\n        this.updateUndoRedoColl('saturation', prevObj, prevObj.objColl, prevObj.pointColl, prevCropObj);\n    };\n    ImageEditor.prototype.setOpacity = function (value) {\n        this.applyPenDraw();\n        this.adjustmentLevel.opacity = value;\n        if (value >= 50) {\n            value /= 100;\n        }\n        else if (value === 40) {\n            value = 0.45;\n        }\n        else if (value === 30) {\n            value = 0.40;\n        }\n        else if (value === 20) {\n            value = 0.35;\n        }\n        else if (value === 10) {\n            value = 0.30;\n        }\n        else if (value === 0) {\n            value = 0.25;\n        }\n        var prevCropObj = extend({}, this.cropObj, {}, true);\n        var prevObj = this.getCurrentObj();\n        prevObj.objColl = extend([], this.objColl, [], true);\n        prevObj.pointColl = extend([], this.pointColl, [], true);\n        prevObj.afterCropActions = extend([], this.afterCropActions, [], true);\n        this.updateAdjustment('opacity', value);\n        this.updateUndoRedoColl('opacity', prevObj, prevObj.objColl, prevObj.pointColl, prevCropObj);\n    };\n    ImageEditor.prototype.setBlur = function (value) {\n        this.applyPenDraw();\n        this.adjustmentLevel.blur = value;\n        value /= 20;\n        // Since 0.5 is not working in blur we consider from 1\n        value += 0.5;\n        var prevCropObj = extend({}, this.cropObj, {}, true);\n        var prevObj = this.getCurrentObj();\n        prevObj.objColl = extend([], this.objColl, [], true);\n        prevObj.pointColl = extend([], this.pointColl, [], true);\n        prevObj.afterCropActions = extend([], this.afterCropActions, [], true);\n        this.updateAdjustment('blur', value);\n        this.updateUndoRedoColl('blur', prevObj, prevObj.objColl, prevObj.pointColl, prevCropObj);\n    };\n    ImageEditor.prototype.setExposure = function (value) {\n        this.applyPenDraw();\n        this.adjustmentLevel.exposure = value;\n        value = this.getFilterValue(value);\n        var prevCropObj = extend({}, this.cropObj, {}, true);\n        var prevObj = this.getCurrentObj();\n        prevObj.objColl = extend([], this.objColl, [], true);\n        prevObj.pointColl = extend([], this.pointColl, [], true);\n        prevObj.afterCropActions = extend([], this.afterCropActions, [], true);\n        this.updateAdjustment('exposure', value);\n        this.updateUndoRedoColl('exposure', prevObj, prevObj.objColl, prevObj.pointColl, prevCropObj);\n    };\n    ImageEditor.prototype.setFilter = function (type) {\n        type = type.toLowerCase();\n        this.applyPenDraw();\n        var prevFilter = this.currentFilter;\n        var prevCropObj = extend({}, this.cropObj, {}, true);\n        var prevObj = this.getCurrentObj();\n        prevObj.objColl = extend([], this.objColl, [], true);\n        prevObj.pointColl = extend([], this.pointColl, [], true);\n        prevObj.afterCropActions = extend([], this.afterCropActions, [], true);\n        this.updateAdjustment(type, null);\n        this.updateUndoRedoColl(type, prevObj, prevObj.objColl, prevObj.pointColl, prevCropObj, null, null, prevFilter);\n    };\n    ImageEditor.prototype.renderImage = function () {\n        var temp = this.lowerContext.filter;\n        this.applyActObj();\n        this.upperContext.clearRect(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n        this.lowerContext.clearRect(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n        this.updateCurrentTransformedState('initial');\n        this.updateBrightnessFilter();\n        this.lowerContext.drawImage(this.baseImg, this.srcLeft, this.srcTop, this.srcWidth, this.srcHeight, this.destLeft, this.destTop, this.destWidth, this.destHeight);\n        this.updateCurrentTransformedState('reverse');\n        this.lowerContext.filter = 'none';\n        this.iterateObjColl();\n        this.freehandRedraw(this.lowerContext);\n        this.lowerContext.filter = temp;\n        if (this.isCircleCrop || (!isNullOrUndefined(this.currSelectionPoint) && this.currSelectionPoint.shape === 'crop-circle')) {\n            this.cropCircle(this.lowerContext);\n        }\n    };\n    ImageEditor.prototype.updateTextBox = function (obj) {\n        this.upperContext.clearRect(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n        this.lowerContext.clearRect(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n        this.redrawImgWithObj();\n        this.textArea.style.display = 'block';\n        this.textArea.style.fontFamily = obj.textSettings.fontFamily;\n        this.textArea.style.fontSize = obj.textSettings.fontSize + 'px';\n        this.textArea.style.color = obj.strokeSettings.strokeColor;\n        this.textArea.style.fontWeight = obj.textSettings.bold ? 'bold' : 'normal';\n        this.textArea.style.fontStyle = obj.textSettings.italic ? 'italic' : 'normal';\n        this.textArea.style.border = '2px solid ' + this.themeColl[this.theme]['primaryColor'];\n        this.textArea.value = obj.keyHistory;\n        this.activeObj = extend({}, obj, {}, true);\n        this.updateFontStyles();\n        this.textArea.style.width = this.activeObj.activePoint.width + 'px';\n    };\n    ImageEditor.prototype.drawNewSelection = function (type, startX, startY, width, height) {\n        var points;\n        var cropShape = 'crop-' + type;\n        if (cropShape.toLowerCase() === 'crop-custom') {\n            if (this.currObjType.shape === '') {\n                this.drawCustomSelection('crop-custom');\n            }\n            if (startX && startY) {\n                this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n                this.currObjType.shape = this.activeObj.shape = cropShape.toLowerCase();\n                this.activeObj.activePoint.startX = startX;\n                this.activeObj.activePoint.startY = startY;\n                this.activeObj.activePoint.endX = this.lowerCanvas.width;\n                this.activeObj.activePoint.endY = this.lowerCanvas.height;\n                this.activeObj.activePoint.width = this.activeObj.activePoint.endX - this.activeObj.activePoint.startX;\n                this.activeObj.activePoint.height = this.activeObj.activePoint.endY - this.activeObj.activePoint.startY;\n                this.drawObject('duplicate');\n            }\n        }\n        else if (cropShape.toLowerCase() === 'crop-canvas') {\n            this.upperCanvas.style.display = 'none';\n            this.dragCanvas = true;\n        }\n        else {\n            this.currObjType.isCustomCrop = false;\n            this.currObjType.shape = cropShape.toLowerCase();\n            if (width && height) {\n                points = { startX: startX, startY: startY, endX: startX + width, endY: startY + height,\n                    width: width, height: height };\n            }\n            else if (width && cropShape === 'crop-circle') {\n                points = { startX: startX, startY: startY, endX: startX + width, endY: startY + width,\n                    width: width, height: width };\n            }\n            this.activeObj.shape = cropShape.toLowerCase();\n            this.drawObject('duplicate', null, true, points);\n        }\n    };\n    ImageEditor.prototype.setDestPointsForFlipState = function (isUpdate) {\n        if (this.getCurrentPanRegion() !== '') {\n            if (this.getCurrentPanRegion() === 'horizontal') {\n                this.destLeft = this.lowerCanvas.clientWidth - (this.destWidth + this.destLeft);\n            }\n            else if (this.getCurrentPanRegion() === 'vertical') {\n                this.destTop = this.lowerCanvas.clientHeight - (this.destHeight + this.destTop);\n            }\n            else {\n                this.destLeft = this.lowerCanvas.clientWidth - (this.destWidth + this.destLeft);\n                this.destTop = this.lowerCanvas.clientHeight - (this.destHeight + this.destTop);\n            }\n        }\n    };\n    ImageEditor.prototype.performUndoDefaultAction = function (obj) {\n        this.lowerContext.filter = obj.previousObj.filter;\n        this.objColl = [];\n        this.pointColl = [];\n        this.freehandCounter = 0;\n        this.setCurrentObj(obj.previousObj);\n        this.destLeft = obj.previousObj.destPoints.startX;\n        this.destTop = obj.previousObj.destPoints.startY;\n        var activeObj = extend({}, this.activeObj, {}, true);\n        this.objColl = extend([], obj.previousObjColl, [], true);\n        this.pointColl = extend([], obj.previousPointColl, [], true);\n        this.freehandCounter = this.pointColl.length;\n        this.lowerContext.filter = 'none';\n        this.iterateObjColl();\n        this.freehandRedraw(this.lowerContext);\n        this.lowerContext.filter = obj.previousObj.filter;\n        this.activeObj = activeObj;\n        this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n        if (this.activeObj.activePoint.width !== 0 && this.activeObj.activePoint.height !== 0) {\n            this.drawObject('duplicate');\n        }\n    };\n    ImageEditor.prototype.setAdjustment = function (type) {\n        var splitWords = this.lowerContext.filter.split(' ');\n        var value;\n        var valueArr;\n        switch (type) {\n            case 'brightness':\n                valueArr = splitWords[0].split('(');\n                value = parseFloat(valueArr[1].split(')')[0]);\n                this.adjustmentLevel.brightness = this.setFilterValue(value);\n                break;\n            case 'contrast':\n                valueArr = splitWords[1].split('(');\n                value = parseFloat(valueArr[1].split(')')[0]);\n                value /= 100;\n                this.adjustmentLevel.contrast = this.setFilterValue(value);\n                break;\n            case 'hue':\n                valueArr = splitWords[2].split('(');\n                value = parseFloat(valueArr[1].split(')')[0]);\n                value /= 3;\n                this.adjustmentLevel.hue = value;\n                break;\n            case 'saturation':\n                valueArr = splitWords[3].split('(');\n                value = parseFloat(valueArr[1].split(')')[0]);\n                value /= 100;\n                this.adjustmentLevel.saturation = this.setSaturationFilterValue(value);\n                break;\n            case 'opacity':\n                valueArr = splitWords[4].split('(');\n                value = parseFloat(valueArr[1].split(')')[0]);\n                if (value === 0.45) {\n                    value = 40;\n                }\n                else if (value === 0.40) {\n                    value = 30;\n                }\n                else if (value === 0.35) {\n                    value = 20;\n                }\n                else if (value === 0.30) {\n                    value = 10;\n                }\n                else if (value === 0.25) {\n                    value = 0;\n                }\n                else {\n                    value *= 100;\n                }\n                this.adjustmentLevel.opacity = value;\n                break;\n            case 'blur':\n                valueArr = splitWords[5].split('(');\n                value = parseFloat(valueArr[1].split(')')[0]);\n                value *= 20;\n                this.adjustmentLevel.blur = value;\n                break;\n            case 'exposure':\n                valueArr = splitWords[0].split('(');\n                value = parseFloat(valueArr[1].split(')')[0]);\n                this.adjustmentLevel.exposure = this.setFilterValue(value);\n                break;\n        }\n    };\n    ImageEditor.prototype.updateFilter = function (type, previousFilter) {\n        if (type === 'default' || type === 'chrome' || type === 'cold' ||\n            type === 'warm' || type === 'grayscale' || type === 'blackandwhite' ||\n            type === 'sepia' || type === 'invert' || type === 'sharpen') {\n            var selEle = this.element.querySelector('.e-contextual-toolbar-wrapper .e-toolbar-item.e-selected');\n            if (selEle) {\n                selEle.classList.remove('e-selected');\n            }\n            var filterCanvas = document.getElementById(this.element.id + '_' + type + 'Canvas');\n            if (filterCanvas) {\n                filterCanvas.parentElement.classList.add('e-selected');\n            }\n            if (!isNullOrUndefined(previousFilter)) {\n                this.currentFilter = previousFilter;\n            }\n            else {\n                this.currentFilter = this.element.id + '_' + type;\n            }\n        }\n    };\n    /**\n     * Clear a current selection.\n     *\n     * @returns {void}.\n     */\n    ImageEditor.prototype.clearSelection = function () {\n        if (!this.disabled && this.isImageLoaded) {\n            this.togglePen = false;\n            this.refreshActiveObj();\n            this.dragElement = '';\n            this.dragPoint.startX = this.dragPoint.startY = this.dragPoint.endX = this.dragPoint.endY = 0;\n            this.currObjType.shape = '';\n            this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n            this.currObjType.isActiveObj = true;\n            this.currObjType.isCustomCrop = false;\n            this.upperCanvas.style.cursor = 'default';\n        }\n    };\n    /**\n     * Crops an image based on the selection.\n     * The selection can be done through programmatically using the select method or through UI interactions.\n     *\n     * @returns {boolean}.\n     */\n    ImageEditor.prototype.crop = function () {\n        var isCrop = false;\n        if (!this.disabled && this.isImageLoaded) {\n            if (this.currObjType.isUndoAction) {\n                this.refreshUndoRedoColl();\n            }\n            var splitWords = void 0;\n            var transitionArgs = { startPoint: { x: this.activeObj.activePoint.startX, y: this.activeObj.activePoint.startY }, endPoint: { x: this.activeObj.activePoint.endX, y: this.activeObj.activePoint.endY } };\n            this.trigger('cropping', transitionArgs);\n            if (this.activeObj.shape !== undefined) {\n                splitWords = this.activeObj.shape.split('-');\n            }\n            if (!this.disabled && this.activeObj.horTopLine !== undefined && (this.currObjType.isCustomCrop || splitWords[0] === 'crop')) {\n                isCrop = true;\n                var prevCropObj = extend({}, this.cropObj, {}, true);\n                var prevObj = this.getCurrentObj();\n                prevObj.objColl = extend([], this.objColl, [], true);\n                prevObj.pointColl = extend([], this.pointColl, [], true);\n                prevObj.afterCropActions = extend([], this.afterCropActions, [], true);\n                this.cropImg();\n                this.zoomFactor = 0;\n                this.enableDisableToolbarBtn();\n                this.updateUndoRedoColl('crop', prevObj, prevObj.objColl, prevObj.pointColl, prevCropObj);\n            }\n        }\n        return isCrop;\n    };\n    /**\n     * Flips an image by horizontally or vertically.\n     *\n     * @param {Direction } direction - Specifies the direction to flip the image.\n     * @returns {void}.\n     */\n    ImageEditor.prototype.flip = function (direction) {\n        if (!this.disabled && this.isImageLoaded) {\n            var transitionArgs = { direction: direction };\n            this.trigger('flipping', transitionArgs);\n            var prevCropObj = extend({}, this.cropObj, {}, true);\n            var prevObj = void 0;\n            if (isNullOrUndefined(this.transformCurrentObj)) {\n                prevObj = this.getCurrentObj();\n                prevObj.objColl = extend([], this.objColl, null, true);\n                prevObj.pointColl = extend({}, this.pointColl, null, true);\n                prevObj.afterCropActions = extend([], this.afterCropActions, [], true);\n            }\n            this.afterCropActions.push(direction.toLowerCase() === 'horizontal' ? 'horizontalflip' : 'verticalflip');\n            var splitWords = [];\n            var activeObjShape = void 0;\n            if (!isNullOrUndefined(this.activeObj.activePoint)) {\n                if (this.activeObj.shape !== undefined) {\n                    splitWords = this.activeObj.shape.split('-');\n                }\n                if (this.currObjType.isCustomCrop || splitWords[0] === 'crop') {\n                    activeObjShape = this.currObjType.isCustomCrop ? 'custom' : splitWords[1];\n                    this.updateImageRatioForActObj();\n                    this.objColl.push(this.activeObj);\n                    this.refreshActiveObj();\n                }\n            }\n            this.redrawActObj();\n            this.lowerContext.clearRect(0, 0, this.lowerCanvas.height, this.lowerCanvas.width);\n            this.lowerContext.clearRect(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n            this.upperContext.clearRect(0, 0, this.lowerCanvas.height, this.lowerCanvas.width);\n            this.upperContext.clearRect(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n            var tempObjColl = extend([], this.objColl, [], true);\n            var tempActiveObj = extend({}, this.activeObj, {}, true);\n            this.objColl = [];\n            this.refreshActiveObj();\n            if (!this.isReverseFlip) {\n                this.updateCurrentTransformedState('initial');\n            }\n            if (direction.toLowerCase() === 'horizontal') {\n                this.updateFlipState(direction.toLowerCase());\n                if (this.currFlipState.toLowerCase() === 'horizontal') {\n                    this.currFlipState = '';\n                }\n                else {\n                    this.currFlipState = 'horizontal';\n                }\n            }\n            else {\n                this.updateFlipState(direction.toLowerCase());\n                if (this.currFlipState.toLowerCase() === 'vertical') {\n                    this.currFlipState = '';\n                }\n                else {\n                    this.currFlipState = 'vertical';\n                }\n            }\n            if (this.rotatedFlipCropSelection) {\n                this.destLeft += this.totalPannedInternalPoint.x;\n                this.destTop += this.totalPannedInternalPoint.y;\n            }\n            var temp = this.lowerContext.filter;\n            this.updateBrightnessFilter();\n            this.lowerContext.drawImage(this.baseImg, this.srcLeft, this.srcTop, this.srcWidth, this.srcHeight, this.destLeft, this.destTop, this.destWidth, this.destHeight);\n            this.lowerContext.filter = temp;\n            this.updateFlipState(direction.toLowerCase());\n            if (!this.isReverseFlip) {\n                this.updateCurrentTransformedState('reverse');\n                this.updateFlipColl(direction.toLocaleLowerCase());\n                this.rotateFlipColl.push(direction.toLowerCase());\n            }\n            if (this.rotateFlipColl.length === 1) {\n                if (this.getCurrentPanRegion() === '') {\n                    this.setClientTransformedDimension();\n                }\n                else {\n                    this.setDestPointsForFlipState();\n                }\n            }\n            if (this.isCircleCrop) {\n                this.cropCircle(this.lowerContext);\n            }\n            this.objColl = extend([], tempObjColl, [], true);\n            this.activeObj = extend({}, tempActiveObj, {}, true);\n            for (var i = 0, len = this.objColl.length; i < len; i++) {\n                if (this.objColl[i].flipObjColl.length === 0) {\n                    this.objColl[i].flipObjColl.push(direction);\n                }\n                else if (this.objColl[i].flipObjColl[this.objColl[i].flipObjColl.length - 1] === direction) {\n                    this.objColl[i].flipObjColl.pop();\n                }\n                else {\n                    this.objColl[i].flipObjColl.push(direction);\n                }\n            }\n            this.redrawObj(direction.toLowerCase());\n            var tempFilter = this.lowerContext.filter;\n            this.lowerContext.filter = this.getDefaultFilter();\n            this.iterateObjColl();\n            if (!isNullOrUndefined(this.currSelectionPoint)) {\n                tempObjColl = extend([], this.objColl, [], true);\n                this.objColl = [];\n                this.objColl.push(this.currSelectionPoint);\n                this.redrawObj(direction.toLowerCase());\n                this.currSelectionPoint = extend({}, this.objColl[0], {}, true);\n                this.objColl = tempObjColl;\n            }\n            if (direction.toLowerCase() === 'horizontal' || direction.toLowerCase() === 'vertical') {\n                this.flipFreehandrawColl(direction.toLowerCase());\n                this.freehandRedraw(this.lowerContext);\n            }\n            else {\n                this.freehandRedraw(this.lowerContext);\n            }\n            this.lowerContext.filter = tempFilter;\n            this.refreshActiveObj();\n            this.updateCurrSelectionPoint(direction.toLowerCase());\n            if (!this.isUndoRedo && isNullOrUndefined(this.transformCurrentObj)) {\n                this.updateUndoRedoColl('flip', prevObj, prevObj.objColl, prevObj.pointColl, prevCropObj);\n            }\n            this.isUndoRedo = false;\n            this.clearOuterCanvas(this.lowerContext);\n            this.clearOuterCanvas(this.upperContext);\n            if (!isNullOrUndefined(activeObjShape)) {\n                this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n                this.activeObj = extend({}, this.objColl[this.objColl.length - 1], {}, true);\n                this.objColl.pop();\n                this.drawObject('duplicate', this.activeObj);\n                if (!this.isReverseFlip) {\n                    this.refreshToolbar('main', true, true);\n                }\n            }\n            if (isNullOrUndefined(this.activeObj.shape) && !this.isReverseFlip) {\n                this.refreshToolbar('main');\n            }\n            else if (!this.isReverseFlip) {\n                this.refreshToolbar('main', true, true);\n            }\n            this.rotateFlipColl = this.alignRotateFlipColl(this.rotateFlipColl, true);\n        }\n    };\n    /**\n     * Return an image as ImageData.\n     *\n     * @returns {ImageData}.\n     */\n    ImageEditor.prototype.getImageData = function () {\n        var data = this.lowerContext.getImageData(this.destLeft, this.destTop, this.destWidth, this.destHeight);\n        return data;\n    };\n    /**\n     *  Load/opens an image for editing within an image editor.\n     *\n     * @param {string | ImageData } data - Specifies url of the Image or image data.\n     *\n     * @returns {void}.\n     */\n    ImageEditor.prototype.open = function (data) {\n        if (!this.disabled) {\n            showSpinner(this.element);\n            this.element.style.opacity = '0.5';\n            var toolbar_11 = document.querySelector('#' + this.element.id + '_currPos');\n            if (toolbar_11) {\n                toolbar_11.style.display = 'none';\n            }\n            if (this.defToolbarItems.length === 0 &&\n                (isNullOrUndefined(document.getElementById(this.element.id + '_toolbar')))) {\n                this.toolbarHeight = 0;\n            }\n            if (isNullOrUndefined(this.toolbarTemplate)) {\n                this.reset();\n                this.update();\n            }\n            this.degree = 0;\n            this.zoomFactor = 0;\n            this.isImageLoaded = false;\n            this.currSelectionPoint = null;\n            var type = typeof (data);\n            if (type === 'string') {\n                var fileName = data.split('.');\n                if (fileName.length > 1) {\n                    fileName = fileName[fileName.length - 2].split('/');\n                    this.fileName = fileName[fileName.length - 1];\n                }\n                else {\n                    this.fileName = 'ImageEditor';\n                }\n                this.imageOnLoad(data);\n            }\n            else {\n                this.fileName = 'ImageEditor';\n                this.lowerCanvas = document.querySelector('#' + this.element.id + '_lowerCanvas');\n                this.upperCanvas = document.querySelector('#' + this.element.id + '_upperCanvas');\n                this.lowerContext = this.lowerCanvas.getContext('2d');\n                this.upperContext = this.upperCanvas.getContext('2d');\n                this.lowerContext.clearRect(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n                this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n                this.inMemoryContext.clearRect(0, 0, this.inMemoryCanvas.width, this.inMemoryCanvas.height);\n                this.inMemoryCanvas.width = this.baseImg.width = data.width;\n                this.inMemoryCanvas.height = this.baseImg.height = data.height;\n                this.inMemoryContext.putImageData(data, 0, 0);\n                this.baseImg.src = this.inMemoryCanvas.toDataURL();\n            }\n        }\n    };\n    /**\n     * Reset all the changes and revert to original image.\n     *\n     * @returns {void}.\n     */\n    ImageEditor.prototype.reset = function () {\n        if (!this.disabled) {\n            this.inMemoryContext.clearRect(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n            this.inMemoryContext.clearRect(0, 0, this.lowerCanvas.height, this.lowerCanvas.width);\n            this.lowerContext.clearRect(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n            this.lowerContext.clearRect(0, 0, this.lowerCanvas.height, this.lowerCanvas.width);\n            this.upperContext.clearRect(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n            this.upperContext.clearRect(0, 0, this.lowerCanvas.height, this.lowerCanvas.width);\n            this.lowerContext.filter = this.getDefaultFilter();\n            this.refreshActiveObj();\n            this.refreshToolbar('main');\n            if (Browser.isDevice && document.getElementById(this.element.id + '_bottomToolbar')) {\n                getComponent(document.getElementById(this.element.id + '_bottomToolbar'), 'toolbar').destroy();\n                this.createBottomToolbar();\n            }\n            this.objColl = [];\n            this.isImageLoaded = false;\n            this.degree = this.undoRedoStep = 0;\n            this.keyHistory = this.currFlipState = '';\n            this.upperCanvas.style.display = 'none';\n            this.togglePan = this.togglePen = false;\n            this.upperCanvas.style.cursor = this.lowerCanvas.style.cursor = 'default';\n            this.undoRedoColl = [];\n            this.dragCanvas = this.isUndoRedo = false;\n            this.tempKeyHistory = '';\n            this.lowerContext.lineWidth = this.upperContext.lineWidth = undefined;\n            this.touchEndPoint = {};\n            this.currentToolbar = 'main';\n            this.textStartPoints = { x: 0, y: 0 };\n            this.fontSizeColl = [];\n            this.textArea.value = this.textArea.textContent = '';\n            this.textArea.style.display = 'none';\n            this.strokeSettings = { strokeColor: '#fff', fillColor: '', strokeWidth: null };\n            this.textSettings =\n                { text: 'Enter Text', fontFamily: 'Arial', fontSize: null, fontRatio: null, bold: false, italic: false, underline: false };\n            this.tempStrokeSettings = { strokeColor: '#fff', fillColor: '', strokeWidth: null };\n            this.tempTextSettings =\n                { text: 'Enter Text', fontFamily: 'Arial', fontSize: null, fontRatio: null, bold: false, italic: false, underline: false };\n            this.timer = undefined;\n            this.penStrokeWidth = undefined;\n            this.currObjType.isUndoAction = false;\n            this.undoRedoStep = 0;\n            this.tempObjColl = undefined;\n            this.adjustmentLevel = { brightness: 0, contrast: 0, hue: 0, opacity: 100, saturation: 0,\n                blur: 0, exposure: 0, sharpen: false, bw: false };\n            this.tempAdjustmentLevel = { brightness: 0, contrast: 0, hue: 0, opacity: 100, saturation: 0,\n                blur: 0, exposure: 0, sharpen: false, bw: false };\n            this.canvasFilter = this.currentFilter = this.tempAdjustmentValue = '';\n            this.lowerContext.filter = this.initialAdjustmentValue = this.adjustmentValue = this.getDefaultFilter();\n            this.destLeft = this.destTop = this.srcLeft = this.srcTop = 0;\n            this.destWidth = this.destHeight = this.srcWidth = this.srcHeight = null;\n            this.currSelectionPoint = null;\n            this.cropDestPoints = { startX: 0, startY: 0, width: 0, height: 0 };\n            this.panDown = null;\n            this.panMove = null;\n            this.tempPanMove = null;\n            this.flipColl = [];\n            this.freehandDrawObj.time = this.freehandDrawObj.lastVelocity = 0;\n            this.freehandDrawObj.pointX = this.freehandDrawObj.pointY = 0;\n            this.points = [];\n            this.pointColl = {};\n            this.pointCounter = this.freehandCounter = this.tempFreehandCounter = this.tempCurrentFreehandDrawIndex = 0;\n            this.isFreehandDrawing = false;\n            this.isReverseRotate = this.isReverseFlip = this.isPreventDragging = this.isRotateZoom = false;\n            this.currentPannedPoint = null;\n            this.fileType = undefined;\n            this.rotateFlipColl = [];\n            this.isCircleCrop = false;\n            this.isCropTab = false;\n            this.rotatedDestPoints = { startX: 0, startY: 0, width: 0, height: 0 };\n            this.croppedDegree = 0;\n            this.freehandDrawHoveredIndex = this.freehandDrawSelectedIndex = null;\n            this.isFreehandDrawingPoint = this.isFreehandDrawEditing = false;\n            this.tempFreeHandDrawEditingStyles = { strokeColor: null, fillColor: null, strokeWidth: null };\n            this.totalPannedInternalPoint = { x: 0, y: 0 };\n            this.totalPannedClientPoint = { x: 0, y: 0 };\n            this.lowerCanvas.style.left = this.upperCanvas.style.left = '';\n            this.lowerCanvas.style.top = this.upperCanvas.style.top = '';\n            this.lowerCanvas.style.maxWidth = this.upperCanvas.style.maxWidth = '';\n            this.lowerCanvas.style.maxHeight = this.upperCanvas.style.maxHeight = '';\n            this.currentSelectionPoint = null;\n            this.totalPannedPoint = { x: 0, y: 0 };\n            this.fileName = '';\n            this.isBrightnessAdjusted = this.isInitialLoading = false;\n            this.defaultZoomFactor = this.cropZoomFactor = this.zoomFactor = 0;\n            this.tempActObj = null;\n            this.lastPan = { x: 0, y: 0 };\n            this.selectedFreehandColor = '#42a5f5';\n            this.isFreehandDrawCustomized = false;\n            this.isShapeInserted = false;\n            this.isAllowCropPan = false;\n            this.tempPannedPoint = { x: 0, y: 0 };\n            this.currObjType = { shape: '', isDragging: false, isActiveObj: false, isText: false, isInitialText: false, isLine: false,\n                isInitialLine: false, isCustomCrop: false, isZoomed: false, isUndoZoom: false,\n                isUndoAction: false, isFiltered: false, isSave: false };\n            this.cropObj = { cropZoom: 0, defaultZoom: 0, totalPannedPoint: { x: 0, y: 0 }, totalPannedClientPoint: { x: 0, y: 0 },\n                totalPannedInternalPoint: { x: 0, y: 0 }, tempFlipPanPoint: { x: 0, y: 0 }, activeObj: {},\n                rotateFlipColl: [], degree: 0, currFlipState: '',\n                destPoints: { startX: 0, startY: 0, width: 0, height: 0 },\n                srcPoints: { startX: 0, startY: 0, width: 0, height: 0 }, filter: '' };\n            this.afterCropActions = [];\n            this.isCancelAction = this.preventZoomBtn = this.isFreehandPointMoved = false;\n            this.isTouch = false;\n            this.freehandDownPoint = { x: 0, y: 0 };\n            this.tempFlipPanPoint = { x: 0, y: 0 };\n            this.currentFreehandDrawIndex = 0;\n            this.tempCurrentFreehandDrawIndex = 0;\n            this.cancelObjColl = [];\n            this.cancelPointColl = [];\n            this.freehandDrawSelectedId = null;\n            this.transformCurrentObj = null;\n            this.rotatedFlipCropSelection = false;\n            this.panStartObj = null;\n            this.currDestinationPoint = null;\n            this.updateCanvas();\n            this.refreshDropDownBtn(false);\n            this.enableDisableToolbarBtn();\n        }\n    };\n    /**\n     * Rotate an image to clockwise and anti-clockwise.\n     *\n     * @param {number} degree - Specifies a degree to rotate an image.\n     * positive integer value for clockwise and negative integer value for anti-clockwise rotation.\n     *\n     * @returns {boolean}.\n     */\n    ImageEditor.prototype.rotate = function (degree) {\n        var isRotate = false;\n        if (!this.disabled && this.isImageLoaded && (degree % 90 === 0)) {\n            isRotate = true;\n            var transitionArgs = { degree: degree };\n            this.trigger('rotating', transitionArgs);\n            var prevCropObj = extend({}, this.cropObj, {}, true);\n            var prevObj = void 0;\n            if (isNullOrUndefined(this.transformCurrentObj)) {\n                prevObj = this.getCurrentObj();\n                prevObj.objColl = extend([], this.objColl, null, true);\n                prevObj.pointColl = extend({}, this.pointColl, null, true);\n                prevObj.afterCropActions = extend([], this.afterCropActions, [], true);\n            }\n            this.afterCropActions.push(degree === 90 ? 'rotateRight' : 'rotateLeft');\n            var splitWords = [];\n            var activeObjShape = void 0;\n            if (!isNullOrUndefined(this.activeObj.activePoint) && !isNullOrUndefined(this.activeObj.shape)) {\n                if (this.activeObj.shape !== undefined) {\n                    splitWords = this.activeObj.shape.split('-');\n                }\n                if (this.currObjType.isCustomCrop || splitWords[0] === 'crop') {\n                    activeObjShape = this.currObjType.isCustomCrop ? 'custom' : splitWords[1];\n                    this.updateImageRatioForActObj();\n                    this.objColl.push(this.activeObj);\n                    this.refreshActiveObj();\n                }\n            }\n            this.redrawActObj();\n            this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n            this.drawRotatedImage(degree);\n            this.clearOuterCanvas(this.lowerContext);\n            this.clearOuterCanvas(this.upperContext);\n            if (!isNullOrUndefined(activeObjShape)) {\n                this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n                this.activeObj = extend({}, this.objColl[this.objColl.length - 1], {}, true);\n                this.objColl.pop();\n                this.drawObject('duplicate', this.activeObj);\n                if (!this.isReverseRotate) {\n                    this.refreshToolbar('main', true, true);\n                }\n            }\n            if (!this.isUndoRedo && isNullOrUndefined(this.transformCurrentObj)) {\n                this.updateUndoRedoColl('rotate', prevObj, prevObj.objColl, prevObj.pointColl, prevCropObj);\n            }\n            this.isUndoRedo = false;\n            if (isNullOrUndefined(this.activeObj.shape) && !this.isReverseRotate) {\n                this.refreshToolbar('main');\n            }\n            else if (!this.isReverseRotate) {\n                this.refreshToolbar('main', true, true);\n            }\n            this.rotateFlipColl = this.alignRotateFlipColl(this.rotateFlipColl, true);\n        }\n        return isRotate;\n    };\n    /**\n     * Export an image using the specified file name and the extension.\n     *\n     * @param {string} type - Specifies a format of image to be saved.\n     * @param {string} fileName – Specifies a file name to be saved\n     *\n     * @returns {void}.\n     */\n    ImageEditor.prototype.export = function (type, fileName) {\n        var _this = this;\n        if (!this.disabled && this.isImageLoaded) {\n            if (this.isFreehandDrawEditing) {\n                this.applyFreehandDraw();\n            }\n            if (this.togglePen) {\n                this.currObjType.isZoomed = true;\n                this.apply();\n            }\n            if (this.textArea.style.display === 'block') {\n                this.redrawActObj();\n            }\n            this.applyActObj();\n            this.lowerContext.filter = this.canvasFilter;\n            type = type ? type : 'Png';\n            this.redrawActObj();\n            var beforeSave = { cancel: false, fileName: fileName ? fileName : this.fileName,\n                fileType: type };\n            var saved_1 = { fileName: fileName ? fileName : this.fileName, fileType: type };\n            this.trigger('beforeSave', beforeSave, function (observableSaveArgs) {\n                if (!observableSaveArgs.cancel) {\n                    _this.currObjType.isSave = true;\n                    fileName = observableSaveArgs.fileName ? observableSaveArgs.fileName : fileName;\n                    if (type.toLowerCase() === 'svg') {\n                        fileName = fileName || _this.fileName;\n                        _this.toSVGImg(fileName);\n                    }\n                    else if (type.toLowerCase() === 'jpeg') {\n                        fileName = fileName || _this.fileName;\n                        _this.toBlobFn(fileName, type.toLowerCase());\n                    }\n                    else {\n                        fileName = fileName || _this.fileName;\n                        _this.toBlobFn(fileName, type.toLowerCase());\n                    }\n                    _this.trigger('saved', saved_1);\n                    _this.refreshToolbar('main');\n                    _this.lowerCanvas.style.left = _this.upperCanvas.style.left = '';\n                    _this.lowerCanvas.style.top = _this.upperCanvas.style.top = '';\n                    _this.lowerCanvas.style.maxWidth = _this.upperCanvas.style.maxWidth = '';\n                    _this.lowerCanvas.style.maxHeight = _this.upperCanvas.style.maxHeight = '';\n                }\n            });\n        }\n    };\n    /**\n     * Perform selection in an image editor. The selection helps to crop an image.\n     *\n     * @param {string} type - Specifies the shape - circle / square / custom selection / pre-defined ratios.\n     * @param {number} startX – Specifies the start x-coordinate point of the selection.\n     * @param {number} startY – Specifies the start y-coordinate point of the selection.\n     * @param {number} width - Specifies the width of the selection area.\n     * @param {number} height - Specifies the height of the selection area.\n     * @returns {void}.\n     *   ```html\n     * <div id='imageeditor'></div>\n     * ```\n     * ```typescript\n     * <script>\n     * var imageObj = new ImageEditor({\n     *   created : () => {\n     *     imageObj.select('16:9', 10, 10);\n     *  }\n     * });\n     * imageObj.appendTo(\"#imageeditor\");\n     * </script>\n     * ```\n     */\n    ImageEditor.prototype.select = function (type, startX, startY, width, height) {\n        if (!this.disabled && this.isImageLoaded) {\n            if (this.zoomFactor > 0 && !isNullOrUndefined(this.activeObj.shape) && this.activeObj.shape.split('-')[0] === 'crop' && isNullOrUndefined(this.currentSelectionPoint)) {\n                this.currentSelectionPoint = extend({}, this.activeObj, {}, true);\n            }\n            var isPrevent = false;\n            var splitWords = void 0;\n            if (this.activeObj.shape !== undefined) {\n                splitWords = this.activeObj.shape.split('-');\n            }\n            if (splitWords === undefined && this.currObjType.isCustomCrop) {\n                isPrevent = true;\n            }\n            else if (splitWords !== undefined && splitWords[0] === 'crop') {\n                isPrevent = true;\n            }\n            var prevCropObj = extend({}, this.cropObj, {}, true);\n            var prevObj = this.getCurrentObj();\n            prevObj.objColl = extend([], this.objColl, [], true);\n            prevObj.pointColl = extend([], this.pointColl, [], true);\n            prevObj.afterCropActions = extend([], this.afterCropActions, [], true);\n            this.redrawActObj();\n            this.refreshActiveObj();\n            this.keyHistory = '';\n            this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n            this.upperCanvas.style.display = 'block';\n            if (!isNullOrUndefined(this.currSelectionPoint) || this.defaultZoomFactor > 0 ||\n                (this.degree !== 0 && this.totalPannedInternalPoint.x !== 0 && this.totalPannedInternalPoint.y !== 0 && !isPrevent)) {\n                this.isCircleCrop = false;\n                if (this.defaultZoomFactor > 0) {\n                    var zoomFactor = this.zoomFactor = this.defaultZoomFactor;\n                    this.isCropTab = false;\n                    var isUndoRedo = this.isUndoRedo;\n                    for (var i = 0; i < (zoomFactor * 10); i++) {\n                        this.isUndoRedo = true;\n                        this.zoom(-0.1);\n                    }\n                    this.isUndoRedo = isUndoRedo;\n                    this.resetPanPoints();\n                }\n                this.cancelObjColl = extend([], this.objColl, [], true);\n                this.cancelPointColl = extend([], this.pointColl, [], true);\n                this.updateObjAndFreeHandDrawColl();\n                this.isCropTab = true;\n                this.setCurrSelectionPoints(true);\n                this.zoomFactor = this.cropZoomFactor;\n                if (isNullOrUndefined(this.cropObj.activeObj.shape)) {\n                    this.drawNewSelection(type, startX, startY, width, height);\n                }\n                else {\n                    this.updateUndoRedoColl('crop-selection', prevObj, prevObj.objColl, prevObj.pointColl, prevCropObj);\n                }\n            }\n            else {\n                if (type === 'custom') {\n                    this.currObjType.shape = '';\n                }\n                this.drawNewSelection(type, startX, startY, width, height);\n            }\n        }\n    };\n    /**\n     * Enable or disable a freehand drawing in an Image Editor.\n     *\n     * @param {boolean} value - Specifies a value whether enable or disable freehand drawing.\n     *\n     * @returns {void}.\n     * @private\n     */\n    ImageEditor.prototype.freeHandDraw = function (value) {\n        if (value) {\n            this.points = [];\n            this.refreshActiveObj();\n            this.togglePen = true;\n            this.upperCanvas.style.cursor = 'crosshair';\n            this.upperCanvas.style.display = 'block';\n            if (isNullOrUndefined(this.activeObj.strokeSettings)) {\n                this.activeObj.strokeSettings = this.strokeSettings;\n            }\n            if (isNullOrUndefined(this.activeObj.strokeSettings.strokeWidth)) {\n                this.activeObj.strokeSettings.strokeWidth = 4;\n            }\n            this.refreshToolbar('pen');\n        }\n        else {\n            this.upperCanvas.style.cursor = 'default';\n            this.apply();\n            this.refreshToolbar('main');\n            this.currentToolbar = 'main';\n            this.isFreehandDrawCustomized = false;\n        }\n    };\n    /**\n     * Enable or disable a freehand drawing in an Image Editor.\n     *\n     * @param {boolean} value - Specifies a value whether enable or disable freehand drawing.\n     *\n     *  @returns {void}.\n     */\n    ImageEditor.prototype.freehandDraw = function (value) {\n        if (!this.disabled && this.isImageLoaded) {\n            this.freeHandDraw(value);\n        }\n    };\n    /**\n     * Enable or disable a panning on the Image Editor.\n     *\n     * @param {boolean} value - Specifies a value whether enable or disable panning.\n     *\n     * @returns {void}.\n     */\n    ImageEditor.prototype.pan = function (value) {\n        if (!this.disabled && this.isImageLoaded) {\n            if (value) {\n                this.togglePan = true;\n                this.redrawActObj();\n                this.dragCanvas = true;\n                this.lowerCanvas.style.cursor = this.upperCanvas.style.cursor = 'grab';\n                this.panDown = null;\n            }\n            else {\n                this.dragCanvas = this.togglePan = this.currObjType.isCustomCrop = false;\n                this.lowerCanvas.style.cursor = this.upperCanvas.style.cursor = 'default';\n            }\n        }\n    };\n    /**\n     * Increase / Decrease the magnification of an image.\n     *\n     * @param {boolean} value - Specifies a value to be zoomed on the image.\n     * @returns {void}.\n     */\n    ImageEditor.prototype.zoom = function (value) {\n        if (!this.disabled && this.isImageLoaded) {\n            if ((this.zoomFactor === 0 && value < 0) || (this.zoomFactor > 2 && value > 0 ||\n                (this.zoomFactor > 0 && value < 0 && this.disableZoomOutBtn()))) {\n                return;\n            }\n            var splitWords = void 0;\n            var tempActiveObj = void 0;\n            var isShape = false;\n            if (this.activeObj.shape !== undefined) {\n                splitWords = this.activeObj.shape.split('-');\n            }\n            if (splitWords !== undefined && splitWords[0] === 'crop') {\n                tempActiveObj = extend({}, this.activeObj, {}, true);\n                this.isCropTab = true;\n            }\n            else if (!isNullOrUndefined(this.activeObj.shape) && splitWords[0] !== 'crop') {\n                isShape = true;\n            }\n            var zoomPoint = void 0;\n            var zoomLevel = void 0;\n            if (this.isCropTab && !isNullOrUndefined(tempActiveObj)) {\n                zoomLevel = this.cropZoomFactor;\n                zoomPoint = { x: this.activeObj.activePoint.startX + (this.activeObj.activePoint.width / 2),\n                    y: this.activeObj.activePoint.startY + (this.activeObj.activePoint.height / 2) };\n            }\n            else {\n                zoomLevel = this.defaultZoomFactor;\n                zoomPoint = { x: this.lowerCanvas.clientWidth / 2, y: this.lowerCanvas.clientHeight / 2 };\n            }\n            var zoomEventArgs = { zoomPoint: zoomPoint, zoomLevel: zoomLevel };\n            this.trigger('zooming', zoomEventArgs);\n            var prevCropObj = extend({}, this.cropObj, {}, true);\n            var prevObj = this.getCurrentObj();\n            prevObj.objColl = extend([], this.objColl, [], true);\n            prevObj.pointColl = extend([], this.pointColl, [], true);\n            prevObj.afterCropActions = extend([], this.afterCropActions, [], true);\n            this.redrawActObj();\n            this.refreshActiveObj();\n            this.upperContext.clearRect(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n            this.lowerContext.filter = this.canvasFilter;\n            this.upperCanvas.style.cursor = 'default';\n            var zoomState = void 0;\n            var objColl = extend([], this.objColl, [], true);\n            if (value === 3.75 || value === 1) {\n                zoomState = 0.1;\n            }\n            else if (value === -3.75) {\n                zoomState = -0.1;\n            }\n            else {\n                zoomState = value;\n            }\n            if (!this.isCropTab) {\n                if (this.degree !== 0) {\n                    this.redrawActObj();\n                    this.currentPannedPoint = { x: 0, y: 0 };\n                    this.rotatePan(true, true);\n                }\n                this.updateObjAndFreeHandDrawColl();\n            }\n            if (this.degree === 0) {\n                this.drawZoomImgToCanvas(value, tempActiveObj);\n                if (this.getCurrentPanRegion() !== '') {\n                    this.tempFlipPanPoint.x += this.totalPannedPoint.x;\n                    this.tempFlipPanPoint.y += this.totalPannedPoint.y;\n                    objColl = extend([], this.objColl, [], true);\n                    this.objColl = [];\n                    var destLeft = this.destLeft;\n                    var destTop = this.destTop;\n                    this.setDestPointsForFlipState();\n                    this.rotatedFlip();\n                    this.destLeft = destLeft;\n                    this.destTop = destTop;\n                    this.objColl = objColl;\n                    this.zoomObjColl();\n                    this.zoomFreehandDrawColl();\n                    this.updateObjAndFreeHandDrawColl();\n                }\n                if (this.zoomFactor === 0 && !this.isCropTab) {\n                    this.totalPannedPoint = { x: 0, y: 0 };\n                }\n            }\n            else {\n                this.updateObjAndFreeHandDrawColl();\n                this.totalPannedClientPoint = { x: 0, y: 0 };\n                this.totalPannedInternalPoint = { x: 0, y: 0 };\n                this.rotateZoom(value);\n                if (this.getCurrentPanRegion() !== '') {\n                    var temp = this.lowerContext.filter;\n                    this.lowerContext.filter = 'none';\n                    this.zoomObjColl();\n                    this.zoomFreehandDrawColl();\n                    this.lowerContext.filter = temp;\n                }\n            }\n            if (this.getCurrentPanRegion() === '') {\n                var temp = this.lowerContext.filter;\n                this.lowerContext.filter = 'none';\n                this.zoomObjColl();\n                this.zoomFreehandDrawColl();\n                this.lowerContext.filter = temp;\n            }\n            if ((!isNullOrUndefined(this.currSelectionPoint) && this.currSelectionPoint.shape === 'crop-circle') || this.isCircleCrop) {\n                this.cropCircle(this.lowerContext);\n            }\n            this.clearOuterCanvas(this.lowerContext);\n            this.refreshActiveObj();\n            if (!isNullOrUndefined(tempActiveObj)) {\n                this.activeObj = extend({}, tempActiveObj, {}, true);\n                this.drawObject('duplicate', this.activeObj);\n                if (this.zoomFactor === 0) {\n                    this.currSelectionPoint = null;\n                }\n            }\n            if (!this.isUndoRedo) {\n                this.updateUndoRedoColl('zoom', prevObj, prevObj.objColl, prevObj.pointColl, prevCropObj);\n            }\n            this.isUndoRedo = false;\n            var zoomOut = document.querySelector('#' + this.element.id + '_zoomOut');\n            if (!isNullOrUndefined(zoomOut) && this.zoomFactor === 0) {\n                zoomOut.classList.add('e-disabled');\n                zoomOut.parentElement.classList.add('e-overlay');\n            }\n            else if (!isNullOrUndefined(zoomOut)) {\n                zoomOut.classList.remove('e-disabled');\n                zoomOut.parentElement.classList.remove('e-overlay');\n            }\n            this.autoEnablePan();\n            if (!isNullOrUndefined(tempActiveObj)) {\n                this.activeObj = extend({}, tempActiveObj, {}, true);\n            }\n            if (this.activeObj.shape === 'crop-custom') {\n                this.currObjType.isCustomCrop = true;\n            }\n            var panBtn = this.element.querySelector('.e-img-pan .e-btn');\n            if (!isNullOrUndefined(panBtn) && this.togglePan) {\n                panBtn.classList.add('e-selected-btn');\n            }\n            else if (!isNullOrUndefined(panBtn)) {\n                panBtn.classList.remove('e-selected-btn');\n            }\n            if (isShape) {\n                this.activeObj = extend({}, this.objColl[this.objColl.length - 1], {}, true);\n                this.objColl.pop();\n                this.drawObject('duplicate', this.activeObj);\n                this.updateToolbarItems();\n            }\n        }\n    };\n    /**\n     * Draw ellipse on an image.\n     *\n     * @param {number} x - Specifies x-coordinate of ellipse.\n     * @param {number} y - Specifies y-coordinate of ellipse.\n     * @param {number} radiusX - the radius x point for the ellipse.\n     * @param {number} radiusY - the radius y point for the ellipse.\n     * @param {number} strokeWidth - the stroke width of ellipse.\n     * @param {string} strokeColor - the stroke color of ellipse.\n     * @param {string} fillColor - the fill color of the ellipse.\n     * @returns {boolean}.\n     *\n     * ```html\n     * <div id='imageeditor'></div>\n     * ```\n     * ```typescript\n     * <script>\n     * * var imageObj = new ImageEditor({\n     * created: () => {\n     * imageObj.drawEllipse(10, 10, 40, 60);\n     * }\n     * });\n     * imageObj.appendTo(\"#imageeditor\");\n     * </script>\n     * ```\n     */\n    ImageEditor.prototype.drawEllipse = function (x, y, radiusX, radiusY, strokeWidth, strokeColor, fillColor) {\n        var isEllipse = false;\n        var inRange = this.isPointsInRange(x, y);\n        if (!this.disabled && this.isImageLoaded && inRange) {\n            isEllipse = true;\n            this.redrawActObj();\n            this.activeObj.shape = 'ellipse';\n            if (this.currObjType.shape === 'freehanddraw') {\n                this.apply();\n                this.upperCanvas.style.cursor = 'default';\n                this.currObjType.shape = '';\n            }\n            this.currObjType.isCustomCrop = false;\n            var start = { x: x, y: y };\n            this.drawShape('ellipse', strokeWidth, strokeColor, fillColor, start, radiusX, radiusY);\n        }\n        return isEllipse;\n    };\n    /**\n     * Draw line on an image.\n     *\n     * @param {number} startX – Specifies start point x-coordinate of line.\n     * @param {number} startY – Specifies start point y-coordinate of line.\n     * @param {number} endX - Specifies end point x-coordinates of line.\n     * @param {number} endY - Specifies end point y-coordinates of the line.\n     * @param {number} strokeWidth - Specifies the stroke width of line.\n     * @param {string} strokeColor - Specifies the stroke color of line.\n     * @returns {boolean}.\n     */\n    ImageEditor.prototype.drawLine = function (startX, startY, endX, endY, strokeWidth, strokeColor) {\n        var isLine = false;\n        var inRange = this.isPointsInRange(startX, startY);\n        if (!this.disabled && this.isImageLoaded && inRange) {\n            isLine = true;\n            this.redrawActObj();\n            this.activeObj.shape = 'line';\n            if (this.currObjType.shape === 'freehanddraw') {\n                this.apply();\n                this.upperCanvas.style.cursor = 'default';\n                this.currObjType.shape = '';\n            }\n            this.currObjType.isCustomCrop = false;\n            var start = { x: startX, y: startY };\n            var width = endX - startX;\n            var height = endY - startY;\n            this.drawShape('line', strokeWidth, strokeColor, null, start, width, height);\n        }\n        return isLine;\n    };\n    /**\n     * Draw a rectangle on an image.\n     *\n     * @param {number} x - Specifies x-coordinate of rectangle.\n     * @param {number} y - Specifies y-coordinate of rectangle.\n     * @param {number} width - Specifies the width of the rectangle.\n     * @param {number} height - Specifies the height of the rectangle.\n     * @param {number} strokeWidth - Specifies the stroke width of rectangle.\n     * @param {string} strokeColor - Specifies the stroke color of rectangle.\n     * @param {string} fillColor - the fill color of the rectangle.\n     * @returns {boolean}.\n     */\n    ImageEditor.prototype.drawRectangle = function (x, y, width, height, strokeWidth, strokeColor, fillColor) {\n        var isRectangle = false;\n        var inRange = this.isPointsInRange(x, y);\n        if (!this.disabled && this.isImageLoaded && inRange) {\n            isRectangle = true;\n            this.redrawActObj();\n            this.activeObj.shape = 'rectangle';\n            if (this.currObjType.shape === 'freehanddraw') {\n                this.apply();\n                this.upperCanvas.style.cursor = 'default';\n                this.currObjType.shape = '';\n            }\n            this.currObjType.isCustomCrop = false;\n            var start = { x: x, y: y };\n            this.drawShape('rectangle', strokeWidth, strokeColor, fillColor, start, width, height);\n        }\n        return isRectangle;\n    };\n    /**\n     * Draw a text on an image.\n     *\n     * @param {number} x - Specifies x-coordinate of text.\n     * @param {number} y - Specifies y-coordinate of text.\n     * @param {string} text - Specifies the text to add on an image.\n     * @param {string} fontFamily - Specifies the font family of the text.\n     * @param {number} fontSize - Specifies the font size of the text.\n     * @param {boolean} bold - Specifies whether the text is bold or not.\n     * @param {boolean} italic - Specifies whether the text is italic or not.\n     * @param {string} color - Specifies font color of the text.\n     * @returns {boolean}.\n     *\n     * ```html\n     * <div id='imageeditor'></div>\n     * ```\n     * ```typescript\n     * <script>\n     * var imageObj = new ImageEditor({\n     * created: () => {\n     *  imageObj.drawText(10, 10, 'Syncfusion', 'Arial', 12, true, true, '#000');\n     * }\n     * });\n     * imageObj.appendTo(\"#imageeditor\");\n     *\n     * </script>\n     * ```\n     */\n    ImageEditor.prototype.drawText = function (x, y, text, fontFamily, fontSize, bold, italic, color) {\n        var isText = false;\n        var inRange = this.isPointsInRange(x, y);\n        if (!this.disabled && this.isImageLoaded && inRange) {\n            isText = true;\n            this.drawShapeText(text, fontFamily, fontSize, bold, italic, color, x, y);\n        }\n        return isText;\n    };\n    /**\n     * Selects a shape based on the given shape id. The id can be got from the public method ‘getShapeSettings’.\n     *\n     * @param {string} id - Specifies the shape id to select a shape on an image.\n     * @returns {boolean}.\n     * ```html\n     * <div id='imageeditor'></div>\n     * ```\n     * ```typescript\n     * <script>\n     * var imageObj = new ImageEditor({\n     * created: () => {\n     *  imageObj.selectShape('shape_1');\n     * }\n     * });\n     * imageObj.appendTo(\"#imageeditor\");\n     * </script>\n     * ```\n     */\n    ImageEditor.prototype.selectShape = function (id) {\n        var isSelected = false;\n        if (!this.disabled && this.isImageLoaded) {\n            this.applyActObj();\n            if (id.split('_')[0] === 'shape') {\n                var obj = void 0;\n                for (var i = 0; i < this.objColl.length; i++) {\n                    if (this.objColl[i].currIndex === id) {\n                        obj = extend({}, this.objColl[i], {}, true);\n                        break;\n                    }\n                }\n                if (isNullOrUndefined(obj)) {\n                    isSelected = false;\n                }\n                else {\n                    isSelected = true;\n                    this.activeObj = obj;\n                    this.lowerContext.filter = this.canvasFilter;\n                    this.redrawShape(this.activeObj);\n                    if (this.activeObj.shape === 'text') {\n                        this.refreshToolbar('text');\n                    }\n                    else if (this.activeObj.shape === 'pen') {\n                        this.refreshToolbar('pen');\n                    }\n                    else {\n                        this.refreshToolbar('shapes');\n                    }\n                    this.updateToolbarItems();\n                }\n            }\n            else if (id.split('_')[0] === 'pen') {\n                if (this.isFreehandDrawEditing) {\n                    this.okBtn();\n                }\n                if (this.isFreehandDrawIndex(parseInt(id.split('_')[1], 10) - 1)) {\n                    isSelected = true;\n                    this.selectFreehandDraw(parseInt(id.split('_')[1], 10) - 1);\n                    this.updateToolbarItems();\n                }\n                else {\n                    isSelected = false;\n                }\n            }\n        }\n        return isSelected;\n    };\n    /**\n     * Deletes a shape based on the given shape id. The id can be got from the public method getShapeSettings.\n     *\n     * @param {string} id - Specifies the shape id to delete the shape on an image.\n     * @returns {void}.\n     * ```html\n     * <div id='imageeditor'></div>\n     * ```\n     * ```typescript\n     * <script>\n     * var imageObj = new ImageEditor({\n     * created: () => {\n     *  imageObj.deleteShape('shape_1');\n     * }\n     * });\n     * imageObj.appendTo(\"#imageeditor\");\n     * </script>\n     * ```\n     */\n    ImageEditor.prototype.deleteShape = function (id) {\n        if (!this.disabled && this.isImageLoaded) {\n            this.applyActObj();\n            if (id.split('_')[0] === 'shape') {\n                for (var i = 0; i < this.objColl.length; i++) {\n                    if (this.objColl[i].currIndex === id) {\n                        this.objColl.splice(i, 1);\n                        break;\n                    }\n                }\n            }\n            else if (id.split('_')[0] === 'pen') {\n                if (this.isFreehandDrawIndex(parseInt(id.split('_')[1], 10) - 1)) {\n                    this.deleteFreehandDraw(parseInt(id.split('_')[1], 10) - 1, true);\n                }\n            }\n            this.lowerContext.filter = this.canvasFilter;\n            this.lowerContext.clearRect(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n            this.redrawImgWithObj();\n            this.refreshToolbar('main');\n        }\n    };\n    /**\n     * Get particular shapes details based on id of the shape which is drawn on an image editor.\n     *\n     * @param {string} id - Specifies the shape id on an image.\n     * @returns {ShapeSettings}.\n     * ```html\n     * <div id='imageeditor'></div>\n     * ```\n     * ```typescript\n     * <script>\n     * var imageObj = new ImageEditor({\n     * created: () => {\n     *  imageObj.getShapeSetting('shape_1');\n     * }\n     * });\n     * imageObj.appendTo(\"#imageeditor\");\n     * </script>\n     * ```\n     */\n    ImageEditor.prototype.getShapeSetting = function (id) {\n        var shapeDetails;\n        if (!this.disabled && this.isImageLoaded) {\n            this.applyActObj();\n            if (id.split('_')[0] === 'shape') {\n                var obj = void 0;\n                for (var i = 0; i < this.objColl.length; i++) {\n                    if (this.objColl[i].currIndex === id) {\n                        obj = extend({}, this.objColl[i], {}, true);\n                        break;\n                    }\n                }\n                shapeDetails = this.getObjDetails(obj);\n            }\n            else if (id.split('_')[0] === 'pen') {\n                shapeDetails = this.getFreehandDrawDetails(parseInt(id.split('_')[1], 10) - 1);\n            }\n        }\n        return shapeDetails;\n    };\n    /**\n     * Get all the shapes details which is drawn on an image editor.\n     *\n     * @returns {ShapeSettings[]}.\n     */\n    ImageEditor.prototype.getShapeSettings = function () {\n        var shapeDetailsColl = [];\n        if (!this.disabled && this.isImageLoaded) {\n            this.applyActObj();\n            for (var i = 0; i < this.objColl.length; i++) {\n                var shapeDetails = this.getObjDetails(this.objColl[i]);\n                shapeDetailsColl.push(shapeDetails);\n            }\n            for (var i = 0; i < this.freehandCounter; i++) {\n                var shapeDetails = this.getFreehandDrawDetails(i);\n                shapeDetailsColl.push(shapeDetails);\n            }\n        }\n        return shapeDetailsColl;\n    };\n    /**\n     * To refresh the Canvas Wrapper.\n     *\n     * @returns {void}.\n     */\n    ImageEditor.prototype.update = function () {\n        var canvasWrapper = document.querySelector('#' + this.element.id + '_canvasWrapper');\n        if (!isNullOrUndefined(canvasWrapper)) {\n            canvasWrapper.style.width = this.element.offsetWidth - 2 + 'px';\n        }\n        this.lowerCanvas.width = this.upperCanvas.width = this.element.offsetWidth - 2;\n        if (Browser.isDevice) {\n            if (!isNullOrUndefined(canvasWrapper)) {\n                canvasWrapper.style.height = this.element.offsetHeight - (2 * this.toolbarHeight) - 5 + 'px';\n            }\n            this.lowerCanvas.height = this.upperCanvas.height = this.element.offsetHeight - (2 * this.toolbarHeight) - 5;\n        }\n        else {\n            if (!isNullOrUndefined(canvasWrapper)) {\n                canvasWrapper.style.height = this.element.offsetHeight - this.toolbarHeight - 3 + 'px';\n            }\n            this.lowerCanvas.height = this.upperCanvas.height = this.element.offsetHeight - this.toolbarHeight - 3;\n        }\n        this.lowerContext.filter = this.canvasFilter = this.initialAdjustmentValue = this.adjustmentValue = this.getDefaultFilter();\n        this.lowerContext.clearRect(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n        this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n    };\n    /**\n     * To apply the filters to an image\n     *\n     * @param {ImageFinetuneOptions } finetuneOption - Specifies the finetune options to the image.\n     * @param {number } value - Specifies the value for finetuning the image.\n     * @returns {void}.\n     *\n     */\n    ImageEditor.prototype.finetuneImage = function (finetuneOption, value) {\n        if (!this.disabled && this.isImageLoaded) {\n            switch (finetuneOption.toLowerCase()) {\n                case 'brightness':\n                    this.setBrightness(value);\n                    break;\n                case 'contrast':\n                    this.setContrast(value);\n                    break;\n                case 'hue':\n                    this.setHue(value);\n                    break;\n                case 'saturation':\n                    this.setSaturation(value);\n                    break;\n                case 'opacity':\n                    this.setOpacity(value);\n                    break;\n                case 'blur':\n                    this.setBlur(value);\n                    break;\n                case 'exposure':\n                    this.setExposure(value);\n                    break;\n            }\n            this.canvasFilter = this.lowerContext.filter;\n        }\n    };\n    /**\n     * To apply the filters to an image\n     *\n     * @param {ImageFilterOptions } filterOption - Specifies the filter options to the image.\n     * @returns {void}.\n     */\n    ImageEditor.prototype.applyImageFilter = function (filterOption) {\n        if (!this.disabled && this.isImageLoaded) {\n            this.setFilter(filterOption.toString());\n            this.canvasFilter = this.lowerContext.filter;\n        }\n    };\n    /**\n     * Undo the last user action.\n     *\n     * @private\n     * @returns {void}.\n     */\n    ImageEditor.prototype.undo = function () {\n        if (!this.disabled && this.isImageLoaded) {\n            if (this.undoRedoStep > 0) {\n                if (!isNullOrUndefined(this.activeObj.shape)) {\n                    this.refreshToolbar('shapes');\n                }\n                else {\n                    this.refreshToolbar('main');\n                }\n                if (!isNullOrUndefined(this.activeObj.activePoint) && this.activeObj.activePoint.width !== 0) {\n                    this.tempActObj = this.activeObj;\n                }\n                this.refreshActiveObj();\n                this.undoRedoStep--;\n                this.enableDisableToolbarBtn();\n                this.isUndoRedo = true;\n                var obj = this.undoRedoColl[this.undoRedoStep];\n                if (this.undoRedoColl.length === this.undoRedoStep) {\n                    this.currObjType.isUndoAction = false;\n                }\n                else {\n                    this.currObjType.isUndoAction = true;\n                }\n                if (obj.operation !== 'textAreaCustomization' && this.textArea.style.display === 'block') {\n                    this.textArea.style.display = 'none';\n                }\n                this.element.querySelector('.e-contextual-toolbar-wrapper').classList.add('e-hide');\n                this.isCancelAction = true;\n                var activeObj = void 0;\n                this.cropObj = extend({}, obj.previousCropObj, {}, true);\n                this.afterCropActions = obj.previousObj.afterCropActions;\n                this.lowerContext.filter = this.canvasFilter = obj.previousObj.filter;\n                switch (obj.operation) {\n                    case 'shapeTransform':\n                        this.objColl = extend([], obj.previousObjColl, [], true);\n                        this.lowerContext.clearRect(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n                        this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n                        this.isUndoRedo = true;\n                        this.redrawImgWithObj();\n                        this.refreshActiveObj();\n                        break;\n                    case 'freehanddraw':\n                        this.pointColl = obj.previousPointColl;\n                        this.freehandCounter = this.pointColl.length;\n                        this.lowerContext.clearRect(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n                        this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n                        this.isUndoRedo = true;\n                        this.redrawImgWithObj();\n                        break;\n                    case 'freehanddrawCustomized':\n                        this.pointColl = obj.previousPointColl;\n                        this.lowerContext.clearRect(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n                        this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n                        this.isUndoRedo = true;\n                        this.redrawImgWithObj();\n                        break;\n                    case 'deleteFreehandDrawing':\n                    case 'deleteObj':\n                        if (obj.operation === 'deleteFreehandDrawing') {\n                            this.pointColl = obj.previousPointColl;\n                            this.freehandCounter = this.pointColl.length;\n                        }\n                        else if (obj.operation === 'deleteObj') {\n                            this.objColl = obj.previousObjColl;\n                        }\n                        this.lowerContext.clearRect(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n                        this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n                        this.isUndoRedo = true;\n                        this.redrawImgWithObj();\n                        break;\n                    case 'selectionTransform':\n                        this.activeObj = extend({}, obj.previousObj.activeObj, {}, true);\n                        this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n                        if (this.activeObj.activePoint.width !== 0 && this.activeObj.activePoint.height !== 0) {\n                            this.drawObject('duplicate', this.activeObj);\n                            this.refreshToolbar('main', true, true);\n                        }\n                        else {\n                            this.refreshToolbar('main');\n                            this.performUndoDefaultAction(obj);\n                        }\n                        this.currObjType.isCustomCrop = false;\n                        break;\n                    case 'textAreaCustomization':\n                        this.objColl = extend([], obj.previousObjColl, [], true);\n                        for (var i = 0; i < obj.previousObjColl.length; i++) {\n                            if (!isNullOrUndefined(this.tempActObj)) {\n                                if (this.tempActObj.currIndex === obj.previousObjColl[i].currIndex) {\n                                    activeObj = extend({}, obj.previousObjColl[i], {}, true);\n                                    this.objColl.splice(i, 1);\n                                    break;\n                                }\n                            }\n                            else {\n                                activeObj = extend({}, obj.previousObjColl[obj.previousObjColl.length - 1], {}, true);\n                                this.objColl.splice(i, 1);\n                                break;\n                            }\n                        }\n                        if (!isNullOrUndefined(activeObj)) {\n                            this.updateTextBox(activeObj);\n                        }\n                        break;\n                    case 'text':\n                        if (!isNullOrUndefined(this.tempActObj)) {\n                            this.activeObj = extend({}, this.tempActObj, {}, true);\n                        }\n                        if (obj.previousObjColl.length === 0 && this.objColl.length === 1) {\n                            this.tempActObj = extend({}, this.objColl[0], {}, true);\n                        }\n                        else {\n                            for (var i = 0; i < this.objColl.length; i++) {\n                                if (!isNullOrUndefined(this.objColl[i]) &&\n                                    isNullOrUndefined(obj.previousObjColl[i])) {\n                                    this.tempActObj = extend({}, this.objColl[i], {}, true);\n                                    break;\n                                }\n                                if (obj.previousObjColl[i].currIndex !== this.objColl[i].currIndex) {\n                                    this.tempActObj = extend({}, this.objColl[i], {}, true);\n                                    break;\n                                }\n                            }\n                        }\n                        this.activeObj = extend({}, this.tempActObj, {}, true);\n                        this.objColl = extend([], obj.previousObjColl, [], true);\n                        this.lowerContext.clearRect(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n                        this.isUndoRedo = true;\n                        this.redrawImgWithObj();\n                        if (!isNullOrUndefined(this.activeObj) && this.activeObj.activePoint.width !== 0\n                            && this.activeObj.activePoint.height !== 0) {\n                            this.drawObject('duplicate');\n                        }\n                        else {\n                            this.textArea.style.display = 'block';\n                            this.textArea.value = obj.previousText;\n                        }\n                        break;\n                    default:\n                        this.performUndoDefaultAction(obj);\n                        this.setAdjustment(obj.operation);\n                        this.updateFilter(obj.operation, obj.filter);\n                        break;\n                }\n                this.clearOuterCanvas(this.lowerContext);\n                if (this.isCircleCrop && obj.operation !== 'crop') {\n                    this.cropCircle(this.lowerContext);\n                }\n                if (this.zoomFactor > 0) {\n                    this.dragCanvas = true;\n                }\n                this.isCancelAction = false;\n                if (!isNullOrUndefined(this.activeObj.shape) && this.activeObj.shape.split('-')[0] === 'crop') {\n                    this.refreshToolbar('main', true, true);\n                }\n                else {\n                    this.refreshToolbar('main');\n                }\n            }\n        }\n    };\n    /**\n     * Redo the last user action.\n     *\n     * @private\n     * @returns {void}.\n     */\n    ImageEditor.prototype.redo = function () {\n        if (!this.disabled && this.isImageLoaded) {\n            if (this.undoRedoStep < this.undoRedoColl.length) {\n                if (!isNullOrUndefined(this.activeObj.shape)) {\n                    this.refreshToolbar('shapes');\n                }\n                else {\n                    this.refreshToolbar('main');\n                }\n                this.undoRedoStep++;\n                this.enableDisableToolbarBtn();\n                this.isUndoRedo = true;\n                var obj = this.undoRedoColl[this.undoRedoStep - 1];\n                if (this.undoRedoColl.length === this.undoRedoStep) {\n                    this.currObjType.isUndoAction = false;\n                }\n                else {\n                    this.currObjType.isUndoAction = true;\n                }\n                if (obj.operation !== 'textAreaCustomization' && this.textArea.style.display === 'block') {\n                    this.textArea.style.display = 'none';\n                }\n                this.element.querySelector('.e-contextual-toolbar-wrapper').classList.add('e-hide');\n                this.isCancelAction = true;\n                this.cropObj = extend({}, obj.currentCropObj, {}, true);\n                this.afterCropActions = obj.currentObj.afterCropActions;\n                this.lowerContext.filter = this.canvasFilter = obj.currentObj.filter;\n                var activeObj = void 0;\n                var tempUndoRedoColl = void 0;\n                var tempUndoRedoStep = void 0;\n                switch (obj.operation) {\n                    case 'shapeTransform':\n                        this.objColl = extend([], obj.currentObjColl, [], true);\n                        this.lowerContext.clearRect(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n                        this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n                        this.isUndoRedo = true;\n                        this.redrawImgWithObj();\n                        this.refreshActiveObj();\n                        break;\n                    case 'freehanddraw':\n                        this.pointColl = obj.currentPointColl;\n                        this.freehandCounter = this.pointColl.length;\n                        this.lowerContext.clearRect(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n                        this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n                        this.isUndoRedo = true;\n                        this.redrawImgWithObj();\n                        break;\n                    case 'freehanddrawCustomized':\n                        this.pointColl = obj.currentPointColl;\n                        this.lowerContext.clearRect(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n                        this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n                        this.isUndoRedo = true;\n                        this.redrawImgWithObj();\n                        break;\n                    case 'deleteFreehandDrawing':\n                    case 'deleteObj':\n                        if (obj.operation === 'deleteFreehandDrawing') {\n                            this.pointColl = obj.currentPointColl;\n                            this.freehandCounter = this.pointColl.length;\n                        }\n                        else if (obj.operation === 'deleteObj') {\n                            this.objColl = obj.currentObjColl;\n                        }\n                        this.lowerContext.clearRect(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n                        this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n                        this.isUndoRedo = true;\n                        this.redrawImgWithObj();\n                        break;\n                    case 'selectionTransform':\n                        this.activeObj = extend({}, obj.currentObj.activeObj, {}, true);\n                        this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n                        if (this.activeObj.activePoint.width !== 0 && this.activeObj.activePoint.height !== 0) {\n                            this.drawObject('duplicate', this.activeObj);\n                            this.refreshToolbar('main', true, true);\n                        }\n                        else {\n                            this.refreshToolbar('main');\n                        }\n                        this.currObjType.isCustomCrop = false;\n                        break;\n                    case 'textAreaCustomization':\n                        this.objColl = extend([], obj.currentObjColl, [], true);\n                        for (var i = 0; i < obj.currentObjColl.length; i++) {\n                            if (!isNullOrUndefined(this.tempActObj)) {\n                                if (this.tempActObj.currIndex === obj.currentObjColl[i].currIndex) {\n                                    activeObj = extend({}, obj.currentObjColl[i], {}, true);\n                                    this.objColl.splice(i, 1);\n                                    break;\n                                }\n                            }\n                            else {\n                                activeObj = extend({}, obj.currentObjColl[obj.currentObjColl.length - 1], {}, true);\n                                this.objColl.splice(i, 1);\n                                break;\n                            }\n                        }\n                        if (!isNullOrUndefined(activeObj)) {\n                            this.updateTextBox(activeObj);\n                        }\n                        break;\n                    case 'text':\n                        if (!isNullOrUndefined(this.tempActObj)) {\n                            this.activeObj = extend({}, this.tempActObj, {}, true);\n                        }\n                        if (obj.previousObjColl.length === 0 && this.objColl.length === 1) {\n                            this.tempActObj = extend({}, this.objColl[0], {}, true);\n                        }\n                        else {\n                            for (var i = 0; i < this.objColl.length; i++) {\n                                if (!isNullOrUndefined(this.objColl[i]) &&\n                                    isNullOrUndefined(obj.previousObjColl[i])) {\n                                    this.tempActObj = extend({}, this.objColl[i], {}, true);\n                                    break;\n                                }\n                                if (obj.previousObjColl[i].currIndex !== this.objColl[i].currIndex) {\n                                    this.tempActObj = extend({}, this.objColl[i], {}, true);\n                                    break;\n                                }\n                            }\n                        }\n                        this.objColl = extend([], obj.currentObjColl, [], true);\n                        this.lowerContext.clearRect(0, 0, this.lowerCanvas.width, this.lowerCanvas.height);\n                        this.isUndoRedo = true;\n                        this.redrawImgWithObj();\n                        if (!isNullOrUndefined(this.tempActObj)) {\n                            this.activeObj = extend({}, this.tempActObj, {}, true);\n                        }\n                        this.textArea.style.display = 'block';\n                        this.textArea.value = obj.currentText;\n                        tempUndoRedoColl = extend([], this.undoRedoColl, [], true);\n                        tempUndoRedoStep = this.undoRedoStep;\n                        this.redrawActObj();\n                        this.undoRedoColl = tempUndoRedoColl;\n                        this.undoRedoStep = tempUndoRedoStep;\n                        this.textArea.style.display = 'none';\n                        this.textArea.value = '';\n                        this.redrawActObj();\n                        break;\n                    default:\n                        this.objColl = [];\n                        this.pointColl = [];\n                        this.freehandCounter = 0;\n                        this.setCurrentObj(obj.currentObj);\n                        this.destLeft = obj.currentObj.destPoints.startX;\n                        this.destTop = obj.currentObj.destPoints.startY;\n                        activeObj = extend({}, this.activeObj, {}, true);\n                        this.objColl = extend([], obj.currentObjColl, [], true);\n                        this.pointColl = extend([], obj.currentPointColl, [], true);\n                        this.freehandCounter = this.pointColl.length;\n                        this.lowerContext.filter = 'none';\n                        this.iterateObjColl();\n                        this.freehandRedraw(this.lowerContext);\n                        this.lowerContext.filter = obj.currentObj.filter;\n                        this.activeObj = activeObj;\n                        this.upperContext.clearRect(0, 0, this.upperCanvas.width, this.upperCanvas.height);\n                        if (this.activeObj.activePoint.width !== 0 && this.activeObj.activePoint.height !== 0) {\n                            this.drawObject('duplicate');\n                        }\n                        this.setAdjustment(obj.operation);\n                        this.updateFilter(obj.operation);\n                        break;\n                }\n                this.clearOuterCanvas(this.lowerContext);\n                if (this.isCircleCrop) {\n                    this.cropCircle(this.lowerContext);\n                }\n                if (this.zoomFactor > 0) {\n                    this.dragCanvas = true;\n                }\n                this.isCancelAction = false;\n                if (this.undoRedoStep === this.undoRedoColl.length) {\n                    this.isUndoRedo = false;\n                }\n                if (!isNullOrUndefined(this.activeObj.shape) && this.activeObj.shape.split('-')[0] === 'crop') {\n                    this.refreshToolbar('main', true, true);\n                }\n                else {\n                    this.refreshToolbar('main');\n                }\n            }\n        }\n    };\n    var ImageEditor_1;\n    __decorate([\n        Property('')\n    ], ImageEditor.prototype, \"cssClass\", void 0);\n    __decorate([\n        Property(false)\n    ], ImageEditor.prototype, \"disabled\", void 0);\n    __decorate([\n        Property('100%')\n    ], ImageEditor.prototype, \"height\", void 0);\n    __decorate([\n        Property('Bootstrap5')\n    ], ImageEditor.prototype, \"theme\", void 0);\n    __decorate([\n        Property()\n    ], ImageEditor.prototype, \"toolbar\", void 0);\n    __decorate([\n        Property()\n    ], ImageEditor.prototype, \"toolbarTemplate\", void 0);\n    __decorate([\n        Property('100%')\n    ], ImageEditor.prototype, \"width\", void 0);\n    __decorate([\n        Property(false)\n    ], ImageEditor.prototype, \"allowUndoRedo\", void 0);\n    __decorate([\n        Property(false)\n    ], ImageEditor.prototype, \"isReadOnly\", void 0);\n    __decorate([\n        Property(false)\n    ], ImageEditor.prototype, \"enableRtl\", void 0);\n    __decorate([\n        Property(false)\n    ], ImageEditor.prototype, \"enablePersistence\", void 0);\n    __decorate([\n        Complex({}, FinetuneSettings)\n    ], ImageEditor.prototype, \"finetuneSettings\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"beforeSave\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"created\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"destroyed\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"zooming\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"panning\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"cropping\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"rotating\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"flipping\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"shapeChanging\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"fileOpened\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"saved\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"toolbarCreated\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"toolbarUpdating\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"toolbarItemClicked\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"imageFiltering\", void 0);\n    __decorate([\n        Event()\n    ], ImageEditor.prototype, \"finetuneValueChanging\", void 0);\n    ImageEditor = ImageEditor_1 = __decorate([\n        NotifyPropertyChanges\n    ], ImageEditor);\n    return ImageEditor;\n}(Component));\nexport { ImageEditor };\n"],"names":["__extends","extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__","this","constructor","prototype","create","__decorate","decorators","target","key","desc","c","arguments","length","r","getOwnPropertyDescriptor","Reflect","decorate","i","defineProperty","FinetuneSettings","_super","apply","Property","ChildProperty","ImageEditor","options","element","_this","call","degree","isUndoRedo","dragCanvas","dragElement","keyHistory","tempKeyHistory","mouseDownPoint","x","y","previousPoint","dragPoint","startX","startY","endX","endY","diffPoint","oldPoint","objColl","undoRedoColl","isImageLoaded","strokeSettings","strokeColor","fillColor","strokeWidth","tempStrokeSettings","textSettings","text","fontFamily","fontSize","fontRatio","bold","italic","underline","tempTextSettings","toolbarHeight","togglePan","disablePan","currFlipState","touchEndPoint","undoRedoStep","togglePen","currentToolbar","textStartPoints","fontSizeColl","textRow","activeObj","activePoint","width","height","flipObjColl","tempActiveObj","currObjType","shape","isDragging","isActiveObj","isText","isInitialText","isLine","isInitialLine","isCustomCrop","isZoomed","isUndoZoom","isUndoAction","isFiltered","isSave","defToolbarItems","isTimer","isFirstMove","startTouches","tempTouches","adjustmentLevel","brightness","contrast","hue","opacity","saturation","blur","exposure","sharpen","bw","tempAdjustmentLevel","adjustmentValue","initialAdjustmentValue","tempAdjustmentValue","currentFilter","tempFilter","canvasFilter","tempUndoRedoColl","tempUndoRedoStep","zoomFactor","tempZoomFactor","destLeft","destTop","srcLeft","srcTop","cropDestPoints","flipColl","isReverseRotate","isReverseFlip","isPreventDragging","isRotateZoom","rotateFlipColl","isCircleCrop","rotatedDestPoints","croppedDegree","isFreehandDrawingPoint","isFreehandDrawEditing","tempFreeHandDrawEditingStyles","totalPannedInternalPoint","totalPannedClientPoint","totalPannedPoint","isCropTab","cropZoomFactor","defaultZoomFactor","fileName","isBrightnessAdjusted","isInitialLoading","freehandDrawObj","lastWidth","lastVelocity","time","pointX","pointY","points","pointColl","pointCounter","freehandCounter","isFreehandDrawing","tempFreehandCounter","lastPan","selectedFreehandColor","isFreehandDrawCustomized","isShapeInserted","isAllowCropPan","tempPannedPoint","cropObj","cropZoom","defaultZoom","tempFlipPanPoint","destPoints","srcPoints","filter","afterCropActions","isCancelAction","isFreehandPointMoved","isTouch","freehandDownPoint","currentFreehandDrawIndex","tempCurrentFreehandDrawIndex","preventZoomBtn","cancelObjColl","cancelPointColl","rotatedFlipCropSelection","ImageEditor_1","preRender","id","getUniqueID","Browser","isDevice","classList","add","themeColl","Bootstrap5","primaryColor","secondaryColor","Bootstrap5Dark","Tailwind","TailwindDark","Fluent","FluentDark","Bootstrap4","Bootstrap","BootstrapDark","Material","MaterialDark","Fabric","FabricDark","Highcontrast","defaultLocale","Crop","ZoomIn","ZoomOut","Undo","Redo","Transform","Annotation","Finetune","Brightness","Contrast","Hue","Saturation","Opacity","Blur","Sharpen","Exposure","Filter","Default","Chrome","Cold","Warm","Grayscale","BlackAndWhite","Sepia","Invert","Text","Pen","Reset","Save","Select","RotateLeft","RotateRight","HorizontalFlip","VerticalFlip","OK","Cancel","FillColor","StrokeColor","StrokeWidth","FontFamily","FontStyle","FontSize","FontColor","Pan","Move","Load","Custom","Square","Circle","Ellipse","Rectangle","Line","Bold","Italic","BoldItalic","XSmall","Small","Medium","Large","XLarge","ABC","Browse","l10n","L10n","locale","render","initialize","getModuleName","getPersistData","addOnPersist","onPropertyChanged","newProperties","oldProperties","_i","_a","keys","cssClass","removeClass","replace","trim","split","addClass","disabled","unwireEvent","remove","wireEvent","style","theme","updateTheme","upperContext","strokeStyle","fillStyle","finetuneSettings","updateFinetunes","setLocale","refreshToolbar","allowUndoRedo","destroy","removeAttribute","concat","getAttribute","destroySubComponents","innerHTML","createToolbar","createContextualToolbar","createCanvas","lowerContext","getDefaultFilter","createSpinner","defaultValue","initializeFilter","setBrightness","setContrast","setHue","setSaturation","setExposure","setOpacity","setBlur","EventHandler","document","keyDownEventHandler","keyUpEventHandler","upperCanvas","mouseDownEventHandler","mouseMoveEventHandler","mouseUpEventHandler","lowerCanvas","canvasMouseDownHandler","canvasMouseMoveHandler","canvasMouseUpHandler","touchStartHandler","findTextPoint","textArea","handleScroll","window","addEventListener","windowResizeHandler","bind","isIos","info","name","screen","orientation","screenOrientation","inputElement","querySelectorAll","btnElement","len","contains","getComponent","detach","select","toPascalCase","str","strArr","isNullOrUndefined","toLowerCase","charAt","toUpperCase","slice","join","boxSizing","canvasWrapper","appendChild","createElement","className","attrs","offsetHeight","offsetWidth","inMemoryCanvas","setAttribute","position","backgroundColor","display","resize","getContext","baseImg","crossorigin","cursor","inMemoryContext","toolbar","toolbarTemplate","toolbarTemplateFn","toolbarItems","align","type","tooltipText","getConstant","template","Uploader","allowedExtensions","push","toolbarArea","getElementById","toolbar_1","uploadItems","selected","initToolbarItem","createBottomToolbar","Toolbar","items","created","trigger","toolbarType","clicked","defToolbarClicked","createLeftToolbarControls","clientHeight","toolbar_2","updateContextualToolbar","cType","querySelector","contextualToolbarArea","left","offsetLeft","refreshSlider","initFilterToolbarItem","renderSlider","cHt","ht","top","toolbarElem","initBottomToolbar","getMainToolbarItem","renderAnnotationBtn","renderCropBtn","renderTransformBtn","refreshOverflow","templateID","toolbarFn","templateParser","isReact","isAngular","templateColl","nodeType","renderReactTemplates","templateCompiler","compile","error","getLeftToolbarItem","isOkBtn","visible","indexOf","prefixIcon","tempToolbarItems","processToolbar","getRightToolbarItem","isApplyOption","getZoomToolbarItem","processSubToolbar","isToolbar","leftItem","rightItem","mainItem","zoomItem","renderSaveBtn","enableDisableToolbarBtn","undo","parentElement","redo","zoomIn","zoomOut","pan","undefined","uploadDiv","uploadElem","getElementsByTagName","uploadBtnElem","onchange","fileSelect","cropSelectedState","okBtn","proxy","iconCss","drpDownBtn","DropDownButton","open","args","refreshUndoRedoColl","getBoundingClientRect","splitWords","isCropSelection","refreshActiveObj","clearRect","item","freeHandDraw","drawShapeText","drawShape","updateToolbarItems","appendTo","cancelPan","cropSelect","transformSelect","imageEditorObj","getInstance","saveItems","export","prevCropObj","extend","previousObj","getCurrentObj","currSelectionPoint","refreshDropDownBtn","updateUndoRedoColl","currentSelectionPoint","performTransformation","transformCurrentObj","zoom","Math","abs","updateTransform","state","rotate","flip","getShapesToolbarItem","initShapesToolbarItem","createShapeColor","createShapeBtn","ColorPicker","modeSwitcher","noColor","value","showButtons","mode","change","pushActItemIntoObj","prevObj","pop","currentValue","hex","redrawShape","rgba","fillDDB_1","children","toggle","inline","strokeDDB_1","background","strokeWidthItems","strokeWidthBtn","spanElem_1","drpDownBtn_1","activeBtn","textContent","parseInt","getTextToolbarItem","getFontFamilyItems","getFontSizeItems","initTextToolbarItem","createTextColor","createTextBtn","fontColor","color","temp","strokeDDB_2","setTextBoxStylesToActObj","fontNameBtn","spanElem_2","fontFamilyBtn_1","createPopupOnClick","beforeItemRender","updateFontRatio","redrawText","updateFontStyles","fontStyleBtnElem","span1Elem_1","fontStyleBtn_1","fontStyle","fontWeight","applyFontStyle","fontSizeBtnElem","fontSizeSpanElem_1","fontSizes","getFontSizes","fontSizeBtn_1","textStyle","font","rows","getMaxText","measureText","parseFloat","setTextSelection","updateActiveObject","destWidth","destHeight","round","toString","getTextAreaWidth","tempBold","tempItalic","updateUndoRedoObj","obj","operation","currentObj","previousObjColl","currentObjColl","previousPointColl","currentPointColl","previousCropObj","currentCropObj","updateObjColl","initZoomToolbarItem","applyPreviewFilter","contextualToolbarClicked","selEle","imageFiltering","setFilter","isContextualToolbar","panBtn","isDisabledZoomOut","isDisabledFilter","isDisabledAdjustment","adjustment","applyFreehandDraw","performCancel","reset","setTempFilterProperties","openSlider","cancelFreehandDraw","transform","redrawImgWithObj","callMainToolbar","cancelItems","applyShape","redrawActObj","freehandDrawSelectedIndex","renderImage","isSelected","freehandDrawHoveredIndex","n","freehandDrawSelectedId","unselectBtn","selElem","crop","applyActObj","updateBrightnessFilter","opacityValue","isFreehandDrawIndex","index","isIndex","deleteFreehandDraw","isId","tempPointColl","count","callUndo","callRedo","sliderWrapper","slider","hdrWrapper","ej2_instances","iterateObjColl","updateAdjustment","isPreview","brightnessValue","values","getFilterValue","temp_1","freehandRedraw","saturate","bright","saturatePercent","saturatePercentage","getSaturationFilterValue","getDefaultCurrentFilter","setTempFilterValue","updateCurrentTransformedState","drawImage","srcWidth","srcHeight","tempFilter_1","cropCircle","autoEnablePan","tempSplitWords","labelWrapper","styles","min","max","getCurrAdjustmentValue","createSlider","Slider","tooltip","isVisible","placement","showOn","step","setCurrAdjustmentValue","finetuneValueChanging","finetune","isApplyBtn","isZooming","setCurrSelectionPoints","isSetDimension","setDestinationPoints","currentTransformedState","cropObjColl_1","cropPointColl_1","zoomObjColl","zoomFreehandDrawColl","updatePannedRegion","updateObjAndFreeHandDrawColl","cropObjColl","cropPointColl","setCurrentObj","drawPannImage","drawObject","pannedPoint","panObjColl","panFreehandDrawColl","imageRatio","l","ratioX","ratioY","tempPointsColl","currIndex","topLeftCircle","clearSelection","length_1","updateFlipPan","rotatePan","currentPannedPoint","cropImg","clearOuterCanvas","freehandDownHandler","e","canvas","Date","getTime","clientX","clientY","touches","freehandMoveHandler","freehandUpHandler","context","rect","processPoint","closePath","penStrokeWidth","flipState","mouseDown","controlPoint1","controlPoint2","startPoint","endPoint","lastPoint","point","isLastPointTooClose","distanceTo","calcCurveControlPoints","minStrokeWidth","maxStrokeWidth","startDraw","p1","p2","p3","dx1","dy1","dx2","dy2","m1","m2","l1","sqrt","l2","dxm","dym","k","cm","tx","ty","tempVelocity","pointVelocity","newWidth","drawCurve","start","pow","startWidth","endWidth","t1","t2","t3","u1","u2","u3","widthValue","bezierLength","drawSteps","ceil","beginPath","drawArc","fill","t","pointx1","pointy1","pointx2","pointy2","pointx3","pointy3","bezierPoint","startpoint","cp1","cp2","endpoint","size","moveTo","arc","PI","getCurrentFlipState","isCropping","initPenToolbarItem","initAdjustmentToolbarItem","getAdjustmentToolbarItem","getFilterToolbarItem","getPenToolbarItem","createPenColor","createPenBtn","penColor","updateFreehandDrawColorChange","hoverFreehandraw","strokeDDB_3","spanElem_3","getPenStroke","drpDownBtn_2","setPenStroke","createCanvasFilter","getCurrentCanvasData","data","getImageData","imageData","putImageData","noFilter","ctx","chrome","cold","warm","grayscale","sepia","invert","callUpdateCurrentTransformedState","tempObjColl","setDestPointsForFlipState","tempTogglePen","isPreventDestination","isRotatePan","reverseTransformedState","setTransform","isPreventDimension","isPreventCircleCrop","iterateRotateFlipColl","setClientTransformedDimension","isReverse","translate","scale","isObjInsideCropRegion","isInside","xDiff","yDiff","panRegion","cropFreehandDrawColl","idx","pointsHorizontalFlip","shapeFlip","pointsVerticalFlip","flipFreehandrawColl","rotateFreehandDrawColl","isPreventApply","zoomX","zoomY","preventApply","updateFontSize","calcRatio","widthRatio","heightRatio","drawCustomSelection","cropShape","clientWidth","top_1","isFlip","globalCompositeOperation","restore","updateCropObj","isObj","drawCropSelectionImage","isAfterCropAction","alignRotateFlipColl","isRotateCrop","currDestinationPoint","rotateCrop","flipCrop","ratio","resetPanPoints","updateImageRatioForActObj","maxDimension","calcMaxDimension","drawImgToCanvas","limitPan","updatePanPoints","tempDestLeft","tempDestTop","panMove","tempPanMove","tempActObj","updateFlipActiveObj","setCurrentPanRegion","region","getCurrentPanRegion","drawPannedImage","panEventArgs","panDown","isObjCreated","tempSelectionObj","tempFlipState","rotatedFlip","tempCurrFlipState","tempFlipColl","redrawObj","tempDegree","rotateObjColl","getCurrentCropState","isAllowInvert","isInitialRotate","isRotate","updateRotatePanPoints","isDefaultZoom","rotatePanActiveObj","initialDestLeft","initialDestTop","rotateZoom","powerOften","drawZoomImgToCanvas","selectionObj","setZoomDimension","updateCanvas","fileOpened","fileType","imageOnLoad","src","onload","hideSpinner","shapeDegree","previousText","currentText","previousFilter","splice","showSpinner","filesData","files","update","url","URL","createObjectURL","transformOrigin","findTextTarget","getStrokeWidth","selFillElem","selStrokeElem","selTextStrokeElem","selPenStrokeElem","strokeWidthElem","fontFamilyElem","fontSizeElem","fontStyleElem","setTimer","timer","targetTouches","pageX","pageY","calculateScale","endTouches","startDistance","getDistance","a","setXYPoints","preventDefault","bbox","setTimeout","isShapeTouch","isShape","findTargetObj","isFreehandDrawTouch","isFreehandDraw","setCursor","selectFreehandDraw","closeContextualToolbar","currentTarget","isPan","tempHoveredIndex","findTarget","setActivePoint","splitWords_1","isCropSelection_1","offsetTop","firstFingerX","firstFingerY","secondFingerX","secondFingerY","disableZoomOutBtn","updateActivePoint","JSON","stringify","applyCurrActObj","shapeChangingArgs","beforeSave","cancel","ctrlKey","observableSaveArgs","stopImmediatePropagation","action","previousShapeSettings","updatePreviousShapeSettings","currentShapeSettings","horTopLine","textKeyDown","offsetX","offsetY","panStartObj","isInsideCanvas","String","fromCharCode","which","scrollHeight","setTextBoxWidth","adjustToScreen","isSelectionCrop","radius","isDisabled","actObj","floor","updateTextFromTextArea","widthColl","setTextBoxPos","setTextBoxPoints","selectedText","textFlip","border","overflow","focus","setTextBoxHeight","selectionStart","finish","selectionEnd","substring","textAreaTop","maxHeight","textAreaWidth","letterWidth","textWidth","textHeight","selectInfo","setDragWidth","tempWidth","setDragHeight","tempHeight","triggerShapeChange","shapeResizingArgs","shapeMovingArgs","updateShapeChangeEventArgs","updateNWPoints","updateNPoints","updateNEPoints","updateWPoints","updateEPoints","updateSWPoints","updateSPoints","updateSEPoints","preventDraggingInvertly","percentage","prevDiffX","prevDiffY","newScale","getScaleRatio","top_2","top_3","preventInverseResize","isTextArea","isTextBox","maxi","maxStr","maxText","setDragLimit","lineDraw","shapeCircle","canvasDraw","selectionWidth","selectionHeight","fillRect","lineWidth","ellipse","stroke","save","clip","drawOuterSelection","isCropCircle","tempObj","topRightCircle","bottomLeftCircle","bottomRightCircle","drawCenterCircles","isCropRatio","isPreventDrag","saveContext","drawCropRatio","isCrop","drawShapeObj","rotateShape","lineTo","horBottomLine","verLeftLine","verRightLine","actPoint","isMouseMove","horCircleWidth","verCircleHeight","topCenterCircle","centerLeftCircle","centerRightCircle","bottomCenterCircle","currentShape","horLineWidth","verLineHeight","drawSquareLines","shapeLine","shapeText","drawSelection","tempLineWidth","lineHeight","yPoint","j","updateActPoint","rotateText","fillText","horTopInnerLine","horBottomInnerLine","verLeftInnerLine","verRightInnerLine","updateCursorStyles","diffX","temp_2","shapeSettings","rotateDegree","isResize","setDragDirection","calcShapeRatio","updatePoints","diff","imgWidth","imgHeight","originalWidth","originalHeight","presetRatio","standardSize","scaleWidth","getScale","snippetArray","scaleHeight","snippetArray1","originalValue","canvasMaxWidth","canvasMaxHeight","widthScale","heightScale","cssMaxWidth","cssMaxHeight","setMaximumDimension","tempCanvas","newHeight","maxWidth","setCursorFromObj","setCursorForFreehandDrawing","isEntered","z1","z2","z3","z4","x1","x2","y1","y2","annotation","downloadImg","blob","href","download","body","documentElement","click","parentNode","removeChild","toSVGImg","exportChangesToCanvas","dataUrl","toDataURL","svg","createElementNS","img","setAttributeNS","svgDataUrl","btoa","toBlobFn","toBlob","blobUrl","tempContextFilter","tempContext","updateSaveContext","exportTransformedImage","exportRotate","exportHorizontalFlip","exportVerticalFlip","addLetter","letter","textFlipDegree","updateCurrentActiveObjPoint","currActObjIndex","isActObj","splitWords_3","setCenterPoints","renderWidth","renderHeight","getObjDetails","shapeDetails","getFreehandDrawDetails","isPointsInRange","inRange","clearActObj","applyPenDraw","drawRotatedImage","updateCurrSelectionPoint","popForDefaultTransformedState","collection","rotateRight","rotateleft","horizontal","vertical","popForDefaultFlipState","popForDefaultRotateState","isRotateFlipCollection","updateFlipColl","direction","horizontalFlip","verticalFlip","updateFlipState","setFilterValue","filterValue","setSaturationFilterValue","getBlackAndWhiteData","colour","prevFilter","updateTextBox","drawNewSelection","isUpdate","performUndoDefaultAction","setAdjustment","valueArr","updateFilter","filterCanvas","transitionArgs","activeObjShape","toLocaleLowerCase","toolbar_11","saved_1","isPrevent","freehandDraw","zoomPoint","zoomLevel","zoomEventArgs","drawEllipse","radiusX","radiusY","isEllipse","drawLine","drawRectangle","isRectangle","drawText","selectShape","deleteShape","getShapeSetting","getShapeSettings","shapeDetailsColl","finetuneImage","finetuneOption","applyImageFilter","filterOption","Complex","Event","NotifyPropertyChanges","Component"],"mappings":"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"}